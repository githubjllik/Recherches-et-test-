<li class="nav-item" data-section="inventory">
    <a href="#"><i class="fas fa-box-open"></i> Inventaire</a>
</li>
<!-- Nouvel élément à ajouter ici -->
<li class="nav-item" data-section="StatSuiviGlobal">
    <a href="#"><i class="fas fa-chart-line"></i> Suivi & Statistiques</a>
</li>
<li class="nav-item" data-section="add-product">
    <a href="#"><i class="fas fa-plus-circle"></i> Ajouter un produit</a>
</li>


<!-- Section Suivi Global et Statistiques -->
<div id="StatSuiviGlobal" class="content-section" style="display: none;">
    <h2 class="mb-4"><i class="fas fa-chart-line me-2"></i> Suivi Global & Statistiques</h2>
    
    <!-- Filtres principaux -->
    <div class="card StatSuiviGlobal_filterCard">
        <div class="card-header d-flex justify-content-between align-items-center">
            <span><i class="fas fa-filter me-2"></i> Période d'analyse</span>
            <button class="btn btn-sm btn-primary" id="StatSuiviGlobal_toggleFilters">
                <i class="fas fa-sliders-h me-1"></i> Options de filtrage
            </button>
        </div>
        <div class="card-body" id="StatSuiviGlobal_filtersContainer">
            <div class="StatSuiviGlobal_filterContainer">
                <div class="StatSuiviGlobal_activeFilters">
                    <div class="StatSuiviGlobal_activeFilter">
                        <span>Période: </span>
                        <strong id="StatSuiviGlobal_currentPeriod">Cette semaine</strong>
                        <button class="StatSuiviGlobal_changeFilterBtn" id="StatSuiviGlobal_changePeriod">
                            <i class="fas fa-edit"></i>
                        </button>
                    </div>
                </div>
                
                <div class="StatSuiviGlobal_filterOptions" id="StatSuiviGlobal_periodOptions" style="display: none;">
                    <div class="StatSuiviGlobal_filterOptionsHeader">
                        <h5><i class="fas fa-calendar-alt me-2"></i> Sélectionner une période</h5>
                        <button class="StatSuiviGlobal_closeFilterBtn">
                            <i class="fas fa-times"></i>
                        </button>
                    </div>
                    <div class="StatSuiviGlobal_filterOptionsBody">
                        <div class="StatSuiviGlobal_filterGroup">
                            <h6>Périodes prédéfinies</h6>
                            <div class="StatSuiviGlobal_filterItems">
                                <button class="StatSuiviGlobal_filterItem active" data-period="this-week">
                                    <i class="fas fa-calendar-week me-2"></i> Cette semaine
                                </button>
                                <button class="StatSuiviGlobal_filterItem" data-period="today">
                                    <i class="fas fa-calendar-day me-2"></i> Aujourd'hui
                                </button>
                                <button class="StatSuiviGlobal_filterItem" data-period="yesterday">
                                    <i class="fas fa-calendar-day me-2"></i> Hier
                                </button>
                                <button class="StatSuiviGlobal_filterItem" data-period="last-week">
                                    <i class="fas fa-calendar-week me-2"></i> Semaine dernière
                                </button>
                                <button class="StatSuiviGlobal_filterItem" data-period="this-month">
                                    <i class="fas fa-calendar-alt me-2"></i> Ce mois-ci
                                </button>
                                <button class="StatSuiviGlobal_filterItem" data-period="last-month">
                                    <i class="fas fa-calendar-alt me-2"></i> Mois dernier
                                </button>
                                <button class="StatSuiviGlobal_filterItem" data-period="this-year">
                                    <i class="fas fa-calendar me-2"></i> Cette année
                                </button>
                                <button class="StatSuiviGlobal_filterItem" data-period="last-year">
                                    <i class="fas fa-calendar me-2"></i> Année dernière
                                </button>
                                <button class="StatSuiviGlobal_filterItem" data-period="all-time">
                                    <i class="fas fa-infinity me-2"></i> Tout l'historique
                                </button>
                            </div>
                        </div>
                        <div class="StatSuiviGlobal_filterGroup">
                            <h6>Période personnalisée</h6>
                            <div class="StatSuiviGlobal_customDateRange">
                                <div class="StatSuiviGlobal_dateInput">
                                    <label>Du</label>
                                    <input type="date" id="StatSuiviGlobal_startDate">
                                </div>
                                <div class="StatSuiviGlobal_dateInput">
                                    <label>Au</label>
                                    <input type="date" id="StatSuiviGlobal_endDate">
                                </div>
                                <button class="StatSuiviGlobal_applyCustomDate">
                                    <i class="fas fa-check me-1"></i> Appliquer
                                </button>
                            </div>
                        </div>
                        <div class="StatSuiviGlobal_filterGroup">
                            <h6>Sélection précise</h6>
                            <div class="StatSuiviGlobal_preciseSelection">
                                <div class="StatSuiviGlobal_selectWrapper">
                                    <label>Année</label>
                                    <div class="StatSuiviGlobal_customSelect" id="StatSuiviGlobal_yearSelect">
                                        <div class="StatSuiviGlobal_selectedOption">
                                            <span>2025</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="StatSuiviGlobal_options">
                                            <div class="StatSuiviGlobal_option" data-value="2025">2025</div>
                                            <div class="StatSuiviGlobal_option" data-value="2024">2024</div>
                                            <div class="StatSuiviGlobal_option" data-value="2023">2023</div>
                                            <div class="StatSuiviGlobal_option" data-value="2022">2022</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="StatSuiviGlobal_selectWrapper">
                                    <label>Mois</label>
                                    <div class="StatSuiviGlobal_customSelect" id="StatSuiviGlobal_monthSelect">
                                        <div class="StatSuiviGlobal_selectedOption">
                                            <span>Tous</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="StatSuiviGlobal_options">
                                            <div class="StatSuiviGlobal_option" data-value="all">Tous</div>
                                            <div class="StatSuiviGlobal_option" data-value="1">Janvier</div>
                                            <div class="StatSuiviGlobal_option" data-value="2">Février</div>
                                            <div class="StatSuiviGlobal_option" data-value="3">Mars</div>
                                            <div class="StatSuiviGlobal_option" data-value="4">Avril</div>
                                            <div class="StatSuiviGlobal_option" data-value="5">Mai</div>
                                            <div class="StatSuiviGlobal_option" data-value="6">Juin</div>
                                            <div class="StatSuiviGlobal_option" data-value="7">Juillet</div>
                                            <div class="StatSuiviGlobal_option" data-value="8">Août</div>
                                            <div class="StatSuiviGlobal_option" data-value="9">Septembre</div>
                                            <div class="StatSuiviGlobal_option" data-value="10">Octobre</div>
                                            <div class="StatSuiviGlobal_option" data-value="11">Novembre</div>
                                            <div class="StatSuiviGlobal_option" data-value="12">Décembre</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="StatSuiviGlobal_selectWrapper">
                                    <label>Jour</label>
                                    <div class="StatSuiviGlobal_customSelect" id="StatSuiviGlobal_daySelect">
                                        <div class="StatSuiviGlobal_selectedOption">
                                            <span>Tous</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="StatSuiviGlobal_options" id="StatSuiviGlobal_dayOptions">
                                            <div class="StatSuiviGlobal_option" data-value="all">Tous</div>
                                            <!-- Days will be populated by JS -->
                                        </div>
                                    </div>
                                </div>
                                <button class="StatSuiviGlobal_applyPreciseDate">
                                    <i class="fas fa-check me-1"></i> Appliquer
                                </button>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="StatSuiviGlobal_additionalFilters">
                <button class="StatSuiviGlobal_exportBtn">
                    <i class="fas fa-file-export me-1"></i> Exporter
                </button>
                <button class="StatSuiviGlobal_refreshBtn" id="StatSuiviGlobal_refreshData">
                    <i class="fas fa-sync-alt me-1"></i> Actualiser
                </button>
            </div>
        </div>
    </div>
    
    <!-- Résumé global -->
    <div class="StatSuiviGlobal_summaryContainer">
        <div class="StatSuiviGlobal_summaryCard">
            <div class="StatSuiviGlobal_summaryIcon">
                <i class="fas fa-money-bill-wave"></i>
            </div>
            <div class="StatSuiviGlobal_summaryContent">
                <div class="StatSuiviGlobal_summaryLabel">Gains totaux</div>
                <div class="StatSuiviGlobal_summaryValue" id="StatSuiviGlobal_totalRevenue">0 €</div>
                <div class="StatSuiviGlobal_summaryChange positive">
                    <i class="fas fa-arrow-up"></i> +12.5% vs période précédente
                </div>
            </div>
        </div>
        <div class="StatSuiviGlobal_summaryCard">
            <div class="StatSuiviGlobal_summaryIcon">
                <i class="fas fa-shopping-cart"></i>
            </div>
            <div class="StatSuiviGlobal_summaryContent">
                <div class="StatSuiviGlobal_summaryLabel">Ventes totales</div>
                <div class="StatSuiviGlobal_summaryValue" id="StatSuiviGlobal_totalSales">0</div>
                <div class="StatSuiviGlobal_summaryChange positive">
                    <i class="fas fa-arrow-up"></i> +8.3% vs période précédente
                </div>
            </div>
        </div>
        <div class="StatSuiviGlobal_summaryCard">
            <div class="StatSuiviGlobal_summaryIcon">
                <i class="fas fa-box"></i>
            </div>
            <div class="StatSuiviGlobal_summaryContent">
                <div class="StatSuiviGlobal_summaryLabel">Valeur du stock</div>
                <div class="StatSuiviGlobal_summaryValue" id="StatSuiviGlobal_stockValue">0 €</div>
                <div class="StatSuiviGlobal_summaryChange negative">
                    <i class="fas fa-arrow-down"></i> -2.1% vs période précédente
                </div>
            </div>
        </div>
        <div class="StatSuiviGlobal_summaryCard">
            <div class="StatSuiviGlobal_summaryIcon">
                <i class="fas fa-percent"></i>
            </div>
            <div class="StatSuiviGlobal_summaryContent">
                <div class="StatSuiviGlobal_summaryLabel">Marge bénéficiaire</div>
                <div class="StatSuiviGlobal_summaryValue" id="StatSuiviGlobal_profitMargin">0%</div>
                <div class="StatSuiviGlobal_summaryChange positive">
                    <i class="fas fa-arrow-up"></i> +1.5% vs période précédente
                </div>
            </div>
        </div>
    </div>
    
    <!-- Tableaux de bord principaux -->
    <div class="row">
        <!-- Graphique principal -->
        <div class="col-lg-8">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <span id="StatSuiviGlobal_mainChartTitle">Évolution des ventes et revenus</span>
                    <div class="StatSuiviGlobal_chartControls">
                        <div class="StatSuiviGlobal_chartTypeSelect">
                            <button class="StatSuiviGlobal_chartTypeBtn active" data-type="bar">
                                <i class="fas fa-chart-bar"></i>
                            </button>
                            <button class="StatSuiviGlobal_chartTypeBtn" data-type="line">
                                <i class="fas fa-chart-line"></i>
                            </button>
                            <button class="StatSuiviGlobal_chartTypeBtn" data-type="area">
                                <i class="fas fa-chart-area"></i>
                            </button>
                        </div>
                        <div class="StatSuiviGlobal_chartPeriodSelect">
                            <button class="StatSuiviGlobal_chartPeriodBtn active" data-period="day">Jour</button>
                            <button class="StatSuiviGlobal_chartPeriodBtn" data-period="week">Semaine</button>
                            <button class="StatSuiviGlobal_chartPeriodBtn" data-period="month">Mois</button>
                            <button class="StatSuiviGlobal_chartPeriodBtn" data-period="year">Année</button>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div id="StatSuiviGlobal_mainChart" class="StatSuiviGlobal_chartContainer"></div>
                </div>
            </div>
        </div>
        
        <!-- Top produits -->
        <div class="col-lg-4">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <span>Top Produits</span>
                    <div class="StatSuiviGlobal_topProductsFilter">
                        <button class="StatSuiviGlobal_topProductBtn active" data-type="sales">Ventes</button>
                        <button class="StatSuiviGlobal_topProductBtn" data-type="revenue">Revenus</button>
                        <button class="StatSuiviGlobal_topProductBtn" data-type="profit">Marge</button>
                    </div>
                </div>
                <div class="card-body p-0">
                    <div id="StatSuiviGlobal_topProductsList" class="StatSuiviGlobal_productsList">
                        <!-- Les produits seront générés dynamiquement ici -->
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Analyse du stock et des performances -->
    <div class="row mt-4">
        <!-- Performance des catégories -->
        <div class="col-lg-5">
            <div class="card">
                <div class="card-header">
                    <span>Performance par catégorie</span>
                </div>
                <div class="card-body">
                    <div id="StatSuiviGlobal_categoryChart" class="StatSuiviGlobal_chartContainer"></div>
                </div>
            </div>
        </div>
        
        <!-- Distribution du stock -->
        <div class="col-lg-7">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <span>Distribution du stock</span>
                    <div class="StatSuiviGlobal_stockViewToggle">
                        <button class="StatSuiviGlobal_stockViewBtn active" data-view="bubble">
                            <i class="fas fa-circle"></i> Bulles
                        </button>
                        <button class="StatSuiviGlobal_stockViewBtn" data-view="treemap">
                            <i class="fas fa-th-large"></i> Mosaïque
                        </button>
                    </div>
                </div>
                <div class="card-body">
                    <div id="StatSuiviGlobal_stockDistribution" class="StatSuiviGlobal_chartContainer"></div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Tableau de performance et prévisions -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <ul class="nav nav-tabs card-header-tabs" id="StatSuiviGlobal_dataTabs">
                        <li class="nav-item">
                            <a class="nav-link active" data-bs-toggle="tab" href="#StatSuiviGlobal_performanceTab">
                                <i class="fas fa-chart-pie me-1"></i> Performance
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#StatSuiviGlobal_stockTab">
                                <i class="fas fa-box me-1"></i> Analyse de stock
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#StatSuiviGlobal_forecastTab">
                                <i class="fas fa-crystal-ball me-1"></i> Prévisions
                            </a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" data-bs-toggle="tab" href="#StatSuiviGlobal_recommendationsTab">
                                <i class="fas fa-lightbulb me-1"></i> Recommandations
                            </a>
                        </li>
                    </ul>
                </div>
                <div class="card-body">
                    <div class="tab-content">
                        <!-- Onglet Performance -->
                        <div class="tab-pane fade show active" id="StatSuiviGlobal_performanceTab">
                            <div class="StatSuiviGlobal_tabControls">
                                <div class="StatSuiviGlobal_searchContainer">
                                    <input type="text" class="StatSuiviGlobal_searchInput" placeholder="Rechercher un produit...">
                                    <i class="fas fa-search"></i>
                                </div>
                                <div class="StatSuiviGlobal_sortContainer">
                                    <label>Trier par:</label>
                                    <div class="StatSuiviGlobal_customSelect">
                                        <div class="StatSuiviGlobal_selectedOption">
                                            <span>Ventes (décroissant)</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="StatSuiviGlobal_options">
                                            <div class="StatSuiviGlobal_option" data-sort="sales" data-order="desc">Ventes (décroissant)</div>
                                            <div class="StatSuiviGlobal_option" data-sort="sales" data-order="asc">Ventes (croissant)</div>
                                            <div class="StatSuiviGlobal_option" data-sort="revenue" data-order="desc">Revenus (décroissant)</div>
                                            <div class="StatSuiviGlobal_option" data-sort="revenue" data-order="asc">Revenus (croissant)</div>
                                            <div class="StatSuiviGlobal_option" data-sort="profit" data-order="desc">Marge (décroissante)</div>
                                            <div class="StatSuiviGlobal_option" data-sort="profit" data-order="asc">Marge (croissante)</div>
                                            <div class="StatSuiviGlobal_option" data-sort="stock" data-order="desc">Stock (décroissant)</div>
                                            <div class="StatSuiviGlobal_option" data-sort="stock" data-order="asc">Stock (croissant)</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="table-responsive">
                                <table class="table table-hover" id="StatSuiviGlobal_performanceTable">
                                    <thead>
                                        <tr>
                                            <th>Produit</th>
                                            <th>Catégorie</th>
                                            <th>Prix</th>
                                            <th>Ventes</th>
                                            <th>Revenus</th>
                                            <th>Stock actuel</th>
                                            <th>Performance</th>
                                        </tr>
                                    </thead>
                                    <tbody id="StatSuiviGlobal_performanceTableBody">
                                        <!-- Lignes générées dynamiquement -->
                                    </tbody>
                                </table>
                            </div>
                            
                            <div class="StatSuiviGlobal_pagination">
                                <button class="StatSuiviGlobal_paginationBtn" data-page="first">
                                    <i class="fas fa-angle-double-left"></i>
                                </button>
                                <button class="StatSuiviGlobal_paginationBtn" data-page="prev">
                                    <i class="fas fa-angle-left"></i>
                                </button>
                                <div class="StatSuiviGlobal_pageInfo">
                                    Page <span id="StatSuiviGlobal_currentPage">1</span> sur <span id="StatSuiviGlobal_totalPages">1</span>
                                </div>
                                <button class="StatSuiviGlobal_paginationBtn" data-page="next">
                                    <i class="fas fa-angle-right"></i>
                                </button>
                                <button class="StatSuiviGlobal_paginationBtn" data-page="last">
                                    <i class="fas fa-angle-double-right"></i>
                                </button>
                            </div>
                        </div>
                        
                        <!-- Onglet Analyse de stock -->
                        <div class="tab-pane fade" id="StatSuiviGlobal_stockTab">
                            <div class="StatSuiviGlobal_stockAlerts">
                                <div class="StatSuiviGlobal_alertCard danger">
                                    <div class="StatSuiviGlobal_alertIcon">
                                        <i class="fas fa-exclamation-triangle"></i>
                                    </div>
                                    <div class="StatSuiviGlobal_alertContent">
                                        <div class="StatSuiviGlobal_alertTitle">Rupture de stock</div>
                                        <div class="StatSuiviGlobal_alertValue">12 produits</div>
                                    </div>
                                    <button class="StatSuiviGlobal_alertButton">
                                        <i class="fas fa-eye"></i> Voir
                                    </button>
                                </div>
                                <div class="StatSuiviGlobal_alertCard warning">
                                    <div class="StatSuiviGlobal_alertIcon">
                                        <i class="fas fa-battery-quarter"></i>
                                    </div>
                                    <div class="StatSuiviGlobal_alertContent">
                                        <div class="StatSuiviGlobal_alertTitle">Stock faible</div>
                                        <div class="StatSuiviGlobal_alertValue">18 produits</div>
                                    </div>
                                    <button class="StatSuiviGlobal_alertButton">
                                        <i class="fas fa-eye"></i> Voir
                                    </button>
                                </div>
                                <div class="StatSuiviGlobal_alertCard info">
                                    <div class="StatSuiviGlobal_alertIcon">
                                        <i class="fas fa-boxes"></i>
                                    </div>
                                    <div class="StatSuiviGlobal_alertContent">
                                        <div class="StatSuiviGlobal_alertTitle">Surstock</div>
                                        <div class="StatSuiviGlobal_alertValue">7 produits</div>
                                    </div>
                                    <button class="StatSuiviGlobal_alertButton">
                                        <i class="fas fa-eye"></i> Voir
                                    </button>
                                </div>
                                <div class="StatSuiviGlobal_alertCard success">
                                    <div class="StatSuiviGlobal_alertIcon">
                                        <i class="fas fa-check-circle"></i>
                                    </div>
                                    <div class="StatSuiviGlobal_alertContent">
                                        <div class="StatSuiviGlobal_alertTitle">Stock optimal</div>
                                        <div class="StatSuiviGlobal_alertValue">63 produits</div>
                                    </div>
                                    <button class="StatSuiviGlobal_alertButton">
                                        <i class="fas fa-eye"></i> Voir
                                    </button>
                                </div>
                            </div>
                            
                            <div class="StatSuiviGlobal_stockAnalysis">
                                <div class="StatSuiviGlobal_analysisToggle">
                                    <button class="StatSuiviGlobal_analysisBtn active" data-analysis="lowStock">
                                        <i class="fas fa-battery-quarter me-1"></i> Stock faible
                                    </button>
                                    <button class="StatSuiviGlobal_analysisBtn" data-analysis="outOfStock">
                                        <i class="fas fa-exclamation-triangle me-1"></i> Rupture de stock
                                    </button>
                                    <button class="StatSuiviGlobal_analysisBtn" data-analysis="overStock">
                                        <i class="fas fa-boxes me-1"></i> Surstock
                                    </button>
                                    <button class="StatSuiviGlobal_analysisBtn" data-analysis="optimalStock">
                                        <i class="fas fa-check-circle me-1"></i> Stock optimal
                                    </button>
                                </div>
                                
                                <div class="table-responsive mt-3">
                                    <table class="table table-hover" id="StatSuiviGlobal_stockAnalysisTable">
                                        <thead>
                                            <tr>
                                                <th>Produit</th>
                                                <th>Catégorie</th>
                                                <th>Stock actuel</th>
                                                <th>Seuil d'alerte</th>
                                                <th>Dernier approvisionnement</th>
                                                <th>Ventes récentes</th>
                                                <th>Statut</th>
                                                <th>Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody id="StatSuiviGlobal_stockAnalysisTableBody">
                                            <!-- Lignes générées dynamiquement -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Onglet Prévisions -->
                        <div class="tab-pane fade" id="StatSuiviGlobal_forecastTab">
                            <div class="StatSuiviGlobal_forecastControls">
                                <div class="StatSuiviGlobal_forecastPeriodSelect">
                                    <label>Horizon de prévision:</label>
                                    <div class="StatSuiviGlobal_customSelect">
                                        <div class="StatSuiviGlobal_selectedOption">
                                            <span>Prochain mois</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="StatSuiviGlobal_options">
                                            <div class="StatSuiviGlobal_option" data-forecast="week">Prochaine semaine</div>
                                            <div class="StatSuiviGlobal_option" data-forecast="month">Prochain mois</div>
                                            <div class="StatSuiviGlobal_option" data-forecast="quarter">Prochain trimestre</div>
                                            <div class="StatSuiviGlobal_option" data-forecast="year">Prochaine année</div>
                                        </div>
                                    </div>
                                </div>
                                <div class="StatSuiviGlobal_forecastTypeSelect">
                                    <label>Type de prévision:</label>
                                    <div class="StatSuiviGlobal_customSelect">
                                        <div class="StatSuiviGlobal_selectedOption">
                                            <span>Ventes</span>
                                            <i class="fas fa-chevron-down"></i>
                                        </div>
                                        <div class="StatSuiviGlobal_options">
                                            <div class="StatSuiviGlobal_option" data-forecast-type="sales">Ventes</div>
                                            <div class="StatSuiviGlobal_option" data-forecast-type="revenue">Revenus</div>
                                            <div class="StatSuiviGlobal_option" data-forecast-type="stock">Niveau de stock</div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="row mt-4">
                                <div class="col-md-8">
                                    <div id="StatSuiviGlobal_forecastChart" class="StatSuiviGlobal_chartContainer"></div>
                                </div>
                                <div class="col-md-4">
                                    <div class="StatSuiviGlobal_forecastSummary">
                                        <h5><i class="fas fa-chart-line me-2"></i> Résumé des prévisions</h5>
                                        <div class="StatSuiviGlobal_forecastMetric">
                                            <div class="StatSuiviGlobal_forecastMetricLabel">Ventes prévues</div>
                                            <div class="StatSuiviGlobal_forecastMetricValue">342</div>
                                            <div class="StatSuiviGlobal_forecastMetricChange positive">
                                                <i class="fas fa-arrow-up"></i> +18% vs mois précédent
                                            </div>
                                        </div>
                                        <div class="StatSuiviGlobal_forecastMetric">
                                            <div class="StatSuiviGlobal_forecastMetricLabel">Revenus prévus</div>
                                            <div class="StatSuiviGlobal_forecastMetricValue">15 820 €</div>
                                            <div class="StatSuiviGlobal_forecastMetricChange positive">
                                                <i class="fas fa-arrow-up"></i> +22% vs mois précédent
                                            </div>
                                        </div>
                                        <div class="StatSuiviGlobal_forecastMetric">
                                            <div class="StatSuiviGlobal_forecastMetricLabel">Produits en rupture</div>
                                            <div class="StatSuiviGlobal_forecastMetricValue">8</div>
                                            <div class="StatSuiviGlobal_forecastMetricChange negative">
                                                <i class="fas fa-arrow-up"></i> +3 vs estimation actuelle
                                            </div>
                                        </div>
                                        <div class="StatSuiviGlobal_forecastRecommendation">
                                            <div class="StatSuiviGlobal_forecastRecommendationHeader">
                                                <i class="fas fa-lightbulb"></i> Recommandation
                                            </div>
                                            <div class="StatSuiviGlobal_forecastRecommendationContent">
                                                Augmentez votre stock de <strong>Antennes TV</strong> et <strong>Adaptateurs HDMI</strong> de 15% pour éviter les ruptures et optimiser les ventes du prochain mois.
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="StatSuiviGlobal_forecastTable mt-4">
                                <h5><i class="fas fa-table me-2"></i> Prévisions détaillées par produit</h5>
                                <div class="table-responsive">
                                    <table class="table table-hover">
                                        <thead>
                                            <tr>
                                                <th>Produit</th>
                                                <th>Ventes actuelles</th>
                                                <th>Ventes prévues</th>
                                                <th>Croissance</th>
                                                <th>Stock actuel</th>
                                                <th>Stock prévu</th>
                                                <th>Statut prévu</th>
                                                <th>Recommandation</th>
                                            </tr>
                                        </thead>
                                        <tbody id="StatSuiviGlobal_forecastTableBody">
                                            <!-- Lignes générées dynamiquement -->
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Onglet Recommandations -->
                        <div class="tab-pane fade" id="StatSuiviGlobal_recommendationsTab">
                            <div class="row">
                                <div class="col-md-8">
                                    <div class="StatSuiviGlobal_recommendationSection">
                                        <h5><i class="fas fa-tag me-2"></i> Recommandations de prix</h5>
                                        <div class="StatSuiviGlobal_recommendationCards">
                                            <div class="StatSuiviGlobal_recommendationCard">
                                                <div class="StatSuiviGlobal_recommendationHeader">
                                                    <div class="StatSuiviGlobal_recommendationTitle">Augmentation de prix</div>
                                                    <div class="StatSuiviGlobal_recommendationBadge positive">
                                                        <i class="fas fa-chart-line"></i> Fort potentiel
                                                    </div>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationProduct">
                                                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjNkM3NTdEIiBkPSJNMzg0IDI1NlYwSDI1NnYyNTZIMAkJdjEyOGgyNTZ2MTI4aDEyOFYzODRoMTI4VjI1NkgzODR6Ii8+PC9zdmc+" alt="Produit">
                                                    <div>
                                                        <div class="StatSuiviGlobal_recommendationProductName">Antenne TV Extérieure</div>
                                                        <div class="StatSuiviGlobal_recommendationProductCategory">Antennes & Réception</div>
                                                    </div>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationDetails">
                                                    <div class="StatSuiviGlobal_recommendationDetail">
                                                        <span>Prix actuel:</span>
                                                        <strong>49,99 €</strong>
                                                    </div>
                                                    <div class="StatSuiviGlobal_recommendationDetail">
                                                        <span>Prix recommandé:</span>
                                                        <strong class="positive">59,99 €</strong>
                                                    </div>
                                                    <div class="StatSuiviGlobal_recommendationDetail">
                                                        <span>Impact sur revenus:</span>
                                                        <strong class="positive">+20%</strong>
                                                    </div>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationReason">
                                                    <i class="fas fa-info-circle me-1"></i> 
                                                    Forte demande (ventes +32% ce mois) avec stock limité
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationActions">
                                                    <button class="StatSuiviGlobal_recommendationActionBtn primary">
                                                        <i class="fas fa-check me-1"></i> Appliquer
                                                    </button>
                                                    <button class="StatSuiviGlobal_recommendationActionBtn secondary">
                                                        <i class="fas fa-eye me-1"></i> Détails
                                                    </button>
                                                </div>
                                            </div>
                                            
                                            <div class="StatSuiviGlobal_recommendationCard">
                                                <div class="StatSuiviGlobal_recommendationHeader">
                                                    <div class="StatSuiviGlobal_recommendationTitle">Réduction de prix</div>
                                                    <div class="StatSuiviGlobal_recommendationBadge warning">
                                                        <i class="fas fa-exclamation-circle"></i> Stock excédentaire
                                                    </div>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationProduct">
                                                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjNkM3NTdEIiBkPSJNMzI5Ljc3IDk0Ljk1QzMwOC41MiA3My43MiAyODAuMjggNjMgMjUwIDYzcy01OC41MiAxMC43Mi03OS43NyAzMS45NUM5NC45OCAxNzAuMTYgOTQuOTggMzQxLjg0IDE3MC4yMyA0MTcuMDVjMCAwIDIwLjQzLTI1LjA5IDQxLjA4LTUwLjQxLTE3LjA3LTMwLjQ3LTE1LjA1LTY5LjI1IDE0LjA5LTk4LjM5IDM0LjA2LTM0LjA2IDg5LjE3LTM0LjA2IDEyMy4yMyAwIDI5LjE0IDI5LjE0IDMxLjEyIDY3LjkyIDE0LjA1IDk4LjM5IDIwLjY2IDI1LjMyIDQxLjA5IDUwLjQxIDQxLjA5IDUwLjQxIDc1LjI0LTc1LjIxIDc1LjI0LTI0Ni44OSAwLTMyMi4xeiIvPjwvc3ZnPg==" alt="Produit">
                                                    <div>
                                                        <div class="StatSuiviGlobal_recommendationProductName">Adaptateur HDMI vers VGA</div>
                                                        <div class="StatSuiviGlobal_recommendationProductCategory">Adaptateurs & Connecteurs</div>
                                                    </div>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationDetails">
                                                    <div class="StatSuiviGlobal_recommendationDetail">
                                                        <span>Prix actuel:</span>
                                                        <strong>19,99 €</strong>
                                                    </div>
                                                    <div class="StatSuiviGlobal_recommendationDetail">
                                                        <span>Prix recommandé:</span>
                                                        <strong class="negative">14,99 €</strong>
                                                    </div>
                                                    <div class="StatSuiviGlobal_recommendationDetail">
                                                        <span>Impact sur ventes:</span>
                                                        <strong class="positive">+45%</strong>
                                                    </div>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationReason">
                                                    <i class="fas fa-info-circle me-1"></i> 
                                                    Stock excédentaire (124 unités) avec ventes faibles ces 3 derniers mois
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationActions">
                                                    <button class="StatSuiviGlobal_recommendationActionBtn primary">
                                                        <i class="fas fa-check me-1"></i> Appliquer
                                                    </button>
                                                    <button class="StatSuiviGlobal_recommendationActionBtn secondary">
                                                        <i class="fas fa-eye me-1"></i> Détails
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                    
                                    <div class="StatSuiviGlobal_recommendationSection">
                                        <h5><i class="fas fa-shopping-cart me-2"></i> Recommandations de stock</h5>
                                        <div class="StatSuiviGlobal_recommendationCards">
                                            <div class="StatSuiviGlobal_recommendationCard">
                                                <div class="StatSuiviGlobal_recommendationHeader">
                                                    <div class="StatSuiviGlobal_recommendationTitle">Augmenter le stock</div>
                                                    <div class="StatSuiviGlobal_recommendationBadge danger">
                                                        <i class="fas fa-exclamation-triangle"></i> Rupture imminente
                                                    </div>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationProduct">
                                                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjNkM3NTdEIiBkPSJNMjI0IDEzNlYwSDg4djEzNkgwdjg4aDg4djEzNmgxMzZWMjI0aDEzNnYtODhIMjI0eiIvPjwvc3ZnPg==" alt="Produit">
                                                    <div>
                                                        <div class="StatSuiviGlobal_recommendationProductName">Câble HDMI Premium 2m</div>
                                                        <div class="StatSuiviGlobal_recommendationProductCategory">Câbles & Accessoires</div>
                                                    </div>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationDetails">
                                                    <div class="StatSuiviGlobal_recommendationDetail">
                                                        <span>Stock actuel:</span>
                                                        <strong class="negative">5 unités</strong>
                                                    </div>
                                                    <div class="StatSuiviGlobal_recommendationDetail">
                                                        <span>Stock recommandé:</span>
                                                        <strong class="positive">50 unités</strong>
                                                    </div>
                                                    <div class="StatSuiviGlobal_recommendationDetail">
                                                        <span>Commande suggérée:</span>
                                                        <strong>45 unités</strong>
                                                    </div>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationReason">
                                                    <i class="fas fa-info-circle me-1"></i> 
                                                    Ventes stables (25 unités/mois) avec tendance croissante
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationActions">
                                                    <button class="StatSuiviGlobal_recommendationActionBtn primary">
                                                        <i class="fas fa-shopping-cart me-1"></i> Commander
                                                    </button>
                                                    <button class="StatSuiviGlobal_recommendationActionBtn secondary">
                                                        <i class="fas fa-eye me-1"></i> Détails
                                                    </button>
                                                </div>
                                            </div>
                                            
                                            <div class="StatSuiviGlobal_recommendationCard">
                                                <div class="StatSuiviGlobal_recommendationHeader">
                                                    <div class="StatSuiviGlobal_recommendationTitle">Réduire le stock</div>
                                                    <div class="StatSuiviGlobal_recommendationBadge warning">
                                                        <i class="fas fa-boxes"></i> Surstock critique
                                                    </div>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationProduct">
                                                    <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjNkM3NTdEIiBkPSJNMjU2IDhDMTE5IDggOCAxMTkgOCAyNTZzMTExIDI0OCAyNDggMjQ4IDI0OC0xMTEgMjQ4LTI0OFMzOTMgOCAyNTYgOHptMCA0NDhjLTExMC41IDAtMjAwLTg5LjUtMjAwLTIwMFMxNDUuNSA1NiAyNTYgNTZzMjAwIDg5LjUgMjAwIDIwMC04OS41IDIwMC0yMDAgMjAweiIvPjwvc3ZnPg==" alt="Produit">
                                                    <div>
                                                        <div class="StatSuiviGlobal_recommendationProductName">Télécommande Universelle</div>
                                                        <div class="StatSuiviGlobal_recommendationProductCategory">Télécommandes</div>
                                                    </div>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationDetails">
                                                    <div class="StatSuiviGlobal_recommendationDetail">
                                                        <span>Stock actuel:</span>
                                                        <strong class="negative">145 unités</strong>
                                                    </div>
                                                    <div class="StatSuiviGlobal_recommendationDetail">
                                                        <span>Stock optimal:</span>
                                                        <strong>30 unités</strong>
                                                    </div>
                                                    <div class="StatSuiviGlobal_recommendationDetail">
                                                        <span>Excédent:</span>
                                                        <strong class="negative">115 unités</strong>
                                                    </div>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationReason">
                                                    <i class="fas fa-info-circle me-1"></i> 
                                                    Ventes faibles (5 unités/mois) avec tendance décroissante
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationActions">
                                                    <button class="StatSuiviGlobal_recommendationActionBtn primary">
                                                        <i class="fas fa-tags me-1"></i> Créer promotion
                                                    </button>
                                                    <button class="StatSuiviGlobal_recommendationActionBtn secondary">
                                                        <i class="fas fa-eye me-1"></i> Détails
                                                    </button>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-md-4">
                                    <div class="StatSuiviGlobal_recommendationSummary">
                                        <h5><i class="fas fa-clipboard-list me-2"></i> Résumé des recommandations</h5>
                                        <div class="StatSuiviGlobal_recommendationSummaryContent">
                                            <div class="StatSuiviGlobal_recommendationSummaryItem">
                                                <div class="StatSuiviGlobal_recommendationSummaryIcon danger">
                                                    <i class="fas fa-exclamation-triangle"></i>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationSummaryText">
                                                    <div class="StatSuiviGlobal_recommendationSummaryTitle">Actions critiques</div>
                                                    <div class="StatSuiviGlobal_recommendationSummaryValue">4</div>
                                                </div>
                                            </div>
                                            <div class="StatSuiviGlobal_recommendationSummaryItem">
                                                <div class="StatSuiviGlobal_recommendationSummaryIcon warning">
                                                    <i class="fas fa-exclamation-circle"></i>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationSummaryText">
                                                    <div class="StatSuiviGlobal_recommendationSummaryTitle">Actions importantes</div>
                                                    <div class="StatSuiviGlobal_recommendationSummaryValue">7</div>
                                                </div>
                                            </div>
                                            <div class="StatSuiviGlobal_recommendationSummaryItem">
                                                <div class="StatSuiviGlobal_recommendationSummaryIcon info">
                                                    <i class="fas fa-info-circle"></i>
                                                </div>
                                                <div class="StatSuiviGlobal_recommendationSummaryText">
                                                    <div class="StatSuiviGlobal_recommendationSummaryTitle">Suggestions</div>
                                                    <div class="StatSuiviGlobal_recommendationSummaryValue">12</div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="StatSuiviGlobal_recommendationReport">
                                            <h6><i class="fas fa-chart-pie me-2"></i> Potentiel d'amélioration</h6>
                                            <div class="StatSuiviGlobal_recommendationReportItem">
                                                <div class="StatSuiviGlobal_recommendationReportLabel">Revenus</div>
                                                <div class="StatSuiviGlobal_recommendationReportValue">+12.5%</div>
                                                <div class="StatSuiviGlobal_recommendationReportBar">
                                                    <div class="StatSuiviGlobal_recommendationReportProgress" style="width: 60%"></div>
                                                </div>
                                            </div>
                                            <div class="StatSuiviGlobal_recommendationReportItem">
                                                <div class="StatSuiviGlobal_recommendationReportLabel">Rotation stock</div>
                                                <div class="StatSuiviGlobal_recommendationReportValue">+18.3%</div>
                                                <div class="StatSuiviGlobal_recommendationReportBar">
                                                    <div class="StatSuiviGlobal_recommendationReportProgress" style="width: 75%"></div>
                                                </div>
                                            </div>
                                            <div class="StatSuiviGlobal_recommendationReportItem">
                                                <div class="StatSuiviGlobal_recommendationReportLabel">Marge bénéficiaire</div>
                                                <div class="StatSuiviGlobal_recommendationReportValue">+4.2%</div>
                                                <div class="StatSuiviGlobal_recommendationReportBar">
                                                    <div class="StatSuiviGlobal_recommendationReportProgress" style="width: 30%"></div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        <div class="StatSuiviGlobal_quickActions">
                                            <h6><i class="fas fa-bolt me-2"></i> Actions rapides</h6>
                                            <button class="StatSuiviGlobal_quickActionBtn">
                                                <i class="fas fa-file-pdf me-1"></i> Générer rapport complet
                                            </button>
                                            <button class="StatSuiviGlobal_quickActionBtn">
                                                <i class="fas fa-list-check me-1"></i> Appliquer tout
                                            </button>
                                            <button class="StatSuiviGlobal_quickActionBtn">
                                                <i class="fas fa-cog me-1"></i> Paramètres de recommandation
                                            </button>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Meilleurs produits -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header d-flex justify-content-between align-items-center">
                    <span>Top Performances</span>
                    <div class="StatSuiviGlobal_topPerformanceFilter">
                        <div class="StatSuiviGlobal_customSelect">
                            <div class="StatSuiviGlobal_selectedOption">
                                <span>Top 10</span>
                                <i class="fas fa-chevron-down"></i>
                            </div>
                            <div class="StatSuiviGlobal_options">
                                <div class="StatSuiviGlobal_option" data-top="10">Top 10</div>
                                <div class="StatSuiviGlobal_option" data-top="20">Top 20</div>
                                <div class="StatSuiviGlobal_option" data-top="50">Top 50</div>
                                <div class="StatSuiviGlobal_option" data-top="100">Top 100</div>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="card-body">
                    <div class="StatSuiviGlobal_topPerformanceTabs">
                        <button class="StatSuiviGlobal_topPerformanceTab active" data-tab="day">
                            <i class="fas fa-calendar-day me-1"></i> Jour
                        </button>
                        <button class="StatSuiviGlobal_topPerformanceTab" data-tab="week">
                            <i class="fas fa-calendar-week me-1"></i> Semaine
                        </button>
                        <button class="StatSuiviGlobal_topPerformanceTab" data-tab="month">
                            <i class="fas fa-calendar-alt me-1"></i> Mois
                        </button>
                        <button class="StatSuiviGlobal_topPerformanceTab" data-tab="year">
                            <i class="fas fa-calendar me-1"></i> Année
                        </button>
                    </div>
                    
                    <div class="StatSuiviGlobal_topPerformanceContent">
                        <div class="StatSuiviGlobal_topPerformanceList active" data-content="day">
                            <div class="StatSuiviGlobal_bestProduct">
                                <div class="StatSuiviGlobal_bestProductBadge">
                                    <i class="fas fa-trophy"></i> Meilleur produit du jour
                                </div>
                                <div class="StatSuiviGlobal_bestProductContent">
                                    <div class="StatSuiviGlobal_bestProductImage">
                                        <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjNkM3NTdEIiBkPSJNMjU2IDhDMTE5IDggOCAxMTkgOCAyNTZzMTExIDI0OCAyNDggMjQ4IDI0OC0xMTEgMjQ4LTI0OFMzOTMgOCAyNTYgOHptMCA0NDhjLTExMC41IDAtMjAwLTg5LjUtMjAwLTIwMFMxNDUuNSA1NiAyNTYgNTZzMjAwIDg5LjUgMjAwIDIwMC04OS41IDIwMC0yMDAgMjAweiIvPjwvc3ZnPg==" alt="Produit">
                                    </div>
                                    <div class="StatSuiviGlobal_bestProductInfo">
                                        <h5>Câble HDMI Premium 4K 2m</h5>
                                        <div class="StatSuiviGlobal_bestProductCategory">Câbles & Accessoires</div>
                                        <div class="StatSuiviGlobal_bestProductStats">
                                            <div class="StatSuiviGlobal_bestProductStat">
                                                <div class="StatSuiviGlobal_bestProductStatLabel">Ventes</div>
                                                <div class="StatSuiviGlobal_bestProductStatValue">32</div>
                                            </div>
                                            <div class="StatSuiviGlobal_bestProductStat">
                                                <div class="StatSuiviGlobal_bestProductStatLabel">Revenus</div>
                                                <div class="StatSuiviGlobal_bestProductStatValue">479,68 €</div>
                                            </div>
                                            <div class="StatSuiviGlobal_bestProductStat">
                                                <div class="StatSuiviGlobal_bestProductStatLabel">Prix</div>
                                                <div class="StatSuiviGlobal_bestProductStatValue">14,99 €</div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                            <div class="StatSuiviGlobal_topProducts">
                                <!-- Top products will be generated dynamically -->
                            </div>
                        </div>
                        
                        <!-- Week, Month and Year tabs will have similar structure -->
                        <div class="StatSuiviGlobal_topPerformanceList" data-content="week" style="display: none;">
                            <!-- Week content -->
                        </div>
                        <div class="StatSuiviGlobal_topPerformanceList" data-content="month" style="display: none;">
                            <!-- Month content -->
                        </div>
                        <div class="StatSuiviGlobal_topPerformanceList" data-content="year" style="display: none;">
                            <!-- Year content -->
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Rapports et analyses détaillées -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-header">
                    <span><i class="fas fa-file-alt me-2"></i> Rapports et analyses</span>
                </div>
                <div class="card-body">
                    <div class="StatSuiviGlobal_reports">
                        <div class="StatSuiviGlobal_reportCard">
                            <div class="StatSuiviGlobal_reportIcon">
                                <i class="fas fa-chart-pie"></i>
                            </div>
                            <div class="StatSuiviGlobal_reportContent">
                                <div class="StatSuiviGlobal_reportTitle">Rapport de ventes</div>
                                <div class="StatSuiviGlobal_reportDesc">Analyse complète des ventes par période, catégorie et produit</div>
                            </div>
                            <button class="StatSuiviGlobal_reportButton">
                                <i class="fas fa-download me-1"></i> Générer
                            </button>
                        </div>
                        <div class="StatSuiviGlobal_reportCard">
                            <div class="StatSuiviGlobal_reportIcon">
                                <i class="fas fa-box-open"></i>
                            </div>
                            <div class="StatSuiviGlobal_reportContent">
                                <div class="StatSuiviGlobal_reportTitle">Analyse de stock</div>
                                <div class="StatSuiviGlobal_reportDesc">État détaillé du stock, rotations, et préconisations</div>
                            </div>
                            <button class="StatSuiviGlobal_reportButton">
                                <i class="fas fa-download me-1"></i> Générer
                            </button>
                        </div>
                        <div class="StatSuiviGlobal_reportCard">
                            <div class="StatSuiviGlobal_reportIcon">
                                <i class="fas fa-chart-line"></i>
                            </div>
                            <div class="StatSuiviGlobal_reportContent">
                                <div class="StatSuiviGlobal_reportTitle">Prévisions & Tendances</div>
                                <div class="StatSuiviGlobal_reportDesc">Prévisions détaillées et analyse des tendances futures</div>
                            </div>
                            <button class="StatSuiviGlobal_reportButton">
                                <i class="fas fa-download me-1"></i> Générer
                            </button>
                        </div>
                        <div class="StatSuiviGlobal_reportCard">
                            <div class="StatSuiviGlobal_reportIcon">
                                <i class="fas fa-lightbulb"></i>
                            </div>
                            <div class="StatSuiviGlobal_reportContent">
                                <div class="StatSuiviGlobal_reportTitle">Recommandations</div>
                                <div class="StatSuiviGlobal_reportDesc">Recommandations détaillées pour optimiser votre activité</div>
                            </div>
                            <button class="StatSuiviGlobal_reportButton">
                                <i class="fas fa-download me-1"></i> Générer
                            </button>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>


<style>
  /* Styles pour le suivi global et statistiques */
#StatSuiviGlobal {
    position: relative;
}

.StatSuiviGlobal_filterCard {
    margin-bottom: 20px;
}

.StatSuiviGlobal_filterContainer {
    display: flex;
    justify-content: space-between;
    align-items: center;
    flex-wrap: wrap;
}

.StatSuiviGlobal_activeFilters {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.StatSuiviGlobal_activeFilter {
    display: flex;
    align-items: center;
    background-color: #f8f9fa;
    padding: 8px 12px;
    border-radius: 5px;
}

.StatSuiviGlobal_changeFilterBtn {
    background: none;
    border: none;
    color: var(--primary);
    margin-left: 8px;
    cursor: pointer;
    font-size: 14px;
}

.StatSuiviGlobal_additionalFilters {
    display: flex;
    gap: 10px;
    margin-top: 10px;
}

.StatSuiviGlobal_exportBtn, 
.StatSuiviGlobal_refreshBtn {
    background-color: white;
    border: 1px solid #ddd;
    border-radius: 5px;
    padding: 8px 12px;
    cursor: pointer;
    transition: all 0.2s;
}

.StatSuiviGlobal_exportBtn:hover, 
.StatSuiviGlobal_refreshBtn:hover {
    background-color: #f5f5f5;
}

.StatSuiviGlobal_filterOptions {
    position: absolute;
    top: 100px;
    left: 20px;
    right: 20px;
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 5px 20px rgba(0, 0, 0, 0.15);
    z-index: 1000;
    max-height: 80vh;
    overflow-y: auto;
}

.StatSuiviGlobal_filterOptionsHeader {
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 15px 20px;
    border-bottom: 1px solid #eee;
}

.StatSuiviGlobal_closeFilterBtn {
    background: none;
    border: none;
    font-size: 16px;
    cursor: pointer;
    color: #6c757d;
}

.StatSuiviGlobal_filterOptionsBody {
    padding: 15px 20px;
}

.StatSuiviGlobal_filterGroup {
    margin-bottom: 20px;
}

.StatSuiviGlobal_filterGroup h6 {
    font-weight: 600;
    margin-bottom: 10px;
    color: #495057;
}

.StatSuiviGlobal_filterItems {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
}

.StatSuiviGlobal_filterItem {
    background-color: #f8f9fa;
    border: 1px solid #ddd;
    border-radius: 5px;
    padding: 8px 12px;
    cursor: pointer;
    transition: all 0.2s;
    font-size: 14px;
}

.StatSuiviGlobal_filterItem:hover {
    background-color: #e9ecef;
}

.StatSuiviGlobal_filterItem.active {
    background-color: var(--primary);
    color: white;
    border-color: var(--primary);
}

.StatSuiviGlobal_customDateRange {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-items: flex-end;
}

.StatSuiviGlobal_dateInput {
    flex: 1;
    min-width: 200px;
}

.StatSuiviGlobal_dateInput label {
    display: block;
    font-size: 14px;
    margin-bottom: 5px;
    color: #495057;
}

.StatSuiviGlobal_dateInput input {
    width: 100%;
    padding: 8px 12px;
    border: 1px solid #ddd;
    border-radius: 5px;
}

.StatSuiviGlobal_applyCustomDate, 
.StatSuiviGlobal_applyPreciseDate {
    background-color: var(--primary);
    color: white;
    border: none;
    border-radius: 5px;
    padding: 8px 16px;
    cursor: pointer;
    transition: all 0.2s;
}

.StatSuiviGlobal_applyCustomDate:hover, 
.StatSuiviGlobal_applyPreciseDate:hover {
    background-color: var(--primary-dark);
}

.StatSuiviGlobal_preciseSelection {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    align-items: flex-end;
}

.StatSuiviGlobal_selectWrapper {
    flex: 1;
    min-width: 150px;
}

.StatSuiviGlobal_selectWrapper label {
    display: block;
    font-size: 14px;
    margin-bottom: 5px;
    color: #495057;
}

.StatSuiviGlobal_customSelect {
    position: relative;
    user-select: none;
}

.StatSuiviGlobal_selectedOption {
    background-color: white;
    border: 1px solid #ddd;
    border-radius: 5px;
    padding: 8px 12px;
    cursor: pointer;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.StatSuiviGlobal_options {
    position: absolute;
    top: 100%;
    left: 0;
    right: 0;
    background-color: white;
    border: 1px solid #ddd;
    border-radius: 0 0 5px 5px;
    z-index: 10;
    max-height: 200px;
    overflow-y: auto;
    display: none;
}

.StatSuiviGlobal_customSelect.active .StatSuiviGlobal_options {
    display: block;
}

.StatSuiviGlobal_option {
    padding: 8px 12px;
    cursor: pointer;
}

.StatSuiviGlobal_option:hover {
    background-color: #f8f9fa;
}

/* Styles pour le résumé global */
.StatSuiviGlobal_summaryContainer {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 25px;
}

.StatSuiviGlobal_summaryCard {
    background-color: white;
    border-radius: 10px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    padding: 20px;
    display: flex;
    align-items: center;
    transition: transform 0.2s;
}

.StatSuiviGlobal_summaryCard:hover {
    transform: translateY(-5px);
}

.StatSuiviGlobal_summaryIcon {
    background-color: rgba(230, 0, 0, 0.1);
    color: var(--primary);
    width: 50px;
    height: 50px;
    border-radius: 10px;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    margin-right: 15px;
}

.StatSuiviGlobal_summaryContent {
    flex: 1;
}

.StatSuiviGlobal_summaryLabel {
    color: #6c757d;
    font-size: 14px;
    margin-bottom: 5px;
}

.StatSuiviGlobal_summaryValue {
    font-size: 24px;
    font-weight: 700;
    margin-bottom: 5px;
}

.StatSuiviGlobal_summaryChange {
    font-size: 12px;
    display: flex;
    align-items: center;
}

.StatSuiviGlobal_summaryChange.positive {
    color: #28a745;
}

.StatSuiviGlobal_summaryChange.negative {
    color: #dc3545;
}

.StatSuiviGlobal_summaryChange i {
    margin-right: 5px;
}

/* Styles pour les graphiques */
.StatSuiviGlobal_chartContainer {
    width: 100%;
    height: 350px;
}

.StatSuiviGlobal_chartControls {
    display: flex;
    gap: 10px;
}

.StatSuiviGlobal_chartTypeSelect {
    display: flex;
    border: 1px solid #ddd;
    border-radius: 5px;
    overflow: hidden;
}

.StatSuiviGlobal_chartTypeBtn {
    background-color: white;
    border: none;
    padding: 6px 10px;
    cursor: pointer;
}

.StatSuiviGlobal_chartTypeBtn.active {
    background-color: var(--primary);
    color: white;
}

.StatSuiviGlobal_chartPeriodSelect {
    display: flex;
    border: 1px solid #ddd;
    border-radius: 5px;
    overflow: hidden;
}

.StatSuiviGlobal_chartPeriodBtn {
    background-color: white;
    border: none;
    padding: 6px 10px;
    cursor: pointer;
}

.StatSuiviGlobal_chartPeriodBtn.active {
    background-color: var(--primary);
    color: white;
}

/* Styles pour les produits top */
.StatSuiviGlobal_topProductsFilter {
    display: flex;
    border: 1px solid #ddd;
    border-radius: 5px;
    overflow: hidden;
}

.StatSuiviGlobal_topProductBtn {
    background-color: white;
    border: none;
    padding: 6px 10px;
    cursor: pointer;
}

.StatSuiviGlobal_topProductBtn.active {
    background-color: var(--primary);
    color: white;
}

.StatSuiviGlobal_productsList {
    height: 350px;
    overflow-y: auto;
}

.StatSuiviGlobal_productItem {
    display: flex;
    align-items: center;
    padding: 15px;
    border-bottom: 1px solid #eee;
}

.StatSuiviGlobal_productRank {
    width: 30px;
    height: 30px;
    border-radius: 50%;
    background-color: #f8f9fa;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 600;
    margin-right: 15px;
}

.StatSuiviGlobal_productRank.top-1 {
    background-color: #ffd700;
    color: white;
}

.StatSuiviGlobal_productRank.top-2 {
    background-color: #c0c0c0;
    color: white;
}

.StatSuiviGlobal_productRank.top-3 {
    background-color: #cd7f32;
    color: white;
}

.StatSuiviGlobal_productInfo {
    flex: 1;
}

.StatSuiviGlobal_productName {
    font-weight: 600;
}

.StatSuiviGlobal_productCategory {
    font-size: 12px;
    color: #6c757d;
}

.StatSuiviGlobal_productStats {
    display: flex;
    align-items: center;
}

.StatSuiviGlobal_productStat {
    background-color: #f8f9fa;
    padding: 4px 8px;
    border-radius: 5px;
    font-size: 14px;
    margin-left: 10px;
}

/* Styles pour les onglets de données */
.StatSuiviGlobal_tabControls {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.StatSuiviGlobal_searchContainer {
    position: relative;
    width: 300px;
}

.StatSuiviGlobal_searchInput {
    width: 100%;
    padding: 8px 15px 8px 35px;
    border: 1px solid #ddd;
    border-radius: 5px;
}

.StatSuiviGlobal_searchContainer i {
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    color: #6c757d;
}

.StatSuiviGlobal_sortContainer {
    display: flex;
    align-items: center;
    gap: 10px;
}

.StatSuiviGlobal_sortContainer label {
    font-size: 14px;
    color: #6c757d;
}

.StatSuiviGlobal_pagination {
    display: flex;
    justify-content: center;
    align-items: center;
    margin-top: 20px;
}

.StatSuiviGlobal_paginationBtn {
    width: 36px;
    height: 36px;
    border-radius: 5px;
    border: 1px solid #ddd;
    background-color: white;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    margin: 0 5px;
}

.StatSuiviGlobal_paginationBtn:hover {
    background-color: #f8f9fa;
}

.StatSuiviGlobal_paginationBtn:disabled {
    opacity: 0.5;
    cursor: not-allowed;
}

.StatSuiviGlobal_pageInfo {
    margin: 0 10px;
    font-size: 14px;
}

/* Styles pour les alertes de stock */
.StatSuiviGlobal_stockAlerts {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 15px;
    margin-bottom: 20px;
}

.StatSuiviGlobal_alertCard {
    display: flex;
    align-items: center;
    padding: 15px;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.StatSuiviGlobal_alertCard.danger {
    background-color: #ffebee;
}

.StatSuiviGlobal_alertCard.warning {
    background-color: #fff8e1;
}

.StatSuiviGlobal_alertCard.info {
    background-color: #e3f2fd;
}

.StatSuiviGlobal_alertCard.success {
    background-color: #e8f5e9;
}

.StatSuiviGlobal_alertIcon {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    font-size: 18px;
}

.StatSuiviGlobal_alertCard.danger .StatSuiviGlobal_alertIcon {
    background-color: #f44336;
    color: white;
}

.StatSuiviGlobal_alertCard.warning .StatSuiviGlobal_alertIcon {
    background-color: #ffc107;
    color: white;
}

.StatSuiviGlobal_alertCard.info .StatSuiviGlobal_alertIcon {
    background-color: #2196f3;
    color: white;
}

.StatSuiviGlobal_alertCard.success .StatSuiviGlobal_alertIcon {
    background-color: #4caf50;
    color: white;
}

.StatSuiviGlobal_alertContent {
    flex: 1;
}

.StatSuiviGlobal_alertTitle {
    font-weight: 600;
    margin-bottom: 2px;
}

.StatSuiviGlobal_alertValue {
    font-size: 18px;
    font-weight: 700;
}

.StatSuiviGlobal_alertButton {
    background: none;
    border: none;
    color: #6c757d;
    cursor: pointer;
    font-size: 14px;
    display: flex;
    align-items: center;
}

.StatSuiviGlobal_alertButton i {
    margin-right: 5px;
}

.StatSuiviGlobal_stockAnalysis {
    margin-top: 20px;
}

.StatSuiviGlobal_analysisToggle {
    display: flex;
    flex-wrap: wrap;
    gap: 10px;
    margin-bottom: 15px;
}

.StatSuiviGlobal_analysisBtn {
    background-color: #f8f9fa;
    border: 1px solid #ddd;
    border-radius: 5px;
    padding: 8px 12px;
    cursor: pointer;
    transition: all 0.2s;
}

.StatSuiviGlobal_analysisBtn:hover {
    background-color: #e9ecef;
}

.StatSuiviGlobal_analysisBtn.active {
    background-color: var(--primary);
    color: white;
    border-color: var(--primary);
}

/* Styles pour les prévisions */
.StatSuiviGlobal_forecastControls {
    display: flex;
    flex-wrap: wrap;
    gap: 20px;
    margin-bottom: 20px;
}

.StatSuiviGlobal_forecastPeriodSelect,
.StatSuiviGlobal_forecastTypeSelect {
    display: flex;
    align-items: center;
    gap: 10px;
}

.StatSuiviGlobal_forecastPeriodSelect label,
.StatSuiviGlobal_forecastTypeSelect label {
    font-size: 14px;
    color: #6c757d;
}

.StatSuiviGlobal_forecastSummary {
    background-color: #f8f9fa;
    border-radius: 8px;
    padding: 20px;
    height: 100%;
}

.StatSuiviGlobal_forecastSummary h5 {
    margin-bottom: 15px;
    font-weight: 600;
}

.StatSuiviGlobal_forecastMetric {
    margin-bottom: 15px;
    padding-bottom: 15px;
    border-bottom: 1px solid #eee;
}

.StatSuiviGlobal_forecastMetricLabel {
    color: #6c757d;
    font-size: 14px;
    margin-bottom: 5px;
}

.StatSuiviGlobal_forecastMetricValue {
    font-size: 22px;
    font-weight: 700;
    margin-bottom: 5px;
}

.StatSuiviGlobal_forecastMetricChange {
    font-size: 12px;
    display: flex;
    align-items: center;
}

.StatSuiviGlobal_forecastMetricChange.positive {
    color: #28a745;
}

.StatSuiviGlobal_forecastMetricChange.negative {
    color: #dc3545;
}

.StatSuiviGlobal_forecastRecommendation {
    background-color: white;
    border-radius: 8px;
    padding: 15px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
}

.StatSuiviGlobal_forecastRecommendationHeader {
    display: flex;
    align-items: center;
    font-weight: 600;
    margin-bottom: 10px;
    color: var(--primary);
}

.StatSuiviGlobal_forecastRecommendationHeader i {
    margin-right: 8px;
    font-size: 16px;
}

.StatSuiviGlobal_forecastRecommendationContent {
    font-size: 14px;
    line-height: 1.5;
}

/* Styles pour les recommandations */
.StatSuiviGlobal_recommendationSection {
    margin-bottom: 30px;
}

.StatSuiviGlobal_recommendationSection h5 {
    margin-bottom: 15px;
    font-weight: 600;
}

.StatSuiviGlobal_recommendationCards {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(350px, 1fr));
    gap: 20px;
}

.StatSuiviGlobal_recommendationCard {
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    padding: 15px;
    transition: transform 0.2s;
}

.StatSuiviGlobal_recommendationCard:hover {
    transform: translateY(-5px);
}

.StatSuiviGlobal_recommendationHeader {
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-bottom: 15px;
}

.StatSuiviGlobal_recommendationTitle {
    font-weight: 600;
}

.StatSuiviGlobal_recommendationBadge {
    font-size: 12px;
    padding: 4px 8px;
    border-radius: 50px;
    display: flex;
    align-items: center;
}

.StatSuiviGlobal_recommendationBadge i {
    margin-right: 5px;
}

.StatSuiviGlobal_recommendationBadge.positive {
    background-color: #e8f5e9;
    color: #28a745;
}

.StatSuiviGlobal_recommendationBadge.warning {
    background-color: #fff8e1;
    color: #ffc107;
}

.StatSuiviGlobal_recommendationBadge.danger {
    background-color: #ffebee;
    color: #dc3545;
}

.StatSuiviGlobal_recommendationProduct {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
    padding-bottom: 15px;
    border-bottom: 1px solid #eee;
}

.StatSuiviGlobal_recommendationProduct img {
    width: 50px;
    height: 50px;
    object-fit: contain;
    margin-right: 15px;
}

.StatSuiviGlobal_recommendationProductName {
    font-weight: 600;
    margin-bottom: 3px;
}

.StatSuiviGlobal_recommendationProductCategory {
    font-size: 12px;
    color: #6c757d;
}

.StatSuiviGlobal_recommendationDetails {
    display: flex;
    flex-direction: column;
    gap: 8px;
    margin-bottom: 15px;
}

.StatSuiviGlobal_recommendationDetail {
    display: flex;
    justify-content: space-between;
    font-size: 14px;
}

.StatSuiviGlobal_recommendationDetail span {
    color: #6c757d;
}

.positive {
    color: #28a745;
}

.negative {
    color: #dc3545;
}

.StatSuiviGlobal_recommendationReason {
    background-color: #f8f9fa;
    padding: 10px;
    border-radius: 5px;
    margin-bottom: 15px;
    font-size: 13px;
    color: #6c757d;
}

.StatSuiviGlobal_recommendationActions {
    display: flex;
    gap: 10px;
}

.StatSuiviGlobal_recommendationActionBtn {
    flex: 1;
    border: none;
    padding: 8px 0;
    border-radius: 5px;
    cursor: pointer;
    font-size: 14px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.StatSuiviGlobal_recommendationActionBtn.primary {
    background-color: var(--primary);
    color: white;
}

.StatSuiviGlobal_recommendationActionBtn.secondary {
    background-color: #f8f9fa;
    color: #6c757d;
    border: 1px solid #ddd;
}

.StatSuiviGlobal_recommendationSummary {
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    padding: 20px;
    height: 100%;
}

.StatSuiviGlobal_recommendationSummary h5 {
    margin-bottom: 15px;
    font-weight: 600;
}

.StatSuiviGlobal_recommendationSummaryContent {
    margin-bottom: 20px;
}

.StatSuiviGlobal_recommendationSummaryItem {
    display: flex;
    align-items: center;
    margin-bottom: 15px;
}

.StatSuiviGlobal_recommendationSummaryIcon {
    width: 40px;
    height: 40px;
    border-radius: 8px;
    display: flex;
    align-items: center;
    justify-content: center;
    margin-right: 15px;
    font-size: 18px;
}

.StatSuiviGlobal_recommendationSummaryIcon.danger {
    background-color: #ffebee;
    color: #dc3545;
}

.StatSuiviGlobal_recommendationSummaryIcon.warning {
    background-color: #fff8e1;
    color: #ffc107;
}

.StatSuiviGlobal_recommendationSummaryIcon.info {
    background-color: #e3f2fd;
    color: #2196f3;
}

.StatSuiviGlobal_recommendationSummaryText {
    flex: 1;
}

.StatSuiviGlobal_recommendationSummaryTitle {
    font-weight: 600;
    margin-bottom: 3px;
}

.StatSuiviGlobal_recommendationSummaryValue {
    font-size: 18px;
    font-weight: 700;
}

.StatSuiviGlobal_recommendationReport {
    background-color: #f8f9fa;
    padding: 15px;
    border-radius: 8px;
    margin-bottom: 20px;
}

.StatSuiviGlobal_recommendationReport h6 {
    margin-bottom: 15px;
    font-weight: 600;
}

.StatSuiviGlobal_recommendationReportItem {
    margin-bottom: 10px;
}

.StatSuiviGlobal_recommendationReportLabel {
    display: flex;
    justify-content: space-between;
    margin-bottom: 5px;
    font-size: 14px;
}

.StatSuiviGlobal_recommendationReportBar {
    height: 8px;
    background-color: #e9ecef;
    border-radius: 4px;
    overflow: hidden;
}

.StatSuiviGlobal_recommendationReportProgress {
    height: 100%;
    background-color: var(--primary);
    border-radius: 4px;
}

.StatSuiviGlobal_quickActions {
    display: flex;
    flex-direction: column;
    gap: 10px;
}

.StatSuiviGlobal_quickActions h6 {
    margin-bottom: 10px;
    font-weight: 600;
}

.StatSuiviGlobal_quickActionBtn {
    background-color: #f8f9fa;
    border: 1px solid #ddd;
    border-radius: 5px;
    padding: 10px;
    text-align: center;
    cursor: pointer;
    transition: all 0.2s;
    display: flex;
    align-items: center;
    justify-content: center;
}

.StatSuiviGlobal_quickActionBtn:hover {
    background-color: #e9ecef;
}

.StatSuiviGlobal_quickActionBtn i {
    margin-right: 8px;
}

/* Styles pour les tops performances */
.StatSuiviGlobal_topPerformanceTabs {
    display: flex;
    border-bottom: 1px solid #eee;
    margin-bottom: 20px;
    overflow-x: auto;
}

.StatSuiviGlobal_topPerformanceTab {
    background: none;
    border: none;
    padding: 10px 15px;
    position: relative;
    cursor: pointer;
    white-space: nowrap;
}

.StatSuiviGlobal_topPerformanceTab::after {
    content: '';
    position: absolute;
    bottom: -1px;
    left: 0;
    right: 0;
    height: 3px;
    background-color: transparent;
    transition: all 0.2s;
}

.StatSuiviGlobal_topPerformanceTab.active {
    color: var(--primary);
    font-weight: 600;
}

.StatSuiviGlobal_topPerformanceTab.active::after {
    background-color: var(--primary);
}

.StatSuiviGlobal_bestProduct {
    background-color: #f8f9fa;
    border-radius: 10px;
    margin-bottom: 20px;
    overflow: hidden;
}

.StatSuiviGlobal_bestProductBadge {
    background-color: var(--primary);
    color: white;
    padding: 8px 15px;
    display: flex;
    align-items: center;
    font-weight: 600;
}

.StatSuiviGlobal_bestProductBadge i {
    margin-right: 8px;
}

.StatSuiviGlobal_bestProductContent {
    padding: 15px;
    display: flex;
    align-items: center;
}

.StatSuiviGlobal_bestProductImage {
    width: 80px;
    height: 80px;
    display: flex;
    align-items: center;
    justify-content: center;
    background-color: white;
    border-radius: 8px;
    margin-right: 20px;
}

.StatSuiviGlobal_bestProductImage img {
    max-width: 100%;
    max-height: 100%;
    object-fit: contain;
}

.StatSuiviGlobal_bestProductInfo {
    flex: 1;
}

.StatSuiviGlobal_bestProductInfo h5 {
    margin-bottom: 5px;
    font-weight: 600;
}

.StatSuiviGlobal_bestProductCategory {
    color: #6c757d;
    margin-bottom: 10px;
}

.StatSuiviGlobal_bestProductStats {
    display: flex;
    flex-wrap: wrap;
    gap: 15px;
}

.StatSuiviGlobal_bestProductStat {
    background-color: white;
    padding: 10px 15px;
    border-radius: 8px;
    min-width: 100px;
}

.StatSuiviGlobal_bestProductStatLabel {
    color: #6c757d;
    font-size: 12px;
    margin-bottom: 3px;
}

.StatSuiviGlobal_bestProductStatValue {
    font-size: 18px;
    font-weight: 700;
}

.StatSuiviGlobal_topProducts {
    display: grid;
    grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
    gap: 15px;
}

.StatSuiviGlobal_topProductCard {
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 2px 8px rgba(0, 0, 0, 0.05);
    padding: 15px;
    display: flex;
    align-items: center;
}

.StatSuiviGlobal_topProductRank {
    width: 36px;
    height: 36px;
    border-radius: 50%;
    background-color: #f8f9fa;
    color: #6c757d;
    display: flex;
    align-items: center;
    justify-content: center;
    font-weight: 700;
    margin-right: 15px;
}

.StatSuiviGlobal_topProductRank.top-1 {
    background-color: #ffd700;
    color: white;
}

.StatSuiviGlobal_topProductRank.top-2 {
    background-color: #c0c0c0;
    color: white;
}

.StatSuiviGlobal_topProductRank.top-3 {
    background-color: #cd7f32;
    color: white;
}

.StatSuiviGlobal_topProductRank.top-4,
.StatSuiviGlobal_topProductRank.top-5 {
    background-color: #e9ecef;
    color: #343a40;
}

.StatSuiviGlobal_topProductInfo {
    flex: 1;
}

.StatSuiviGlobal_topProductName {
    font-weight: 600;
    margin-bottom: 3px;
}

.StatSuiviGlobal_topProductCategory {
    font-size: 12px;
    color: #6c757d;
    margin-bottom: 5px;
}

.StatSuiviGlobal_topProductValue {
    font-weight: 700;
    color: var(--primary);
}

/* Styles pour les rapports */
.StatSuiviGlobal_reports {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
    gap: 20px;
}

.StatSuiviGlobal_reportCard {
    background-color: white;
    border-radius: 8px;
    box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
    padding: 15px;
    display: flex;
    align-items: center;
    transition: transform 0.2s;
}

.StatSuiviGlobal_reportCard:hover {
    transform: translateY(-5px);
}

.StatSuiviGlobal_reportIcon {
    width: 50px;
    height: 50px;
    border-radius: 10px;
    background-color: rgba(230, 0, 0, 0.1);
    color: var(--primary);
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 24px;
    margin-right: 15px;
}

.StatSuiviGlobal_reportContent {
    flex: 1;
}

.StatSuiviGlobal_reportTitle {
    font-weight: 600;
    margin-bottom: 5px;
}

.StatSuiviGlobal_reportDesc {
    font-size: 13px;
    color: #6c757d;
}

.StatSuiviGlobal_reportButton {
    background-color: var(--primary);
    color: white;
    border: none;
    border-radius: 5px;
    padding: 8px 12px;
    cursor: pointer;
    font-size: 14px;
    display: flex;
    align-items: center;
    white-space: nowrap;
}

.StatSuiviGlobal_reportButton i {
    margin-right: 5px;
}

/* Responsive design */
@media (max-width: 768px) {
    .StatSuiviGlobal_filterContainer {
        flex-direction: column;
        align-items: stretch;
    }
    
    .StatSuiviGlobal_additionalFilters {
        margin-top: 15px;
        justify-content: flex-start;
    }
    
    .StatSuiviGlobal_bestProductContent {
        flex-direction: column;
        text-align: center;
    }
    
    .StatSuiviGlobal_bestProductImage {
        margin-right: 0;
        margin-bottom: 15px;
    }
    
    .StatSuiviGlobal_bestProductStats {
        justify-content: center;
    }
    
    .StatSuiviGlobal_chartControls {
        flex-direction: column;
        gap: 10px;
    }
    
    .StatSuiviGlobal_tabControls {
        flex-direction: column;
        gap: 10px;
    }
    
    .StatSuiviGlobal_searchContainer {
        width: 100%;
    }
    
    .StatSuiviGlobal_forecastControls {
        flex-direction: column;
        align-items: stretch;
    }
    
    .StatSuiviGlobal_recommendationDetail {
        flex-direction: column;
        align-items: flex-start;
    }
}

</style>

<script>
// Module de suivi global et statistiques
document.addEventListener('DOMContentLoaded', function() {
    // Initialiser les graphiques après chargement de la page
    if (typeof ApexCharts !== 'undefined') {
        initializeStatSuiviGlobalCharts();
    } else {
        // Charger ApexCharts si pas déjà chargé
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/apexcharts';
        script.onload = initializeStatSuiviGlobalCharts;
        document.head.appendChild(script);
        
        // Charger le CSS d'ApexCharts
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = 'https://cdn.jsdelivr.net/npm/apexcharts/dist/apexcharts.css';
        document.head.appendChild(link);
    }
    
    // Initialiser les interactions UI
    initializeStatSuiviGlobalUI();
    
    // Charger les données simulées
    loadStatSuiviGlobalData();
});

// Initialisation des graphiques
function initializeStatSuiviGlobalCharts() {
    // Graphique principal (ventes et revenus)
    renderMainChart();
    
    // Graphique des catégories
    renderCategoryChart();
    
    // Distribution du stock
    renderStockDistribution();
    
    // Graphique de prévisions
    renderForecastChart();
}

// Initialisation des interactions UI
function initializeStatSuiviGlobalUI() {
    // Gestion des filtres de période
    const toggleFiltersBtn = document.getElementById('StatSuiviGlobal_toggleFilters');
    const filtersContainer = document.getElementById('StatSuiviGlobal_filtersContainer');
    const changePeriodBtn = document.getElementById('StatSuiviGlobal_changePeriod');
    const periodOptions = document.getElementById('StatSuiviGlobal_periodOptions');
    const currentPeriod = document.getElementById('StatSuiviGlobal_currentPeriod');
    
    if (toggleFiltersBtn) {
        toggleFiltersBtn.addEventListener('click', function() {
            filtersContainer.style.display = filtersContainer.style.display === 'none' ? 'block' : 'none';
        });
    }
    
    if (changePeriodBtn) {
        changePeriodBtn.addEventListener('click', function(e) {
            e.stopPropagation();
            periodOptions.style.display = 'block';
        });
    }
    
    // Fermer les options de filtre quand on clique ailleurs
    document.addEventListener('click', function(e) {
        if (periodOptions && periodOptions.style.display === 'block' &&
            !e.target.closest('#StatSuiviGlobal_periodOptions') && 
            e.target !== changePeriodBtn) {
            periodOptions.style.display = 'none';
        }
    });
    
    // Gestion des boutons de période prédéfinie
    const filterItems = document.querySelectorAll('.StatSuiviGlobal_filterItem');
    if (filterItems.length) {
        filterItems.forEach(item => {
            item.addEventListener('click', function() {
                // Retirer la classe active de tous les éléments
                filterItems.forEach(i => i.classList.remove('active'));
                // Ajouter la classe active à l'élément cliqué
                this.classList.add('active');
                
                // Mettre à jour la période affichée
                const periodText = this.textContent.trim();
                if (currentPeriod) currentPeriod.textContent = periodText;
                
                // Fermer les options de période
                if (periodOptions) periodOptions.style.display = 'none';
                
                // Actualiser les données
                refreshStatSuiviGlobalData(this.dataset.period);
            });
        });
    }
    
    // Initialiser les selects personnalisés
    initializeCustomSelects();
    
    // Gestion des onglets de données
    const dataTabs = document.querySelectorAll('#StatSuiviGlobal_dataTabs .nav-link');
    if (dataTabs.length) {
        dataTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                // Si on charge un onglet particulier, initialiser son contenu
                const tabId = this.getAttribute('href');
                if (tabId === '#StatSuiviGlobal_forecastTab') {
                    // Réinitialiser le graphique de prévision quand on active l'onglet
                    setTimeout(() => {
                        renderForecastChart();
                    }, 100);
                }
            });
        });
    }
    
    // Gestion du type de graphique principal
    const chartTypeBtns = document.querySelectorAll('.StatSuiviGlobal_chartTypeBtn');
    if (chartTypeBtns.length) {
        chartTypeBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                chartTypeBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Modifier le type de graphique
                renderMainChart(this.dataset.type);
            });
        });
    }
    
    // Gestion de la période du graphique principal
    const chartPeriodBtns = document.querySelectorAll('.StatSuiviGlobal_chartPeriodBtn');
    if (chartPeriodBtns.length) {
        chartPeriodBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                chartPeriodBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Modifier la période du graphique
                renderMainChart(null, this.dataset.period);
            });
        });
    }
    
    // Gestion du filtre des top produits
    const topProductBtns = document.querySelectorAll('.StatSuiviGlobal_topProductBtn');
    if (topProductBtns.length) {
        topProductBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                topProductBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Charger les top produits selon le critère
                loadTopProducts(this.dataset.type);
            });
        });
    }
    
    // Gestion des onglets de top performance
    const topPerformanceTabs = document.querySelectorAll('.StatSuiviGlobal_topPerformanceTab');
    if (topPerformanceTabs.length) {
        topPerformanceTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                topPerformanceTabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // Cacher tous les contenus et afficher le bon
                const contents = document.querySelectorAll('.StatSuiviGlobal_topPerformanceList');
                contents.forEach(c => c.style.display = 'none');
                
                const content = document.querySelector(`.StatSuiviGlobal_topPerformanceList[data-content="${this.dataset.tab}"]`);
                if (content) content.style.display = 'block';
                
                // Charger les données spécifiques
                loadTopPerformanceData(this.dataset.tab);
            });
        });
    }
    
    // Gestion de la vue du stock (bulles ou mosaïque)
    const stockViewBtns = document.querySelectorAll('.StatSuiviGlobal_stockViewBtn');
    if (stockViewBtns.length) {
        stockViewBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                stockViewBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Modifier la vue du stock
                renderStockDistribution(this.dataset.view);
            });
        });
    }
    
    // Gestion des boutons d'analyse de stock
    const analysisBtns = document.querySelectorAll('.StatSuiviGlobal_analysisBtn');
    if (analysisBtns.length) {
        analysisBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                analysisBtns.forEach(b => b.classList.remove('active'));
                this.classList.add('active');
                
                // Charger les données d'analyse de stock
                loadStockAnalysisData(this.dataset.analysis);
            });
        });
    }
    
    // Initialiser la pagination
    initPagination();
    
    // Gestion de la recherche dans le tableau de performances
    const searchInput = document.querySelector('.StatSuiviGlobal_searchInput');
    if (searchInput) {
        searchInput.addEventListener('input', function() {
            filterPerformanceTable(this.value);
        });
    }
    
    // Bouton d'actualisation des données
    const refreshBtn = document.getElementById('StatSuiviGlobal_refreshData');
    if (refreshBtn) {
        refreshBtn.addEventListener('click', function() {
            // Animation de rotation de l'icône
            const icon = this.querySelector('i');
            icon.classList.add('fa-spin');
            
            // Simuler une actualisation des données
            setTimeout(() => {
                loadStatSuiviGlobalData();
                icon.classList.remove('fa-spin');
            }, 800);
        });
    }
}

// Initialiser les selects personnalisés
function initializeCustomSelects() {
    const customSelects = document.querySelectorAll('.StatSuiviGlobal_customSelect');
    
    customSelects.forEach(select => {
        const selectedOption = select.querySelector('.StatSuiviGlobal_selectedOption');
        const options = select.querySelector('.StatSuiviGlobal_options');
        
        if (selectedOption && options) {
            selectedOption.addEventListener('click', function(e) {
                e.stopPropagation();
                
                // Fermer tous les autres selects
                customSelects.forEach(s => {
                    if (s !== select) {
                        s.classList.remove('active');
                        s.querySelector('.StatSuiviGlobal_options').style.display = 'none';
                    }
                });
                
                // Toggle le select actuel
                select.classList.toggle('active');
                options.style.display = options.style.display === 'block' ? 'none' : 'block';
            });
            
            // Gestion des options
            const optionElements = options.querySelectorAll('.StatSuiviGlobal_option');
            optionElements.forEach(option => {
                option.addEventListener('click', function() {
                    // Mettre à jour la valeur sélectionnée
                    const span = selectedOption.querySelector('span');
                    if (span) span.textContent = this.textContent.trim();
                    
                    // Fermer le select
                    options.style.display = 'none';
                    select.classList.remove('active');
                    
                    // Exécuter une action selon le type de select
                    if (select.id === 'StatSuiviGlobal_yearSelect') {
                        updateDaysInMonth();
                    } else if (select.id === 'StatSuiviGlobal_monthSelect') {
                        updateDaysInMonth();
                    } else if (select.closest('.StatSuiviGlobal_sortContainer')) {
                        sortPerformanceTable(this.dataset.sort, this.dataset.order);
                    }
                });
            });
        }
    });
    
    // Fermer les selects quand on clique ailleurs
    document.addEventListener('click', function() {
        customSelects.forEach(select => {
            select.classList.remove('active');
            const options = select.querySelector('.StatSuiviGlobal_options');
            if (options) options.style.display = 'none';
        });
    });
    
    // Mettre à jour les jours disponibles dans le select de jours
    function updateDaysInMonth() {
        const yearSelect = document.getElementById('StatSuiviGlobal_yearSelect');
        const monthSelect = document.getElementById('StatSuiviGlobal_monthSelect');
        const dayOptions = document.getElementById('StatSuiviGlobal_dayOptions');
        
        if (yearSelect && monthSelect && dayOptions) {
            const year = yearSelect.querySelector('span').textContent.trim();
            const monthText = monthSelect.querySelector('span').textContent.trim();
            
            // Si le mois est "Tous", ne rien faire
            if (monthText === 'Tous') return;
            
            // Obtenir le numéro du mois (janvier = 1, février = 2, etc.)
            const monthNames = ['Janvier', 'Février', 'Mars', 'Avril', 'Mai', 'Juin', 
                              'Juillet', 'Août', 'Septembre', 'Octobre', 'Novembre', 'Décembre'];
            const month = monthNames.indexOf(monthText) + 1;
            
            // Calculer le nombre de jours dans le mois
            const daysInMonth = new Date(year, month, 0).getDate();
            
            // Vider les options de jours actuelles (sauf "Tous")
            let allOption = dayOptions.querySelector('.StatSuiviGlobal_option[data-value="all"]');
            dayOptions.innerHTML = '';
            if (allOption) dayOptions.appendChild(allOption);
            
            // Ajouter les jours
            for (let i = 1; i <= daysInMonth; i++) {
                const option = document.createElement('div');
                option.className = 'StatSuiviGlobal_option';
                option.dataset.value = i;
                option.textContent = i;
                dayOptions.appendChild(option);
            }
        }
    }
}

// Initialiser la pagination
function initPagination() {
    const paginationBtns = document.querySelectorAll('.StatSuiviGlobal_paginationBtn');
    
    if (paginationBtns.length) {
        paginationBtns.forEach(btn => {
            btn.addEventListener('click', function() {
                // Obtenir la page actuelle et le total
                const currentPage = parseInt(document.getElementById('StatSuiviGlobal_currentPage').textContent);
                const totalPages = parseInt(document.getElementById('StatSuiviGlobal_totalPages').textContent);
                
                let newPage = currentPage;
                
                // Déterminer la nouvelle page
                switch(this.dataset.page) {
                    case 'first':
                        newPage = 1;
                        break;
                    case 'prev':
                        newPage = Math.max(1, currentPage - 1);
                        break;
                    case 'next':
                        newPage = Math.min(totalPages, currentPage + 1);
                        break;
                    case 'last':
                        newPage = totalPages;
                        break;
                }
                
                // Mise à jour de l'affichage si la page a changé
                if (newPage !== currentPage) {
                    document.getElementById('StatSuiviGlobal_currentPage').textContent = newPage;
                    loadPerformanceTablePage(newPage);
                }
            });
        });
    }
}

// Charger les données simulées
function loadStatSuiviGlobalData() {
    // Charger les données du résumé global
    updateSummaryCards();
    
    // Charger les top produits
    loadTopProducts('sales');
    
    // Charger le tableau de performances
    loadPerformanceTable();
    
    // Charger les données d'analyse de stock
    loadStockAnalysisData('lowStock');
    
    // Charger les données de prévision
    loadForecastData();
    
    // Charger les tops performances
    loadTopPerformanceData('day');
}

// Actualiser les données selon la période sélectionnée
function refreshStatSuiviGlobalData(period) {
    // Simuler un chargement de données pour la période sélectionnée
    console.log(`Chargement des données pour la période: ${period}`);
    
    // Mettre à jour tous les composants avec les nouvelles données
    updateSummaryCards(period);
    renderMainChart(null, null, period);
    renderCategoryChart(period);
    loadTopProducts('sales', period);
    loadPerformanceTable(period);
    
    // Afficher une notification de succès
    showNotification('Données actualisées', `Les données ont été actualisées pour la période: ${getPeriodLabel(period)}`, 'success');
}

// Obtenir le libellé d'une période
function getPeriodLabel(period) {
    const labels = {
        'today': 'Aujourd\'hui',
        'yesterday': 'Hier',
        'this-week': 'Cette semaine',
        'last-week': 'Semaine dernière',
        'this-month': 'Ce mois-ci',
        'last-month': 'Mois dernier',
        'this-year': 'Cette année',
        'last-year': 'Année dernière',
        'all-time': 'Tout l\'historique'
    };
    
    return
  
</script>

<script>
  // Module de Suivi Global et Statistiques - Script complet
document.addEventListener('DOMContentLoaded', function() {
    // Initialisation des bibliothèques
    initCharts();
    
    // Configuration des écouteurs d'événements
    setupEventListeners();
    
    // Chargement des données initiales
    loadData('this-week');
    
    // Génération des tableaux et des listes
    generateTables();
    generateTopProductsList();
    
    // Initialisation des filtres personnalisés
    initCustomSelects();
    populateDayOptions();
});

// ===== DONNÉES SIMULÉES =====
// Fonction pour générer des données simulées mais réalistes
function generateMockData() {
    // Catégories et produits
    const categories = [
        { id: 1, name: "Antennes & Réception" },
        { id: 2, name: "Câbles & Accessoires" },
        { id: 3, name: "Adaptateurs & Connecteurs" },
        { id: 4, name: "Télécommandes" },
        { id: 5, name: "Audio & Vidéo" }
    ];
    
    const products = [
        { id: 1, name: "Antenne TV Extérieure", categoryId: 1, price: 49.99, stock: 28, threshold: 10 },
        { id: 2, name: "Antenne TV Intérieure Amplifiée", categoryId: 1, price: 29.99, stock: 45, threshold: 15 },
        { id: 3, name: "Câble HDMI Premium 2m", categoryId: 2, price: 14.99, stock: 5, threshold: 20 },
        { id: 4, name: "Câble HDMI Premium 4K 2m", categoryId: 2, price: 14.99, stock: 87, threshold: 20 },
        { id: 5, name: "Adaptateur HDMI vers VGA", categoryId: 3, price: 19.99, stock: 124, threshold: 15 },
        { id: 6, name: "Adaptateur DisplayPort vers HDMI", categoryId: 3, price: 24.99, stock: 32, threshold: 10 },
        { id: 7, name: "Télécommande Universelle", categoryId: 4, price: 12.99, stock: 145, threshold: 20 },
        { id: 8, name: "Télécommande de remplacement Samsung", categoryId: 4, price: 15.99, stock: 52, threshold: 15 },
        { id: 9, name: "Câble Optique Audio 1.5m", categoryId: 5, price: 9.99, stock: 78, threshold: 25 },
        { id: 10, name: "Convertisseur Audio Numérique", categoryId: 5, price: 34.99, stock: 17, threshold: 8 },
        { id: 11, name: "Antenne Satellite", categoryId: 1, price: 79.99, stock: 12, threshold: 5 },
        { id: 12, name: "Répartiteur HDMI 1x4", categoryId: 3, price: 29.99, stock: 9, threshold: 10 },
        { id: 13, name: "Câble Coaxial 2m", categoryId: 2, price: 8.99, stock: 0, threshold: 20 },
        { id: 14, name: "Support TV Mural", categoryId: 5, price: 39.99, stock: 25, threshold: 10 },
        { id: 15, name: "Câble VGA 3m", categoryId: 2, price: 11.99, stock: 35, threshold: 15 }
    ];

    // Générer des ventes aléatoires pour chaque produit sur différentes périodes
    const today = new Date();
    const sales = [];
    
    // Générer des ventes pour aujourd'hui
    for (let i = 0; i < products.length; i++) {
        const product = products[i];
        const dailySales = Math.floor(Math.random() * 10); // Entre 0 et 9 ventes par jour
        
        for (let j = 0; j < dailySales; j++) {
            const saleHour = Math.floor(Math.random() * 12) + 8; // Entre 8h et 20h
            const saleDate = new Date(today);
            saleDate.setHours(saleHour, Math.floor(Math.random() * 60), 0, 0);
            
            sales.push({
                id: sales.length + 1,
                productId: product.id,
                quantity: Math.floor(Math.random() * 3) + 1, // Entre 1 et 3 unités par vente
                price: product.price,
                date: saleDate
            });
        }
    }
    
    // Générer des ventes pour les jours précédents (30 derniers jours)
    for (let day = 1; day <= 30; day++) {
        const saleDate = new Date(today);
        saleDate.setDate(today.getDate() - day);
        
        for (let i = 0; i < products.length; i++) {
            const product = products[i];
            const dailySales = Math.floor(Math.random() * 15); // Entre 0 et 14 ventes par jour
            
            for (let j = 0; j < dailySales; j++) {
                const saleHour = Math.floor(Math.random() * 12) + 8; // Entre 8h et 20h
                const exactSaleDate = new Date(saleDate);
                exactSaleDate.setHours(saleHour, Math.floor(Math.random() * 60), 0, 0);
                
                sales.push({
                    id: sales.length + 1,
                    productId: product.id,
                    quantity: Math.floor(Math.random() * 3) + 1, // Entre 1 et 3 unités par vente
                    price: product.price,
                    date: exactSaleDate
                });
            }
        }
    }
    
    // Générer l'historique des approvisionnements
    const supplies = [];
    for (let i = 0; i < products.length; i++) {
        const product = products[i];
        const supplyCount = Math.floor(Math.random() * 5) + 1; // Entre 1 et 5 approvisionnements
        
        for (let j = 0; j < supplyCount; j++) {
            const daysAgo = Math.floor(Math.random() * 60); // Dans les 60 derniers jours
            const supplyDate = new Date(today);
            supplyDate.setDate(today.getDate() - daysAgo);
            
            supplies.push({
                id: supplies.length + 1,
                productId: product.id,
                quantity: Math.floor(Math.random() * 50) + 10, // Entre 10 et 59 unités
                date: supplyDate
            });
        }
    }
    
    return {
        categories,
        products,
        sales,
        supplies
    };
}

// Base de données simulée
const mockData = generateMockData();

// ===== FONCTIONS DE GESTION DES DONNÉES =====
// Fonction pour filtrer les ventes selon une période
function filterSalesByPeriod(period, startDate = null, endDate = null) {
    const today = new Date();
    today.setHours(23, 59, 59, 999);
    
    const yesterday = new Date(today);
    yesterday.setDate(yesterday.getDate() - 1);
    yesterday.setHours(0, 0, 0, 0);
    
    const thisWeekStart = new Date(today);
    thisWeekStart.setDate(today.getDate() - today.getDay());
    thisWeekStart.setHours(0, 0, 0, 0);
    
    const lastWeekStart = new Date(thisWeekStart);
    lastWeekStart.setDate(lastWeekStart.getDate() - 7);
    
    const lastWeekEnd = new Date(thisWeekStart);
    lastWeekEnd.setSeconds(lastWeekEnd.getSeconds() - 1);
    
    const thisMonthStart = new Date(today.getFullYear(), today.getMonth(), 1);
    
    const lastMonthStart = new Date(today.getFullYear(), today.getMonth() - 1, 1);
    const lastMonthEnd = new Date(today.getFullYear(), today.getMonth(), 0, 23, 59, 59, 999);
    
    const thisYearStart = new Date(today.getFullYear(), 0, 1);
    
    const lastYearStart = new Date(today.getFullYear() - 1, 0, 1);
    const lastYearEnd = new Date(today.getFullYear() - 1, 11, 31, 23, 59, 59, 999);
    
    switch(period) {
        case 'today':
            return mockData.sales.filter(sale => sale.date >= thisWeekStart && sale.date <= today);
        case 'yesterday':
            return mockData.sales.filter(sale => sale.date >= yesterday && sale.date < new Date(today).setHours(0, 0, 0, 0));
        case 'this-week':
            return mockData.sales.filter(sale => sale.date >= thisWeekStart && sale.date <= today);
        case 'last-week':
            return mockData.sales.filter(sale => sale.date >= lastWeekStart && sale.date <= lastWeekEnd);
        case 'this-month':
            return mockData.sales.filter(sale => sale.date >= thisMonthStart && sale.date <= today);
        case 'last-month':
            return mockData.sales.filter(sale => sale.date >= lastMonthStart && sale.date <= lastMonthEnd);
        case 'this-year':
            return mockData.sales.filter(sale => sale.date >= thisYearStart && sale.date <= today);
        case 'last-year':
            return mockData.sales.filter(sale => sale.date >= lastYearStart && sale.date <= lastYearEnd);
        case 'all-time':
            return mockData.sales;
        case 'custom':
            if (startDate && endDate) {
                const start = new Date(startDate);
                start.setHours(0, 0, 0, 0);
                const end = new Date(endDate);
                end.setHours(23, 59, 59, 999);
                return mockData.sales.filter(sale => sale.date >= start && sale.date <= end);
            }
            return mockData.sales;
        case 'precise':
            if (startDate && endDate) {
                return mockData.sales.filter(sale => {
                    const saleDate = new Date(sale.date);
                    return saleDate >= startDate && saleDate <= endDate;
                });
            }
            return mockData.sales;
        default:
            return mockData.sales;
    }
}

// Fonction pour calculer les statistiques de vente par période
function calculateSalesStatistics(period) {
    const filteredSales = filterSalesByPeriod(period);
    
    // Calcul du revenu total
    const totalRevenue = filteredSales.reduce((total, sale) => {
        return total + (sale.quantity * sale.price);
    }, 0);
    
    // Calcul du nombre total de ventes
    const totalSalesCount = filteredSales.length;
    
    // Calcul des ventes par produit
    const salesByProduct = {};
    const revenueByProduct = {};
    
    filteredSales.forEach(sale => {
        if (!salesByProduct[sale.productId]) {
            salesByProduct[sale.productId] = 0;
            revenueByProduct[sale.productId] = 0;
        }
        
        salesByProduct[sale.productId] += sale.quantity;
        revenueByProduct[sale.productId] += sale.quantity * sale.price;
    });
    
    // Calcul des ventes par catégorie
    const salesByCategory = {};
    const revenueByCatgory = {};
    
    filteredSales.forEach(sale => {
        const product = mockData.products.find(p => p.id === sale.productId);
        if (product) {
            if (!salesByCategory[product.categoryId]) {
                salesByCategory[product.categoryId] = 0;
                revenueByCatgory[product.categoryId] = 0;
            }
            
            salesByCategory[product.categoryId] += sale.quantity;
            revenueByCatgory[product.categoryId] += sale.quantity * sale.price;
        }
    });
    
    // Valeur totale du stock
    const stockValue = mockData.products.reduce((total, product) => {
        return total + (product.price * product.stock);
    }, 0);
    
    // Calcul de la marge bénéficiaire (simplifié, en supposant 40% de marge)
    const profitMargin = totalRevenue > 0 ? 40 : 0;
    
    return {
        totalRevenue,
        totalSalesCount,
        salesByProduct,
        revenueByProduct,
        salesByCategory,
        revenueByCatgory,
        stockValue,
        profitMargin
    };
}

// Fonction pour charger les données selon la période sélectionnée
function loadData(period, startDate = null, endDate = null) {
    // Statistiques pour la période sélectionnée
    const stats = calculateSalesStatistics(period);
    
    // Mise à jour du résumé global
    updateSummary(stats);
    
    // Mise à jour des graphiques
    updateCharts(stats, period);
    
    // Mise à jour des listes de produits
    updateProductsList(stats);
    
    // Mise à jour des tableaux
    updateTables(stats);
    
    // Mise à jour de la période active
    document.getElementById('StatSuiviGlobal_currentPeriod').textContent = getPeriodLabel(period);
    
    // Mettre à jour les données de prévision
    updateForecasts(stats);
    
    // Mettre à jour les recommandations
    updateRecommendations(stats);
    
    // Mise à jour des alertes de stock
    updateStockAlerts();
}

// Traduire la valeur de période en libellé affichable
function getPeriodLabel(period) {
    const labels = {
        'today': 'Aujourd\'hui',
        'yesterday': 'Hier',
        'this-week': 'Cette semaine',
        'last-week': 'Semaine dernière',
        'this-month': 'Ce mois-ci',
        'last-month': 'Mois dernier',
        'this-year': 'Cette année',
        'last-year': 'Année dernière',
        'all-time': 'Tout l\'historique',
        'custom': 'Période personnalisée',
        'precise': 'Sélection précise'
    };
    
    return labels[period] || 'Période non définie';
}

// Mise à jour du résumé global
function updateSummary(stats) {
    document.getElementById('StatSuiviGlobal_totalRevenue').textContent = formatCurrency(stats.totalRevenue);
    document.getElementById('StatSuiviGlobal_totalSales').textContent = stats.totalSalesCount;
    document.getElementById('StatSuiviGlobal_stockValue').textContent = formatCurrency(stats.stockValue);
    document.getElementById('StatSuiviGlobal_profitMargin').textContent = stats.profitMargin + '%';
}

// Mise à jour des listes de produits
function updateProductsList(stats) {
    const topProductsList = document.getElementById('StatSuiviGlobal_topProductsList');
    topProductsList.innerHTML = '';
    
    // Tri des produits par ventes
    const productSales = Object.entries(stats.salesByProduct).map(([productId, sales]) => {
        return {
            product: mockData.products.find(p => p.id == productId),
            sales,
            revenue: stats.revenueByProduct[productId] || 0
        };
    }).sort((a, b) => b.sales - a.sales);
    
    // Affichage des 5 meilleurs produits
    const topProducts = productSales.slice(0, 5);
    
    topProducts.forEach((item, index) => {
        const product = item.product;
        if (!product) return;
        
        const category = mockData.categories.find(c => c.id === product.categoryId);
        const categoryName = category ? category.name : 'Non catégorisé';
        
        const productElement = document.createElement('div');
        productElement.className = 'StatSuiviGlobal_productItem';
        
        const rank = index + 1;
        const rankClass = rank <= 3 ? `top-${rank}` : '';
        
        productElement.innerHTML = `
            <div class="StatSuiviGlobal_productRank ${rankClass}">${rank}</div>
            <div class="StatSuiviGlobal_productDetails">
                <div class="StatSuiviGlobal_productName">${product.name}</div>
                <div class="StatSuiviGlobal_productCategory">${categoryName}</div>
            </div>
            <div class="StatSuiviGlobal_productStats">
                <div class="StatSuiviGlobal_productStat">
                    <span>${item.sales}</span>
                    <small>ventes</small>
                </div>
                <div class="StatSuiviGlobal_productStat">
                    <span>${formatCurrency(item.revenue)}</span>
                    <small>revenus</small>
                </div>
            </div>
        `;
        
        topProductsList.appendChild(productElement);
    });
    
    // Si moins de 5 produits vendus, afficher un message
    if (topProducts.length === 0) {
        const emptyElement = document.createElement('div');
        emptyElement.className = 'StatSuiviGlobal_emptyProductsList';
        emptyElement.innerHTML = `
            <i class="fas fa-info-circle"></i>
            <span>Aucune vente pour cette période</span>
        `;
        topProductsList.appendChild(emptyElement);
    }
}

// ===== GESTION DES ÉVÉNEMENTS =====
function setupEventListeners() {
    // Événements de navigation
    document.querySelector('[data-section="StatSuiviGlobal"]').addEventListener('click', function(e) {
        e.preventDefault();
        showSection('StatSuiviGlobal');
    });
    
    // Événements de filtrage
    document.getElementById('StatSuiviGlobal_toggleFilters').addEventListener('click', toggleFilters);
    document.getElementById('StatSuiviGlobal_changePeriod').addEventListener('click', function() {
        document.getElementById('StatSuiviGlobal_periodOptions').style.display = 'block';
    });
    
    // Fermeture des options de filtre
    document.querySelectorAll('.StatSuiviGlobal_closeFilterBtn').forEach(btn => {
        btn.addEventListener('click', function() {
            this.closest('.StatSuiviGlobal_filterOptions').style.display = 'none';
        });
    });
    
    // Sélection de période prédéfinie
    document.querySelectorAll('.StatSuiviGlobal_filterItem').forEach(item => {
        item.addEventListener('click', function() {
            const period = this.getAttribute('data-period');
            
            // Mise à jour de la sélection visuelle
            document.querySelectorAll('.StatSuiviGlobal_filterItem').forEach(i => {
                i.classList.remove('active');
            });
            this.classList.add('active');
            
            // Fermeture du menu de filtres
            document.getElementById('StatSuiviGlobal_periodOptions').style.display = 'none';
            
            // Chargement des données pour la période sélectionnée
            loadData(period);
        });
    });
    
    // Application de la période personnalisée
    document.querySelector('.StatSuiviGlobal_applyCustomDate').addEventListener('click', function() {
        const startDate = document.getElementById('StatSuiviGlobal_startDate').value;
        const endDate = document.getElementById('StatSuiviGlobal_endDate').value;
        
        if (startDate && endDate) {
            // Fermeture du menu de filtres
            document.getElementById('StatSuiviGlobal_periodOptions').style.display = 'none';
            
            // Chargement des données pour la période personnalisée
            loadData('custom', startDate, endDate);
            
            // Mise à jour de l'affichage de la période
            const formattedStart = new Date(startDate).toLocaleDateString();
            const formattedEnd = new Date(endDate).toLocaleDateString();
            document.getElementById('StatSuiviGlobal_currentPeriod').textContent = `Du ${formattedStart} au ${formattedEnd}`;
        }
    });
    
    // Actualisation des données
    document.getElementById('StatSuiviGlobal_refreshData').addEventListener('click', function() {
        const currentPeriod = document.querySelector('.StatSuiviGlobal_filterItem.active')?.getAttribute('data-period') || 'this-week';
        loadData(currentPeriod);
    });
    
    // Contrôles des graphiques
    document.querySelectorAll('.StatSuiviGlobal_chartTypeBtn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.querySelectorAll('.StatSuiviGlobal_chartTypeBtn').forEach(b => {
                b.classList.remove('active');
            });
            this.classList.add('active');
            
            const chartType = this.getAttribute('data-type');
            updateMainChartType(chartType);
        });
    });
    
    document.querySelectorAll('.StatSuiviGlobal_chartPeriodBtn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.querySelectorAll('.StatSuiviGlobal_chartPeriodBtn').forEach(b => {
                b.classList.remove('active');
            });
            this.classList.add('active');
            
            const period = this.getAttribute('data-period');
            updateMainChartPeriod(period);
        });
    });
    
    // Filtre des top produits
    document.querySelectorAll('.StatSuiviGlobal_topProductBtn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.querySelectorAll('.StatSuiviGlobal_topProductBtn').forEach(b => {
                b.classList.remove('active');
            });
            this.classList.add('active');
            
            const filterType = this.getAttribute('data-type');
            updateTopProductsFilter(filterType);
        });
    });
    
    // Contrôles de visualisation du stock
    document.querySelectorAll('.StatSuiviGlobal_stockViewBtn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.querySelectorAll('.StatSuiviGlobal_stockViewBtn').forEach(b => {
                b.classList.remove('active');
            });
            this.classList.add('active');
            
            const viewType = this.getAttribute('data-view');
            updateStockVisualization(viewType);
        });
    });
    
    // Gestion des onglets Top Performances
    document.querySelectorAll('.StatSuiviGlobal_topPerformanceTab').forEach(tab => {
        tab.addEventListener('click', function() {
            const tabValue = this.getAttribute('data-tab');
            
            // Mise à jour des onglets actifs
            document.querySelectorAll('.StatSuiviGlobal_topPerformanceTab').forEach(t => {
                t.classList.remove('active');
            });
            this.classList.add('active');
            
            // Affichage du contenu correspondant
            document.querySelectorAll('.StatSuiviGlobal_topPerformanceList').forEach(content => {
                content.style.display = 'none';
            });
            document.querySelector(`.StatSuiviGlobal_topPerformanceList[data-content="${tabValue}"]`).style.display = 'block';
        });
    });
    
    // Événements pour l'onglet d'analyse de stock
    document.querySelectorAll('.StatSuiviGlobal_analysisBtn').forEach(btn => {
        btn.addEventListener('click', function() {
            document.querySelectorAll('.StatSuiviGlobal_analysisBtn').forEach(b => {
                b.classList.remove('active');
            });
            this.classList.add('active');
            
            const analysisType = this.getAttribute('data-analysis');
            updateStockAnalysis(analysisType);
        });
    });
    
    // Événements pour les alertes de stock
    document.querySelectorAll('.StatSuiviGlobal_alertButton').forEach(btn => {
        btn.addEventListener('click', function() {
            const alertType = this.closest('.StatSuiviGlobal_alertCard').classList.contains('danger') ? 'outOfStock' :
                              this.closest('.StatSuiviGlobal_alertCard').classList.contains('warning') ? 'lowStock' :
                              this.closest('.StatSuiviGlobal_alertCard').classList.contains('info') ? 'overStock' : 'optimalStock';
            
            // Activer l'onglet Stock
            document.querySelector('[href="#StatSuiviGlobal_stockTab"]').click();
            
            // Sélectionner le type d'analyse correspondant
            document.querySelector(`.StatSuiviGlobal_analysisBtn[data-analysis="${alertType}"]`).click();
        });
    });
    
    // Gestion des contrôles de prévision
    document.querySelectorAll('.StatSuiviGlobal_option[data-forecast]').forEach(option => {
        option.addEventListener('click', function() {
            const forecastPeriod = this.getAttribute('data-forecast');
            updateForecastPeriod(forecastPeriod);
        });
    });
    
    document.querySelectorAll('.StatSuiviGlobal_option[data-forecast-type]').forEach(option => {
        option.addEventListener('click', function() {
            const forecastType = this.getAttribute('data-forecast-type');
            updateForecastType(forecastType);
        });
    });
    
    // Événements pour les sélecteurs personnalisés
    document.querySelectorAll('.StatSuiviGlobal_customSelect').forEach(select => {
        const selectedOption = select.querySelector('.StatSuiviGlobal_selectedOption');
        const options = select.querySelector('.StatSuiviGlobal_options');
        
        selectedOption.addEventListener('click', function() {
            // Fermer tous les autres sélecteurs
            document.querySelectorAll('.StatSuiviGlobal_options').forEach(opt => {
                if (opt !== options) {
                    opt.style.display = 'none';
                }
            });
            
            // Basculer l'affichage des options
            if (options.style.display === 'block') {
                options.style.display = 'none';
            } else {
                options.style.display = 'block';
            }
        });
    });
    
    // Événements pour l'application de la date précise
    document.querySelector('.StatSuiviGlobal_applyPreciseDate').addEventListener('click', function() {
        const year = document.querySelector('#StatSuiviGlobal_yearSelect .StatSuiviGlobal_selectedOption span').textContent;
        const month = document.querySelector('#StatSuiviGlobal_monthSelect .StatSuiviGlobal_selectedOption span').textContent;
        const day = document.querySelector('#StatSuiviGlobal_daySelect .StatSuiviGlobal_selectedOption span').textContent;
        
        // Fermeture du menu de filtres
        document.getElementById('StatSuiviGlobal_periodOptions').style.display = 'none';
        
        if (month === 'Tous' && day === 'Tous') {
            // Année complète
            const startDate = new Date(year, 0, 1);
            const endDate = new Date(year, 11, 31);
            loadData('precise', startDate, endDate);
            document.getElementById('StatSuiviGlobal_currentPeriod').textContent = `Année ${year}`;
        } else if (day === 'Tous' && month !== 'Tous') {
            // Mois complet
            const monthIndex = getMonthIndex(month);
            const startDate = new Date(year, monthIndex, 1);
            const endDate = new Date(year, monthIndex + 1, 0); // Dernier jour du mois
            loadData('precise', startDate, endDate);
            document.getElementById('StatSuiviGlobal_currentPeriod').textContent = `${month} ${year}`;
        } else if (day !== 'Tous' && month !== 'Tous') {
            // Jour précis
            const monthIndex = getMonthIndex(month);
            const startDate = new Date(year, monthIndex, parseInt(day));
            const endDate = new Date(year, monthIndex, parseInt(day), 23, 59, 59);
            loadData('precise', startDate, endDate);
            document.getElementById('StatSuiviGlobal_currentPeriod').textContent = `${day} ${month} ${year}`;
        }
    });
    
    // Événements pour la pagination
    document.querySelectorAll('.StatSuiviGlobal_paginationBtn').forEach(btn => {
        btn.addEventListener('click', function() {
            const pageAction = this.getAttribute('data-page');
            handlePagination(pageAction);
        });
    });
    
    // Recherche de produits dans le tableau
    document.querySelector('.StatSuiviGlobal_searchInput').addEventListener('input', function() {
        filterProductsTable(this.value);
    });
    
    // Boutons d'export de rapports
    document.querySelectorAll('.StatSuiviGlobal_reportButton').forEach(btn => {
        btn.addEventListener('click', function() {
            const reportType = this.closest('.StatSuiviGlobal_reportCard').querySelector('.StatSuiviGlobal_reportTitle').textContent;
            generateReport(reportType);
        });
    });
    
    // Boutons d'action de recommandation
    document.querySelectorAll('.StatSuiviGlobal_recommendationActionBtn').forEach(btn => {
        btn.addEventListener('click', function() {
            const isApply = this.classList.contains('primary');
            const recommendationElement = this.closest('.StatSuiviGlobal_recommendationCard');
            const recommendationType = recommendationElement.querySelector('.StatSuiviGlobal_recommendationTitle').textContent;
            const productName = recommendationElement.querySelector('.StatSuiviGlobal_recommendationProductName').textContent;
            
            if (isApply) {
                applyRecommendation(recommendationType, productName);
            } else {
                showRecommendationDetails(recommendationType, productName);
            }
        });
    });
    
    // Actions rapides dans les recommandations
    document.querySelectorAll('.StatSuiviGlobal_quickActionBtn').forEach(btn => {
        btn.addEventListener('click', function() {
            const actionText = this.textContent.trim();
            handleQuickAction(actionText);
        });
    });
}

// Obtenir l'index du mois à partir de son nom
function getMonthIndex(monthName) {
    const months = {
        'Janvier': 0, 'Février': 1, 'Mars': 2, 'Avril': 3, 'Mai': 4, 'Juin': 5,
        'Juillet': 6, 'Août': 7, 'Septembre': 8, 'Octobre': 9, 'Novembre': 10, 'Décembre': 11
    };
    
    return months[monthName] || 0;
}

// Fonction pour afficher une section
function showSection(sectionId) {
    // Cacher toutes les sections
    document.querySelectorAll('.content-section').forEach(section => {
        section.style.display = 'none';
    });
    
    // Désactiver tous les éléments de menu
    document.querySelectorAll('.nav-item').forEach(item => {
        item.classList.remove('active');
    });
    
    // Afficher la section demandée
    document.getElementById(sectionId).style.display = 'block';
    
    // Activer l'élément de menu correspondant
    document.querySelector(`[data-section="${sectionId}"]`).classList.add('active');
}

// Fonction pour basculer l'affichage des filtres
function toggleFilters() {
    const filtersContainer = document.getElementById('StatSuiviGlobal_filtersContainer');
    
    if (filtersContainer.classList.contains('expanded')) {
        filtersContainer.classList.remove('expanded');
        this.innerHTML = '<i class="fas fa-sliders-h me-1"></i> Options de filtrage';
    } else {
        filtersContainer.classList.add('expanded');
        this.innerHTML = '<i class="fas fa-times me-1"></i> Fermer les filtres';
    }
}

// ===== INITIALISATION DES GRAPHIQUES =====
// Variables globales pour les graphiques
let mainChart, categoryChart, stockChart, forecastChart;

// Fonction d'initialisation des graphiques
function initCharts() {
    // Vérification si ApexCharts est chargé
    if (typeof ApexCharts === 'undefined') {
        loadApexCharts();
        return;
    }
    
    // Graphique principal
    const mainChartOptions = {
        series: [{
            name: 'Ventes',
            data: [30, 40, 35, 50, 49, 60, 70]
        }, {
            name: 'Revenus',
            data: [450, 600, 525, 750, 735, 900, 1050]
        }],
        chart: {
            type: 'bar',
            height: 350,
            toolbar: {
                show: false
            },
            fontFamily: 'inherit'
        },
        plotOptions: {
            bar: {
                horizontal: false,
                columnWidth: '55%',
                borderRadius: 4
            }
        },
        dataLabels: {
            enabled: false
        },
        stroke: {
            show: true,
            width: 2,
            colors: ['transparent']
        },
        xaxis: {
            categories: ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'],
        },
        yaxis: [
            {
                title: {
                    text: 'Ventes (unités)'
                }
            },
            {
                opposite: true,
                title: {
                    text: 'Revenus (€)'
                }
            }
        ],
        fill: {
            opacity: 1
        },
        tooltip: {
            y: {
                formatter: function(val, { seriesIndex }) {
                    return seriesIndex === 0 ? val + " unités" : formatCurrency(val);
                }
            }
        },
        colors: ['#4361ee', '#2dce89']
    };
    
    // Graphique des catégories
    const categoryChartOptions = {
        series: [44, 55, 13, 43, 22],
        chart: {
            type: 'pie',
            height: 350,
            fontFamily: 'inherit'
        },
        labels: ['Antennes & Réception', 'Câbles & Accessoires', 'Adaptateurs & Connecteurs', 'Télécommandes', 'Audio & Vidéo'],
        responsive: [{
            breakpoint: 480,
            options: {
                legend: {
                    position: 'bottom'
                }
            }
        }],
        colors: ['#4361ee', '#2dce89', '#f6c23e', '#e83e8c', '#6f42c1']
    };
    
    // Graphique du stock
    const stockChartOptions = {
        series: [{
            name: 'Stock',
            data: generateRandomStockData()
        }],
        chart: {
            height: 350,
            type: 'treemap',
            fontFamily: 'inherit'
        },
        title: {
            text: 'Distribution du stock par produit',
            align: 'center'
        },
        colors: [
            '#4361ee',
            '#2dce89',
            '#f6c23e',
            '#e83e8c',
            '#6f42c1'
        ],
        plotOptions: {
            treemap: {
                distributed: true,
                enableShades: false
            }
        }
    };
    
    // Graphique des prévisions
    const forecastChartOptions = {
        series: [{
            name: 'Ventes actuelles',
            data: [31, 40, 28, 51, 42, 109, 100]
        }, {
            name: 'Prévisions',
            data: [35, 45, 32, 55, 47, 120, 110]
        }],
        chart: {
            height: 350,
            type: 'area',
            fontFamily: 'inherit',
            toolbar: {
                show: false
            }
        },
        dataLabels: {
            enabled: false
        },
        stroke: {
            curve: 'smooth'
        },
        xaxis: {
            type: 'datetime',
            categories: generateForecastDates()
        },
        tooltip: {
            x: {
                format: 'dd MMM yyyy'
            }
        },
        colors: ['#4361ee', '#2dce89']
    };
    
    // Création des graphiques
    mainChart = new ApexCharts(document.getElementById("StatSuiviGlobal_mainChart"), mainChartOptions);
    categoryChart = new ApexCharts(document.getElementById("StatSuiviGlobal_categoryChart"), categoryChartOptions);
    stockChart = new ApexCharts(document.getElementById("StatSuiviGlobal_stockDistribution"), stockChartOptions);
    forecastChart = new ApexCharts(document.getElementById("StatSuiviGlobal_forecastChart"), forecastChartOptions);
    
    // Rendu des graphiques
    mainChart.render();
    categoryChart.render();
    stockChart.render();
    forecastChart.render();
}

// Fonction pour charger dynamiquement ApexCharts si nécessaire
function loadApexCharts() {
    const script = document.createElement('script');
    script.src = 'https://cdn.jsdelivr.net/npm/apexcharts';
    script.onload = function() {
        initCharts();
    };
    document.head.appendChild(script);
}

// Générer des données de stock aléatoires pour le graphique en mosaïque
function generateRandomStockData() {
    return mockData.products.map(product => {
        return {
            x: product.name,
            y: product.stock
        };
    });
}

// Générer des dates pour le graphique de prévision
function generateForecastDates() {
    const dates = [];
    const today = new Date();
    
    for (let i = 0; i < 7; i++) {
        const date = new Date(today);
        date.setDate(today.getDate() + i);
        dates.push(date.getTime());
    }
    
    return dates;
}

// Mise à jour des graphiques avec les statistiques
function updateCharts(stats, period) {
    // Mise à jour du graphique principal
    updateMainChart(stats, period);
    
    // Mise à jour du graphique des catégories
    updateCategoryChart(stats);
    
    // Mise à jour du graphique de stock
    updateStockChart();
    
    // Mise à jour du graphique de prévision
    updateForecastChart(stats);
}

// Mise à jour du graphique principal
function updateMainChart(stats, period) {
    // Préparer les données en fonction de la période
    const { categories, salesData, revenueData } = prepareMainChartData(stats, period);
    
    mainChart.updateOptions({
        xaxis: {
            categories: categories
        }
    });
    
    mainChart.updateSeries([
        {
            name: 'Ventes',
            data: salesData
        },
        {
            name: 'Revenus',
            data: revenueData
        }
    ]);
}

// Préparer les données pour le graphique principal selon la période
function prepareMainChartData(stats, period) {
    const today = new Date();
    let categories = [];
    let salesData = [];
    let revenueData = [];
    
    // Filtrer les ventes par période
    const filteredSales = filterSalesByPeriod(period);
    
    switch(period) {
        case 'today':
        case 'yesterday':
            // Données par heure
            categories = Array.from({length: 24}, (_, i) => `${i}h`);
            salesData = Array(24).fill(0);
            revenueData = Array(24).fill(0);
            
            filteredSales.forEach(sale => {
                const hour = new Date(sale.date).getHours();
                salesData[hour] += sale.quantity;
                revenueData[hour] += sale.quantity * sale.price;
            });
            break;
            
        case 'this-week':
        case 'last-week':
            // Données par jour de la semaine
            categories = ['Lun', 'Mar', 'Mer', 'Jeu', 'Ven', 'Sam', 'Dim'];
            salesData = Array(7).fill(0);
            revenueData = Array(7).fill(0);
            
            filteredSales.forEach(sale => {
                const day = new Date(sale.date).getDay();
                // Transformer dimanche (0) en index 6, et autres jours en index 0-5
                const dayIndex = day === 0 ? 6 : day - 1;
                salesData[dayIndex] += sale.quantity;
                revenueData[dayIndex] += sale.quantity * sale.price;
            });
            break;
            
        case 'this-month':
        case 'last-month':
            // Données par jour du mois
            const daysInMonth = period === 'this-month' 
                ? new Date(today.getFullYear(), today.getMonth() + 1, 0).getDate()
                : new Date(today.getFullYear(), today.getMonth(), 0).getDate();
            
            categories = Array.from({length: daysInMonth}, (_, i) => (i + 1).toString());
            salesData = Array(daysInMonth).fill(0);
            revenueData = Array(daysInMonth).fill(0);
            
            filteredSales.forEach(sale => {
                const day = new Date(sale.date).getDate();
                salesData[day - 1] += sale.quantity;
                revenueData[day - 1] += sale.quantity * sale.price;
            });
            break;
            
        case 'this-year':
        case 'last-year':
            // Données par mois
            categories = ['Jan', 'Fév', 'Mar', 'Avr', 'Mai', 'Jun', 'Jul', 'Aoû', 'Sep', 'Oct', 'Nov', 'Déc'];
            salesData = Array(12).fill(0);
            revenueData = Array(12).fill(0);
            
            filteredSales.forEach(sale => {
                const month = new Date(sale.date).getMonth();
                salesData[month] += sale.quantity;
                revenueData[month] += sale.quantity * sale.price;
            });
            break;
            
        default:
            // Par défaut, données des 7 derniers jours
            categories = [];
            salesData = [];
            revenueData = [];
            
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(today.getDate() - i);
                categories.push(date.toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit' }));
                salesData.push(0);
                revenueData.push(0);
            }
            
            filteredSales.forEach(sale => {
                const saleDate = new Date(sale.date);
                for (let i = 0; i < 7; i++) {
                    const date = new Date(today);
                    date.setDate(today.getDate() - (6 - i));
                    
                    if (saleDate.toDateString() === date.toDateString()) {
                        salesData[i] += sale.quantity;
                        revenueData[i] += sale.quantity * sale.price;
                        break;
                    }
                }
            });
    }
    
    return { categories, salesData, revenueData };
}

// Mise à jour du type de graphique principal
function updateMainChartType(chartType) {
    let newType = 'bar';
    
    switch(chartType) {
        case 'line':
            newType = 'line';
            break;
        case 'area':
            newType = 'area';
            break;
        default:
            newType = 'bar';
    }
    
    mainChart.updateOptions({
        chart: {
            type: newType
        }
    });
}

// Mise à jour de la période du graphique principal
function updateMainChartPeriod(period) {
    const currentPeriod = document.querySelector('.StatSuiviGlobal_filterItem.active')?.getAttribute('data-period') || 'this-week';
    const stats = calculateSalesStatistics(currentPeriod);
    
    const { categories, salesData, revenueData } = prepareMainChartDataByPeriod(stats, period);
    
    mainChart.updateOptions({
        xaxis: {
            categories: categories
        }
    });
    
    mainChart.updateSeries([
        {
            name: 'Ventes',
            data: salesData
        },
        {
            name: 'Revenus',
            data: revenueData
        }
    ]);
}

// Préparer les données pour le graphique principal selon la granularité (jour, semaine, mois, année)
function prepareMainChartDataByPeriod(stats, chartPeriod) {
    const today = new Date();
    let categories = [];
    let salesData = [];
    let revenueData = [];
    
    // Filtrer les ventes
    const filteredSales = filterSalesByPeriod('this-month'); // Par défaut, on utilise le mois courant
    
    switch(chartPeriod) {
        case 'day':
            // Données des 7 derniers jours
            for (let i = 6; i >= 0; i--) {
                const date = new Date(today);
                date.setDate(today.getDate() - i);
                categories.push(date.toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit' }));
                salesData.push(0);
                revenueData.push(0);
            }
            
            filteredSales.forEach(sale => {
                const saleDate = new Date(sale.date);
                for (let i = 0; i < 7; i++) {
                    const date = new Date(today);
                    date.setDate(today.getDate() - (6 - i));
                    
                    if (saleDate.toDateString() === date.toDateString()) {
                        salesData[i] += sale.quantity;
                        revenueData[i] += sale.quantity * sale.price;
                        break;
                    }
                }
            });
            break;
            
        case 'week':
            // Données des 4 dernières semaines
            for (let i = 3; i >= 0; i--) {
                const weekStart = new Date(today);
                weekStart.setDate(today.getDate() - (today.getDay() + 7 * i));
                const weekEnd = new Date(weekStart);
                weekEnd.setDate(weekStart.getDate() + 6);
                
                const startStr = weekStart.toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit' });
                const endStr = weekEnd.toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit' });
                categories.push(`${startStr} - ${endStr}`);
                salesData.push(0);
                revenueData.push(0);
            }
            
            filteredSales.forEach(sale => {
                const saleDate = new Date(sale.date);
                for (let i = 0; i < 4; i++) {
                    const weekStart = new Date(today);
                    weekStart.setDate(today.getDate() - (today.getDay() + 7 * i));
                    weekStart.setHours(0, 0, 0, 0);
                    
                    const weekEnd = new Date(weekStart);
                    weekEnd.setDate(weekStart.getDate() + 6);
                    weekEnd.setHours(23, 59, 59, 999);
                    
                    if (saleDate >= weekStart && saleDate <= weekEnd) {
                        salesData[3 - i] += sale.quantity;
                        revenueData[3 - i] += sale.quantity * sale.price;
                        break;
                    }
                }
            });
            break;
            
        case 'month':
            // Données des 6 derniers mois
            for (let i = 5; i >= 0; i--) {
                const date = new Date(today);
                date.setMonth(today.getMonth() - i);
                categories.push(date.toLocaleDateString('fr-FR', { month: 'short', year: 'numeric' }));
                salesData.push(0);
                revenueData.push(0);
            }
            
            filteredSales.forEach(sale => {
                const saleDate = new Date(sale.date);
                for (let i = 0; i < 6; i++) {
                    const date = new Date(today);
                    date.setMonth(today.getMonth() - (5 - i));
                    
                    if (saleDate.getMonth() === date.getMonth() && saleDate.getFullYear() === date.getFullYear()) {
                        salesData[i] += sale.quantity;
                        revenueData[i] += sale.quantity * sale.price;
                        break;
                    }
                }
            });
            break;
            
        case 'year':
            // Données des 3 dernières années
            for (let i = 2; i >= 0; i--) {
                const date = new Date(today);
                date.setFullYear(today.getFullYear() - i);
                categories.push(date.getFullYear().toString());
                salesData.push(0);
                revenueData.push(0);
            }
            
            filteredSales.forEach(sale => {
                const saleDate = new Date(sale.date);
                for (let i = 0; i < 3; i++) {
                    const date = new Date(today);
                    date.setFullYear(today.getFullYear() - (2 - i));
                    
                    if (saleDate.getFullYear() === date.getFullYear()) {
                        salesData[i] += sale.quantity;
                        revenueData[i] += sale.quantity * sale.price;
                        break;
                    }
                }
            });
            break;
    }
    
    return { categories, salesData, revenueData };
}

// Mise à jour du graphique des catégories
function updateCategoryChart(stats) {
    // Préparer les données par catégorie
    const categoriesData = mockData.categories.map(category => {
        return {
            name: category.name,
            sales: stats.salesByCategory[category.id] || 0,
            revenue: stats.revenueByCatgory[category.id] || 0
        };
    }).sort((a, b) => b.sales - a.sales);
    
    const labels = categoriesData.map(cat => cat.name);
    const values = categoriesData.map(cat => cat.sales);
    
    categoryChart.updateOptions({
        labels: labels
    });
    
    categoryChart.updateSeries(values);
}

// Mise à jour du graphique de stock
function updateStockChart() {
    // Préparer les données de stock
    const stockData = mockData.products.map(product => {
        const category = mockData.categories.find(c => c.id === product.categoryId);
        return {
            x: product.name,
            y: product.stock
        };
    });
    
    stockChart.updateSeries([{
        data: stockData
    }]);
}

// Mise à jour de la visualisation du stock (bulles ou mosaïque)
function updateStockVisualization(viewType) {
    if (viewType === 'bubble') {
        // Conversion vers un graphique à bulles
        const bubbleData = mockData.products.map(product => {
            return {
                name: product.name,
                data: [{
                    x: product.price,
                    y: calculateProductSales(product.id),
                    z: product.stock
                }]
            };
        });
        
        stockChart.updateOptions({
            chart: {
                type: 'bubble'
            },
            dataLabels: {
                enabled: false
            },
            fill: {
                opacity: 0.8
            },
            title: {
                text: 'Distribution du stock (taille = quantité)'
            },
            xaxis: {
                title: {
                    text: 'Prix (€)'
                }
            },
            yaxis: {
                title: {
                    text: 'Ventes (unités)'
                }
            }
        });
        
        stockChart.updateSeries(bubbleData);
    } else {
        // Conversion vers un graphique en mosaïque
        const treemapData = mockData.products.map(product => {
            return {
                x: product.name,
                y: product.stock
            };
        });
        
        stockChart.updateOptions({
            chart: {
                type: 'treemap'
            },
            title: {
                text: 'Distribution du stock par produit'
            },
            plotOptions: {
                treemap: {
                    distributed: true,
                    enableShades: false
                }
            }
        });
        
        stockChart.updateSeries([{
            data: treemapData
        }]);
    }
}

// Calcul des ventes totales pour un produit
function calculateProductSales(productId) {
    return mockData.sales.filter(sale => sale.productId === productId)
        .reduce((total, sale) => total + sale.quantity, 0);
}

// Mise à jour du graphique de prévision
function updateForecastChart(stats) {
    // Générer des prévisions basées sur les données actuelles
    const { actualData, forecastData, categories } = generateForecastData();
    
    forecastChart.updateOptions({
        xaxis: {
            categories: categories
        }
    });
    
    forecastChart.updateSeries([
        {
            name: 'Ventes actuelles',
            data: actualData
        },
        {
            name: 'Prévisions',
            data: forecastData
        }
    ]);
}

// Générer des données de prévision
function generateForecastData() {
    const today = new Date();
    const categories = [];
    const actualData = [];
    const forecastData = [];
    
    // Données des 4 dernières semaines (réelles)
    for (let i = 4; i >= 1; i--) {
        const date = new Date(today);
        date.setDate(today.getDate() - (i * 7));
        categories.push(date.toISOString().split('T')[0]);
        
        // Ventes réelles pour cette semaine
        const weekSales = mockData.sales.filter(sale => {
            const saleDate = new Date(sale.date);
            const weekStart = new Date(date);
            weekStart.setDate(date.getDate() - 3);
            const weekEnd = new Date(date);
            weekEnd.setDate(date.getDate() + 3);
            return saleDate >= weekStart && saleDate <= weekEnd;
        }).reduce((total, sale) => total + sale.quantity, 0);
        
        actualData.push(weekSales);
        forecastData.push(null); // Pas de prévision pour les données historiques
    }
    
    // Données des 4 prochaines semaines (prévisions)
    for (let i = 1; i <= 4; i++) {
        const date = new Date(today);
        date.setDate(today.getDate() + (i * 7));
        categories.push(date.toISOString().split('T')[0]);
        
        // Prévision basée sur la moyenne et une tendance aléatoire
        const avgSales = actualData.reduce((sum, sales) => sum + sales, 0) / actualData.length;
        const trend = 1 + (Math.random() * 0.3 - 0.1); // Entre -10% et +20%
        const forecastSales = Math.round(avgSales * trend);
        
        actualData.push(null); // Pas de données réelles pour le futur
        forecastData.push(forecastSales);
    }
    
    return { actualData, forecastData, categories };
}

// Mise à jour de la période de prévision
function updateForecastPeriod(period) {
    // Mise à jour du texte sélectionné
    const selectedElement = document.querySelector('.StatSuiviGlobal_forecastPeriodSelect .StatSuiviGlobal_selectedOption span');
    
    switch(period) {
        case 'week':
            selectedElement.textContent = 'Prochaine semaine';
            break;
        case 'month':
            selectedElement.textContent = 'Prochain mois';
            break;
        case 'quarter':
            selectedElement.textContent = 'Prochain trimestre';
            break;
        case 'year':
            selectedElement.textContent = 'Prochaine année';
            break;
    }
    
    // Fermer le menu déroulant
    document.querySelector('.StatSuiviGlobal_forecastPeriodSelect .StatSuiviGlobal_options').style.display = 'none';
    
    // Générer de nouvelles prévisions basées sur la période
    generateForecastsForPeriod(period);
}

// Mise à jour du type de prévision
function updateForecastType(type) {
    // Mise à jour du texte sélectionné
    const selectedElement = document.querySelector('.StatSuiviGlobal_forecastTypeSelect .StatSuiviGlobal_selectedOption span');
    
    switch(type) {
        case 'sales':
            selectedElement.textContent = 'Ventes';
            break;
        case 'revenue':
            selectedElement.textContent = 'Revenus';
            break;
        case 'stock':
            selectedElement.textContent = 'Niveau de stock';
            break;
    }
    
    // Fermer le menu déroulant
    document.querySelector('.StatSuiviGlobal_forecastTypeSelect .StatSuiviGlobal_options').style.display = 'none';
    
    // Générer de nouvelles prévisions basées sur le type
    generateForecastsByType(type);
}

// Générer des prévisions selon la période
function generateForecastsForPeriod(period) {
    // Ici, nous simulons des prévisions différentes selon la période
    const categories = [];
    const actualData = [];
    const forecastData = [];
    
    const today = new Date();
    
    switch(period) {
        case 'week':
            // Prévisions pour la semaine prochaine (7 jours)
            for (let i = 1; i <= 7; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() + i);
                categories.push(date.toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit' }));
                
                const forecastSales = Math.floor(Math.random() * 30) + 20; // Entre 20 et 49 ventes
                forecastData.push(forecastSales);
                actualData.push(null);
            }
            break;
            
        case 'month':
            // Prévisions pour le mois prochain (4 semaines)
            for (let i = 1; i <= 4; i++) {
                const date = new Date(today);
                date.setDate(today.getDate() + (i * 7));
                categories.push('S' + i);
                
                const forecastSales = Math.floor(Math.random() * 100) + 150; // Entre 150 et 249 ventes
                forecastData.push(forecastSales);
                actualData.push(null);
            }
            break;
            
        case 'quarter':
            // Prévisions pour le trimestre prochain (3 mois)
            for (let i = 1; i <= 3; i++) {
                const date = new Date(today);
                date.setMonth(today.getMonth() + i);
                categories.push(date.toLocaleDateString('fr-FR', { month: 'short' }));
                
                const forecastSales = Math.floor(Math.random() * 300) + 500; // Entre 500 et 799 ventes
                forecastData.push(forecastSales);
                actualData.push(null);
            }
            break;
            
        case 'year':
            // Prévisions pour l'année prochaine (12 mois)
            for (let i = 1; i <= 12; i++) {
                const date = new Date(today);
                date.setMonth(today.getMonth() + i);
                categories.push(date.toLocaleDateString('fr-FR', { month: 'short' }));
                
                const forecastSales = Math.floor(Math.random() * 500) + 1000; // Entre 1000 et 1499 ventes
                forecastData.push(forecastSales);
                actualData.push(null);
            }
            break;
    }
    
    forecastChart.updateOptions({
        xaxis: {
            categories: categories
        }
    });
    
    forecastChart.updateSeries([
        {
            name: 'Ventes actuelles',
            data: actualData
        },
        {
            name: 'Prévisions',
            data: forecastData
        }
    ]);
    
    // Mettre à jour la table de prévisions détaillées
    updateForecastTable(period);
}

// Générer des prévisions selon le type (ventes, revenus, stock)
function generateForecastsByType(type) {
    const categories = [];
    const actualData = [];
    const forecastData = [];
    
    const today = new Date();
    
    // Générer des dates pour les 4 prochaines semaines
    for (let i = 1; i <= 4; i++) {
        const date = new Date(today);
        date.setDate(today.getDate() + (i * 7));
        categories.push(date.toLocaleDateString('fr-FR', { day: '2-digit', month: '2-digit' }));
        
        actualData.push(null);
    }
    
    // Générer des prévisions différentes selon le type
    switch(type) {
        case 'sales':
            for (let i = 0; i < 4; i++) {
                forecastData.push(Math.floor(Math.random() * 100) + 150); // Entre 150 et 249 ventes
            }
            
            forecastChart.updateOptions({
                yaxis: {
                    title: {
                        text: 'Nombre de ventes'
                    }
                },
                tooltip: {
                    y: {
                        formatter: function(val) {
                            return val ? val + " unités" : "N/A";
                        }
                    }
                }
            });
            break;
            
        case 'revenue':
            for (let i = 0; i < 4; i++) {
                forecastData.push(Math.floor(Math.random() * 5000) + 10000); // Entre 10000€ et 14999€
            }
            
            forecastChart.updateOptions({
                yaxis: {
                    title: {
                        text: 'Revenus (€)'
                    }
                },
                tooltip: {
                    y: {
                        formatter: function(val) {
                            return val ? formatCurrency(val) : "N/A";
                        }
                    }
                }
            });
            break;
            
        case 'stock':
            for (let i = 0; i < 4; i++) {
                forecastData.push(Math.floor(Math.random() * 200) + 300); // Entre 300 et 499 unités en stock
            }
            
            forecastChart.updateOptions({
                yaxis: {
                    title: {
                        text: 'Niveau de stock'
                    }
                },
                tooltip: {
                    y: {
                        formatter: function(val) {
                            return val ? val + " unités" : "N/A";
                        }
                    }
                }
            });
            break;
    }
    
    forecastChart.updateSeries([
        {
            name: 'Données actuelles',
            data: actualData
        },
        {
            name: 'Prévisions',
            data: forecastData
        }
    ]);
}

// Mise à jour des prévisions
function updateForecasts(stats) {
    // Mettre à jour les métriques de prévision dans le résumé
    const forecastMetrics = document.querySelectorAll('.StatSuiviGlobal_forecastMetricValue');
    
    if (forecastMetrics.length >= 3) {
        // Simuler des prévisions basées sur les données actuelles
        const salesForecast = Math.round(stats.totalSalesCount * 1.18); // 18% de croissance
        const revenueForecast = Math.round(stats.totalRevenue * 1.22); // 22% de croissance
        const stockoutForecast = 8; // Nombre de produits prévus en rupture
        
        forecastMetrics[0].textContent = salesForecast;
        forecastMetrics[1].textContent = formatCurrency(revenueForecast);
        forecastMetrics[2].textContent = stockoutForecast;
    }
    
    // Mettre à jour le tableau de prévisions détaillées
    updateForecastTable();
}

// Mise à jour du tableau de prévisions
function updateForecastTable(period = 'month') {
    const forecastTableBody = document.getElementById('StatSuiviGlobal_forecastTableBody');
    if (!forecastTableBody) return;
    
    forecastTableBody.innerHTML = '';
    
    // Générer des prévisions pour les produits
    mockData.products.slice(0, 10).forEach(product => {
        const currentSales = calculateProductSales(product.id);
        let forecastSales, growth, forecastStock, statusClass, statusText, recommendation;
        
        // Génération de données simulées basées sur la période
        switch(period) {
            case 'week':
                forecastSales = Math.round(currentSales * (1 + (Math.random() * 0.3 - 0.1))); // Entre -10% et +20%
                break;
            case 'month':
                forecastSales = Math.round(currentSales * (1 + (Math.random() * 0.4 - 0.1))); // Entre -10% et +30%
                break;
            case 'quarter':
                forecastSales = Math.round(currentSales * (1 + (Math.random() * 0.5 - 0.15))); // Entre -15% et +35%
                break;
            case 'year':
                forecastSales = Math.round(currentSales * (1 + (Math.random() * 0.8 - 0.2))); // Entre -20% et +60%
                break;
            default:
                forecastSales = Math.round(currentSales * 1.2); // 20% de croissance par défaut
        }
        
        growth = Math.round(((forecastSales - currentSales) / currentSales) * 100);
        forecastStock = Math.max(0, product.stock - forecastSales);
        
        // Détermination du statut et de la recommandation
        if (forecastStock <= 0) {
            statusClass = 'danger';
            statusText = 'Rupture prévue';
            recommendation = `Commander ${forecastSales + 10} unités`;
        } else if (forecastStock < product.threshold) {
            statusClass = 'warning';
            statusText = 'Stock faible prévu';
            recommendation = `Commander ${product.threshold - forecastStock + 5} unités`;
        } else if (forecastStock > product.threshold * 3) {
            statusClass = 'info';
            statusText = 'Surstock prévu';
            recommendation = 'Envisager une promotion';
        } else {
            statusClass = 'success';
            statusText = 'Optimal';
            recommendation = 'Maintenir le niveau actuel';
        }
        
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${product.name}</td>
            <td>${currentSales}</td>
            <td>${forecastSales}</td>
            <td class="${growth >= 0 ? 'positive' : 'negative'}">${growth >= 0 ? '+' : ''}${growth}%</td>
            <td>${product.stock}</td>
            <td>${forecastStock}</td>
            <td><span class="StatSuiviGlobal_statusBadge ${statusClass}">${statusText}</span></td>
            <td>${recommendation}</td>
        `;
        
        forecastTableBody.appendChild(row);
    });
}

// Mise à jour des recommandations
function updateRecommendations(stats) {
    // Les recommandations sont déjà statiques dans le HTML pour cet exemple
    // Dans une version complète, on générerait des recommandations basées sur les données réelles
}

// Mise à jour des alertes de stock
function updateStockAlerts() {
    // Calculer les produits en rupture
    const outOfStockProducts = mockData.products.filter(product => product.stock === 0);
    
    // Calculer les produits à stock faible
    const lowStockProducts = mockData.products.filter(product => product.stock > 0 && product.stock < product.threshold);
    
    // Calculer les produits en surstock
    const overStockProducts = mockData.products.filter(product => product.stock > product.threshold * 3);
    
    // Calculer les produits à stock optimal
    const optimalStockProducts = mockData.products.filter(product => 
        product.stock >= product.threshold && product.stock <= product.threshold * 3);
    
    // Mettre à jour les cartes d'alerte
    const alertCards = document.querySelectorAll('.StatSuiviGlobal_alertValue');
    
    if (alertCards.length >= 4) {
        alertCards[0].textContent = outOfStockProducts.length + ' produits';
        alertCards[1].textContent = lowStockProducts.length + ' produits';
        alertCards[2].textContent = overStockProducts.length + ' produits';
        alertCards[3].textContent = optimalStockProducts.length + ' produits';
    }
    
    // Mettre à jour le tableau d'analyse de stock
    updateStockAnalysisTable('lowStock');
}

// Mise à jour du tableau d'analyse de stock
function updateStockAnalysisTable(analysisType) {
    const stockAnalysisTableBody = document.getElementById('StatSuiviGlobal_stockAnalysisTableBody');
    if (!stockAnalysisTableBody) return;
    
    stockAnalysisTableBody.innerHTML = '';
    
    let productsToShow = [];
    
    switch(analysisType) {
        case 'outOfStock':
            productsToShow = mockData.products.filter(product => product.stock === 0);
            break;
        case 'lowStock':
            productsToShow = mockData.products.filter(product => product.stock > 0 && product.stock < product.threshold);
            break;
        case 'overStock':
            productsToShow = mockData.products.filter(product => product.stock > product.threshold * 3);
            break;
        case 'optimalStock':
            productsToShow = mockData.products.filter(product => 
                product.stock >= product.threshold && product.stock <= product.threshold * 3);
            break;
    }
    
    productsToShow.forEach(product => {
        const category = mockData.categories.find(c => c.id === product.categoryId);
        const categoryName = category ? category.name : 'Non catégorisé';
        
        // Dernier approvisionnement
        const lastSupply = mockData.supplies
            .filter(supply => supply.productId === product.id)
            .sort((a, b) => new Date(b.date) - new Date(a.date))[0];
        
        const lastSupplyDate = lastSupply ? new Date(lastSupply.date).toLocaleDateString('fr-FR') : 'Jamais';
        
        // Ventes récentes (30 derniers jours)
        const today = new Date();
        const thirtyDaysAgo = new Date(today);
        thirtyDaysAgo.setDate(today.getDate() - 30);
        
        const recentSales = mockData.sales
            .filter(sale => sale.productId === product.id && new Date(sale.date) >= thirtyDaysAgo)
            .reduce((total, sale) => total + sale.quantity, 0);
        
        // Statut
        let statusClass, statusText;
        
        if (product.stock === 0) {
            statusClass = 'danger';
            statusText = 'Rupture';
        } else if (product.stock < product.threshold) {
            statusClass = 'warning';
            statusText = 'Stock faible';
        } else if (product.stock > product.threshold * 3) {
            statusClass = 'info';
            statusText = 'Surstock';
        } else {
            statusClass = 'success';
            statusText = 'Optimal';
        }
        
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${product.name}</td>
            <td>${categoryName}</td>
            <td>${product.stock}</td>
            <td>${product.threshold}</td>
            <td>${lastSupplyDate}</td>
            <td>${recentSales} unités</td>
            <td><span class="StatSuiviGlobal_statusBadge ${statusClass}">${statusText}</span></td>
            <td>
                <button class="StatSuiviGlobal_tableActionBtn">
                    <i class="fas fa-shopping-cart"></i>
                </button>
                <button class="StatSuiviGlobal_tableActionBtn">
                    <i class="fas fa-edit"></i>
                </button>
            </td>
        `;
        
        stockAnalysisTableBody.appendChild(row);
    });
    
    // Si aucun produit ne correspond, afficher un message
    if (productsToShow.length === 0) {
        const emptyRow = document.createElement('tr');
        emptyRow.innerHTML = `
            <td colspan="8" class="text-center">
                <div class="StatSuiviGlobal_emptyTableMessage">
                    <i class="fas fa-info-circle me-2"></i>
                    Aucun produit ne correspond à ce critère
                </div>
            </td>
        `;
        stockAnalysisTableBody.appendChild(emptyRow);
    }
}

// Mise à jour du filtre pour les top produits
function updateTopProductsFilter(filterType) {
    const topProductsList = document.getElementById('StatSuiviGlobal_topProductsList');
    topProductsList.innerHTML = '';
    
    // Obtenir les ventes actuelles
    const period = document.querySelector('.StatSuiviGlobal_filterItem.active')?.getAttribute('data-period') || 'this-week';
    const filteredSales = filterSalesByPeriod(period);
    
    // Calculer les statistiques par produit
    const productStats = {};
    
    filteredSales.forEach(sale => {
        if (!productStats[sale.productId]) {
            productStats[sale.productId] = {
                sales: 0,
                revenue: 0,
                profit: 0
            };
        }
        
        productStats[sale.productId].sales += sale.quantity;
        productStats[sale.productId].revenue += sale.quantity * sale.price;
        productStats[sale.productId].profit += sale.quantity * sale.price * 0.4; // 40% de marge
    });
    
    // Convertir en tableau pour le tri
    const statsArray = Object.entries(productStats).map(([productId, stats]) => {
        return {
            product: mockData.products.find(p => p.id == productId),
            ...stats
        };
    });
    
    // Trier selon le filtre
    switch(filterType) {
        case 'sales':
            statsArray.sort((a, b) => b.sales - a.sales);
            break;
        case 'revenue':
            statsArray.sort((a, b) => b.revenue - a.revenue);
            break;
        case 'profit':
            statsArray.sort((a, b) => b.profit - a.profit);
            break;
    }
    
    // Afficher les 5 meilleurs produits
    const topProducts = statsArray.slice(0, 5);
    
    topProducts.forEach((item, index) => {
        const product = item.product;
        if (!product) return;
        
        const category = mockData.categories.find(c => c.id === product.categoryId);
        const categoryName = category ? category.name : 'Non catégorisé';
        
        const productElement = document.createElement('div');
        productElement.className = 'StatSuiviGlobal_productItem';
        
        const rank = index + 1;
        const rankClass = rank <= 3 ? `top-${rank}` : '';
        
        // Obtenir la valeur à afficher selon le filtre
        let statValue, statLabel;
        
        switch(filterType) {
            case 'sales':
                statValue = item.sales;
                statLabel = 'ventes';
                break;
            case 'revenue':
                statValue = formatCurrency(item.revenue);
                statLabel = 'revenus';
                break;
            case 'profit':
                statValue = formatCurrency(item.profit);
                statLabel = 'marge';
                break;
        }
        
        productElement.innerHTML = `
            <div class="StatSuiviGlobal_productRank ${rankClass}">${rank}</div>
            <div class="StatSuiviGlobal_productDetails">
                <div class="StatSuiviGlobal_productName">${product.name}</div>
                <div class="StatSuiviGlobal_productCategory">${categoryName}</div>
            </div>
            <div class="StatSuiviGlobal_productStats">
                <div class="StatSuiviGlobal_productStat">
                    <span>${statValue}</span>
                    <small>${statLabel}</small>
                </div>
            </div>
        `;
        
        topProductsList.appendChild(productElement);
    });
    
    // Si moins de 5 produits vendus, afficher un message
    if (topProducts.length === 0) {
        const emptyElement = document.createElement('div');
        emptyElement.className = 'StatSuiviGlobal_emptyProductsList';
        emptyElement.innerHTML = `
            <i class="fas fa-info-circle"></i>
            <span>Aucune vente pour cette période</span>
        `;
        topProductsList.appendChild(emptyElement);
    }
}

// ===== GÉNÉRATION DES TABLEAUX =====
// Génération des tableaux de données
function generateTables() {
    // Générer le tableau de performance
    generatePerformanceTable();
    
    // Générer le tableau d'analyse de stock
    updateStockAnalysisTable('lowStock');
    
    // Générer le tableau de prévisions
    updateForecastTable();
    
    // Générer la liste des top produits
    generateTopProductsList();
}

// Générer le tableau de performance
function generatePerformanceTable() {
    const tableBody = document.getElementById('StatSuiviGlobal_performanceTableBody');
    if (!tableBody) return;
    
    tableBody.innerHTML = '';
    
    // Obtenir les statistiques actuelles
    const period = document.querySelector('.StatSuiviGlobal_filterItem.active')?.getAttribute('data-period') || 'this-week';
    const filteredSales = filterSalesByPeriod(period);
    
    // Calculer les ventes par produit
    const productSales = {};
    const productRevenues = {};
    
    filteredSales.forEach(sale => {
        if (!productSales[sale.productId]) {
            productSales[sale.productId] = 0;
            productRevenues[sale.productId] = 0;
        }
        
        productSales[sale.productId] += sale.quantity;
        productRevenues[sale.productId] += sale.quantity * sale.price;
    });
    
    // Générer les lignes du tableau
    mockData.products.forEach(product => {
        const category = mockData.categories.find(c => c.id === product.categoryId);
        const categoryName = category ? category.name : 'Non catégorisé';
        
        const sales = productSales[product.id] || 0;
        const revenue = productRevenues[product.id] || 0;
        
        // Calculer la performance (ratio ventes/stock en %)
        let performance;
        if (product.stock > 0) {
            performance = Math.round((sales / product.stock) * 100);
        } else if (sales > 0) {
            performance = 100; // Si stock épuisé mais ventes positives
        } else {
            performance = 0; // Ni stock ni ventes
        }
        
        // Indicateur de performance
        let performanceClass, performanceIcon;
        
        if (performance >= 80) {
            performanceClass = 'excellent';
            performanceIcon = 'fas fa-star';
        } else if (performance >= 50) {
            performanceClass = 'good';
            performanceIcon = 'fas fa-thumbs-up';
        } else if (performance >= 20) {
            performanceClass = 'average';
            performanceIcon = 'fas fa-minus';
        } else {
            performanceClass = 'poor';
            performanceIcon = 'fas fa-thumbs-down';
        }
        
        const row = document.createElement('tr');
        row.innerHTML = `
            <td>${product.name}</td>
            <td>${categoryName}</td>
            <td>${formatCurrency(product.price)}</td>
            <td>${sales}</td>
            <td>${formatCurrency(revenue)}</td>
            <td>${product.stock} unités</td>
            <td>
                <div class="StatSuiviGlobal_performanceIndicator ${performanceClass}">
                    <i class="${performanceIcon}"></i>
                    <span>${performance}%</span>
                </div>
            </td>
        `;
        
        tableBody.appendChild(row);
    });
}

// Générer la liste des meilleurs produits
function generateTopProductsList() {
    const topProductsContainer = document.querySelector('.StatSuiviGlobal_topProducts');
    if (!topProductsContainer) return;
    
    topProductsContainer.innerHTML = '';
    
    // Obtenir les statistiques actuelles
    const period = document.querySelector('.StatSuiviGlobal_filterItem.active')?.getAttribute('data-period') || 'this-week';
    const filteredSales = filterSalesByPeriod(period);
    
    // Calculer les ventes et revenus par produit
    const productSales = {};
    const productRevenues = {};
    
    filteredSales.forEach(sale => {
        if (!productSales[sale.productId]) {
            productSales[sale.productId] = 0;
            productRevenues[sale.productId] = 0;
        }
        
        productSales[sale.productId] += sale.quantity;
        productRevenues[sale.productId] += sale.quantity * sale.price;
    });
    
    // Convertir en tableau pour le tri
    const productsStats = Object.entries(productSales).map(([productId, sales]) => {
        return {
            product: mockData.products.find(p => p.id == productId),
            sales,
            revenue: productRevenues[productId] || 0
        };
    }).sort((a, b) => b.sales - a.sales);
    
    // Afficher les produits 2 à 10 (le top 1 est affiché séparément)
    const topProducts = productsStats.slice(1, 10);
    
    for (let i = 0; i < topProducts.length; i++) {
        const item = topProducts[i];
        const product = item.product;
        if (!product) continue;
        
        const category = mockData.categories.find(c => c.id === product.categoryId);
        const categoryName = category ? category.name : 'Non catégorisé';
        
        const productElement = document.createElement('div');
        productElement.className = 'StatSuiviGlobal_topProductItem';
        
        productElement.innerHTML = `
            <div class="StatSuiviGlobal_topProductRank">${i + 2}</div>
            <div class="StatSuiviGlobal_topProductInfo">
                <div class="StatSuiviGlobal_topProductName">${product.name}</div>
                <div class="StatSuiviGlobal_topProductCategory">${categoryName}</div>
            </div>
            <div class="StatSuiviGlobal_topProductStats">
                <div class="StatSuiviGlobal_topProductStat">
                    <span>${item.sales}</span>
                    <small>ventes</small>
                </div>
                <div class="StatSuiviGlobal_topProductStat">
                    <span>${formatCurrency(item.revenue)}</span>
                    <small>revenus</small>
                </div>
            </div>
        `;
        
        topProductsContainer.appendChild(productElement);
    }
}

// ===== GESTION DES FILTRES PERSONNALISÉS =====
// Initialisation des sélecteurs personnalisés
function initCustomSelects() {
    document.querySelectorAll('.StatSuiviGlobal_customSelect').forEach(select => {
        const options = select.querySelector('.StatSuiviGlobal_options');
        
        options.querySelectorAll('.StatSuiviGlobal_option').forEach(option => {
            option.addEventListener('click', function() {
                // Mettre à jour le texte sélectionné
                const selectedText = this.textContent;
                const selectedOptionElement = select.querySelector('.StatSuiviGlobal_selectedOption span');
                selectedOptionElement.textContent = selectedText;
                
                // Fermer le menu déroulant
                options.style.display = 'none';
                
                // Si c'est un sélecteur pour le tri, réorganiser le tableau
                if (this.hasAttribute('data-sort')) {
                    const sortField = this.getAttribute('data-sort');
                    const sortOrder = this.getAttribute('data-order');
                    sortTable(sortField, sortOrder);
                }
                
                // Si c'est le sélecteur de mois, mettre à jour les jours disponibles
                if (select.id === 'StatSuiviGlobal_monthSelect') {
                    populateDayOptions();
                }
                
                // Si c'est le sélecteur de top X performances
                if (this.hasAttribute('data-top')) {
                    const topCount = parseInt(this.getAttribute('data-top'));
                    updateTopPerformanceCount(topCount);
                }
            });
        });
    });
    
    // Fermer les menus déroulants quand on clique ailleurs
    document.addEventListener('click', function(event) {
        if (!event.target.closest('.StatSuiviGlobal_customSelect')) {
            document.querySelectorAll('.StatSuiviGlobal_options').forEach(options => {
                options.style.display = 'none';
            });
        }
    });
}

// Populer les options de jour en fonction du mois et de l'année sélectionnés
function populateDayOptions() {
    const yearSelect = document.querySelector('#StatSuiviGlobal_yearSelect .StatSuiviGlobal_selectedOption span');
    const monthSelect = document.querySelector('#StatSuiviGlobal_monthSelect .StatSuiviGlobal_selectedOption span');
    const dayOptions = document.getElementById('StatSuiviGlobal_dayOptions');
    
    if (!yearSelect || !monthSelect || !dayOptions) return;
    
    const year = parseInt(yearSelect.textContent);
    const monthName = monthSelect.textContent;
    
    // Si "Tous" est sélectionné, conserver uniquement l'option "Tous"
    if (monthName === 'Tous') {
        dayOptions.innerHTML = '<div class="StatSuiviGlobal_option" data-value="all">Tous</div>';
        return;
    }
    
    // Obtenir l'index du mois
    const monthIndex = getMonthIndex(monthName);
    
    // Calculer le nombre de jours dans le mois
    const daysInMonth = new Date(year, monthIndex + 1, 0).getDate();
    
    // Générer les options de jour
    dayOptions.innerHTML = '<div class="StatSuiviGlobal_option" data-value="all">Tous</div>';
    
    for (let i = 1; i <= daysInMonth; i++) {
        const option = document.createElement('div');
        option.className = 'StatSuiviGlobal_option';
        option.setAttribute('data-value', i);
        option.textContent = i;
        
        dayOptions.appendChild(option);
    }
    
    // Ajouter les événements de clic pour les nouvelles options
    dayOptions.querySelectorAll('.StatSuiviGlobal_option').forEach(option => {
        option.addEventListener('click', function() {
            const selectedOptionElement = document.querySelector('#StatSuiviGlobal_daySelect .StatSuiviGlobal_selectedOption span');
            selectedOptionElement.textContent = this.textContent;
            dayOptions.style.display = 'none';
        });
    });
}

// Tri du tableau selon un champ et un ordre
function sortTable(field, order) {
    const tableBody = document.getElementById('StatSuiviGlobal_performanceTableBody');
    if (!tableBody) return;
    
    const rows = Array.from(tableBody.querySelectorAll('tr'));
    
    // Déterminer l'index de la colonne à trier
    let columnIndex = 0;
    switch(field) {
        case 'sales':
            columnIndex = 3;
            break;
        case 'revenue':
            columnIndex = 4;
            break;
        case 'profit':
            columnIndex = 6; // Colonne de performance
            break;
        case 'stock':
            columnIndex = 5;
            break;
        default:
            columnIndex = 0;
    }
    
    // Trier les lignes
    rows.sort((a, b) => {
        let aValue, bValue;
        
        if (field === 'profit') {
            // Extraction du pourcentage de performance
            aValue = parseInt(a.cells[columnIndex].querySelector('span').textContent);
            bValue = parseInt(b.cells[columnIndex].querySelector('span').textContent);
        } else if (field === 'sales' || field === 'stock') {
            // Conversion en nombre
            aValue = parseInt(a.cells[columnIndex].textContent);
            bValue = parseInt(b.cells[columnIndex].textContent);
        } else if (field === 'revenue') {
            // Extraction du nombre à partir du format monétaire
            aValue = parseFloat(a.cells[columnIndex].textContent.replace(/[^\d,.-]/g, '').replace(',', '.'));
            bValue = parseFloat(b.cells[columnIndex].textContent.replace(/[^\d,.-]/g, '').replace(',', '.'));
        } else {
            // Tri alphabétique
            aValue = a.cells[columnIndex].textContent.toLowerCase();
            bValue = b.cells[columnIndex].textContent.toLowerCase();
        }
        
        // Tri selon l'ordre
        if (order === 'asc') {
            return aValue > bValue ? 1 : -1;
        } else {
            return aValue < bValue ? 1 : -1;
        }
    });
    
    // Réorganiser les lignes dans le tableau
    tableBody.innerHTML = '';
    rows.forEach(row => {
        tableBody.appendChild(row);
    });
}

// Filtrer le tableau de produits en fonction de la recherche
function filterProductsTable(searchTerm) {
    const tableBody = document.getElementById('StatSuiviGlobal_performanceTableBody');
    if (!tableBody) return;
    
    const rows = tableBody.querySelectorAll('tr');
    const term = searchTerm.toLowerCase();
    
    rows.forEach(row => {
        const productName = row.cells[0].textContent.toLowerCase();
        const categoryName = row.cells[1].textContent.toLowerCase();
        
        if (productName.includes(term) || categoryName.includes(term)) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
}

// Mettre à jour le nombre de produits affichés dans le top performances
function updateTopPerformanceCount(count) {
    // Dans cet exemple, on se contente de mettre à jour le texte
    // Dans une version complète, on chargerait plus de produits
    
    // Mettre à jour les données de top performances pour chaque période
    document.querySelectorAll('.StatSuiviGlobal_topPerformanceList').forEach(list => {
        // Simuler le chargement de plus de produits
        const activeTab = document.querySelector('.StatSuiviGlobal_topPerformanceTab.active').getAttribute('data-tab');
        if (list.getAttribute('data-content') === activeTab) {
            list.querySelector('.StatSuiviGlobal_bestProductBadge').innerHTML = `<i class="fas fa-trophy"></i> Meilleur produit sur ${count}`;
        }
    });
}

// ===== GESTION DE LA PAGINATION =====
let currentPage = 1;
const itemsPerPage = 10;

// Gestion de la pagination
function handlePagination(action) {
    const tableBody = document.getElementById('StatSuiviGlobal_performanceTableBody');
    if (!tableBody) return;
    
    const rows = tableBody.querySelectorAll('tr');
    const visibleRows = Array.from(rows).filter(row => row.style.display !== 'none');
    
    const totalPages = Math.ceil(visibleRows.length / itemsPerPage);
    
    switch(action) {
        case 'first':
            currentPage = 1;
            break;
        case 'prev':
            currentPage = Math.max(1, currentPage - 1);
            break;
        case 'next':
            currentPage = Math.min(totalPages, currentPage + 1);
            break;
        case 'last':
            currentPage = totalPages;
            break;
    }
    
    // Mettre à jour l'affichage des pages
    document.getElementById('StatSuiviGlobal_currentPage').textContent = currentPage;
    document.getElementById('StatSuiviGlobal_totalPages').textContent = totalPages;
    
    // Mettre à jour la visibilité des lignes
    visibleRows.forEach((row, index) => {
        const startIndex = (currentPage - 1) * itemsPerPage;
        const endIndex = startIndex + itemsPerPage - 1;
        
        if (index >= startIndex && index <= endIndex) {
            row.style.display = '';
        } else {
            row.style.display = 'none';
        }
    });
}

// ===== FONCTIONS UTILITAIRES =====
// Formatage des valeurs monétaires
function formatCurrency(value) {
    return new Intl.NumberFormat('fr-FR', {
        style: 'currency',
        currency: 'EUR',
        minimumFractionDigits: 2
    }).format(value);
}

// Génération de rapports
function generateReport(reportType) {
    alert(`Génération du rapport : ${reportType}`);
    // Dans une version complète, cette fonction générerait un PDF ou Excel
}

// Application d'une recommandation
function applyRecommendation(recommendationType, productName) {
    alert(`Application de la recommandation "${recommendationType}" pour le produit "${productName}"`);
    // Dans une version complète, cette fonction appliquerait la recommandation
}

// Affichage des détails d'une recommandation
function showRecommendationDetails(recommendationType, productName) {
    alert(`Détails de la recommandation "${recommendationType}" pour le produit "${productName}"`);
    // Dans une version complète, cette fonction afficherait une modal avec les détails
}

// Gestion des actions rapides
function handleQuickAction(action) {
    alert(`Action rapide : ${action}`);
    // Dans une version complète, cette fonction exécuterait l'action correspondante
}

// Mise à jour de l'analyse de stock
function updateStockAnalysis(analysisType) {
    updateStockAnalysisTable(analysisType);
}

</script>


<script>
  // ========== CODE JAVASCRIPT COMPLET POUR "SUIVI GLOBAL & STATISTIQUES" ==========

// Initialisation des bibliothèques et dépendances
document.addEventListener('DOMContentLoaded', function() {
    // Vérifier si ApexCharts est disponible, sinon le charger
    if (typeof ApexCharts === 'undefined') {
        const script = document.createElement('script');
        script.src = 'https://cdn.jsdelivr.net/npm/apexcharts@3.35.0/dist/apexcharts.min.js';
        script.onload = initStatSuiviGlobal;
        document.head.appendChild(script);
        
        // Charger le CSS d'ApexCharts
        const link = document.createElement('link');
        link.rel = 'stylesheet';
        link.href = 'https://cdn.jsdelivr.net/npm/apexcharts@3.35.0/dist/apexcharts.min.css';
        document.head.appendChild(link);
    } else {
        initStatSuiviGlobal();
    }
});

// Fonction d'initialisation principale
function initStatSuiviGlobal() {
    // Initialisation des données
    const StatSuiviGlobal_data = {
        // Configuration globale
        config: {
            currentPeriod: 'this-week',
            currentPage: 1,
            itemsPerPage: 10,
            topCount: 10,
            chartType: 'bar',
            chartPeriod: 'day',
            stockView: 'bubble',
            analysisType: 'lowStock',
            forecastPeriod: 'month',
            forecastType: 'sales',
            performanceSort: { field: 'sales', order: 'desc' },
            categorySelected: 'all',
            topPerformanceTab: 'day',
            customDateRange: {
                start: null,
                end: null
            },
            preciseDate: {
                year: new Date().getFullYear(),
                month: 'all',
                day: 'all'
            }
        },
        
        // Périodes disponibles et leurs libellés
        periods: {
            'today': 'Aujourd\'hui',
            'yesterday': 'Hier',
            'this-week': 'Cette semaine',
            'last-week': 'Semaine dernière',
            'this-month': 'Ce mois-ci',
            'last-month': 'Mois dernier',
            'this-year': 'Cette année',
            'last-year': 'Année dernière',
            'all-time': 'Tout l\'historique',
            'custom': 'Période personnalisée'
        },
        
        // Données pour les graphiques, tables et analyses
        charts: {},
        tables: {},
        
        // Cache pour éviter de recalculer les données
        cache: {},
        
        // Méthodes de manipulation des données
        generateSalesData: function(period) {
            // Si les données sont en cache pour cette période, les renvoyer
            if (this.cache[`sales_${period}`]) {
                return this.cache[`sales_${period}`];
            }
            
            const data = [];
            const today = new Date();
            let startDate, endDate, interval, format;
            
            // Définir la plage de dates et l'intervalle selon la période
            switch(period) {
                case 'today':
                    startDate = new Date(today.getFullYear(), today.getMonth(), today.getDate());
                    endDate = new Date(today.getFullYear(), today.getMonth(), today.getDate(), 23, 59, 59);
                    interval = 'hour';
                    format = 'HH:mm';
                    break;
                case 'yesterday':
                    startDate = new Date(today.getFullYear(), today.getMonth(), today.getDate() - 1);
                    endDate = new Date(today.getFullYear(), today.getMonth(), today.getDate() - 1, 23, 59, 59);
                    interval = 'hour';
                    format = 'HH:mm';
                    break;
                case 'this-week':
                    const firstDayOfWeek = today.getDate() - today.getDay() + (today.getDay() === 0 ? -6 : 1);
                    startDate = new Date(today.getFullYear(), today.getMonth(), firstDayOfWeek);
                    endDate = new Date(today.getFullYear(), today.getMonth(), firstDayOfWeek + 6, 23, 59, 59);
                    interval = 'day';
                    format = 'dd/MM';
                    break;
                case 'last-week':
                    const firstDayLastWeek = today.getDate() - today.getDay() - 6 + (today.getDay() === 0 ? -6 : 1);
                    startDate = new Date(today.getFullYear(), today.getMonth(), firstDayLastWeek);
                    endDate = new Date(today.getFullYear(), today.getMonth(), firstDayLastWeek + 6, 23, 59, 59);
                    interval = 'day';
                    format = 'dd/MM';
                    break;
                case 'this-month':
                    startDate = new Date(today.getFullYear(), today.getMonth(), 1);
                    endDate = new Date(today.getFullYear(), today.getMonth() + 1, 0, 23, 59, 59);
                    interval = 'day';
                    format = 'dd/MM';
                    break;
                case 'last-month':
                    startDate = new Date(today.getFullYear(), today.getMonth() - 1, 1);
                    endDate = new Date(today.getFullYear(), today.getMonth(), 0, 23, 59, 59);
                    interval = 'day';
                    format = 'dd/MM';
                    break;
                case 'this-year':
                    startDate = new Date(today.getFullYear(), 0, 1);
                    endDate = new Date(today.getFullYear(), 11, 31, 23, 59, 59);
                    interval = 'month';
                    format = 'MMM';
                    break;
                case 'last-year':
                    startDate = new Date(today.getFullYear() - 1, 0, 1);
                    endDate = new Date(today.getFullYear() - 1, 11, 31, 23, 59, 59);
                    interval = 'month';
                    format = 'MMM';
                    break;
                case 'all-time':
                    startDate = new Date(today.getFullYear() - 3, 0, 1);
                    endDate = new Date(today.getFullYear(), today.getMonth(), today.getDate(), 23, 59, 59);
                    interval = 'year';
                    format = 'yyyy';
                    break;
                case 'custom':
                    if (this.config.customDateRange.start && this.config.customDateRange.end) {
                        startDate = new Date(this.config.customDateRange.start);
                        endDate = new Date(this.config.customDateRange.end);
                        
                        // Déterminer l'intervalle approprié en fonction de la durée
                        const diffTime = Math.abs(endDate - startDate);
                        const diffDays = Math.ceil(diffTime / (1000 * 60 * 60 * 24));
                        
                        if (diffDays <= 1) {
                            interval = 'hour';
                            format = 'HH:mm';
                        } else if (diffDays <= 60) {
                            interval = 'day';
                            format = 'dd/MM';
                        } else if (diffDays <= 730) {
                            interval = 'month';
                            format = 'MMM yyyy';
                        } else {
                            interval = 'year';
                            format = 'yyyy';
                        }
                    } else {
                        // Par défaut si pas de dates définies
                        startDate = new Date(today.getFullYear(), today.getMonth(), 1);
                        endDate = new Date(today.getFullYear(), today.getMonth() + 1, 0, 23, 59, 59);
                        interval = 'day';
                        format = 'dd/MM';
                    }
                    break;
                default:
                    startDate = new Date(today.getFullYear(), today.getMonth(), 1);
                    endDate = new Date(today.getFullYear(), today.getMonth() + 1, 0, 23, 59, 59);
                    interval = 'day';
                    format = 'dd/MM';
            }
            
            // Générer les dates dans l'intervalle
            const dates = [];
            const current = new Date(startDate);
            
            while (current <= endDate) {
                dates.push(new Date(current));
                
                switch(interval) {
                    case 'hour':
                        current.setHours(current.getHours() + 1);
                        break;
                    case 'day':
                        current.setDate(current.getDate() + 1);
                        break;
                    case 'month':
                        current.setMonth(current.getMonth() + 1);
                        break;
                    case 'year':
                        current.setFullYear(current.getFullYear() + 1);
                        break;
                }
            }
            
            // Formatter les dates et générer des données pour chaque point
            dates.forEach(date => {
                const formattedDate = this.formatDate(date, format);
                
                // Simuler des ventes avec une distribution réaliste
                // Plus élevées pendant les jours ouvrables et heures de bureau
                let salesFactor = 1;
                
                if (interval === 'hour') {
                    // Les ventes sont plus élevées entre 10h et 19h
                    const hour = date.getHours();
                    if (hour >= 10 && hour < 19) {
                        salesFactor = 1.5 + Math.random() * 0.5;
                    } else if (hour >= 8 && hour < 10 || hour >= 19 && hour < 21) {
                        salesFactor = 1 + Math.random() * 0.3;
                    } else {
                        salesFactor = 0.3 + Math.random() * 0.4;
                    }
                } else if (interval === 'day') {
                    // Les ventes sont plus faibles le week-end
                    const day = date.getDay();
                    if (day === 0 || day === 6) { // Dimanche ou Samedi
                        salesFactor = 0.6 + Math.random() * 0.4;
                    } else {
                        salesFactor = 1 + Math.random() * 0.5;
                    }
                }
                
                // Générer des valeurs de ventes avec du bruit aléatoire
                const baseValue = 20 + Math.random() * 30;
                const sales = Math.floor(baseValue * salesFactor);
                const revenue = sales * (12 + Math.random() * 8);
                
                data.push({
                    date: date,
                    formattedDate: formattedDate,
                    sales: sales,
                    revenue: revenue.toFixed(2)
                });
            });
            
            // Mettre en cache
            this.cache[`sales_${period}`] = data;
            
            return data;
        },
        
        getProductsData: function() {
            if (this.cache.products) {
                return this.cache.products;
            }
            
            // Simuler des données produits
            const categories = [
                'Antennes & Réception',
                'Câbles & Accessoires',
                'Adaptateurs & Connecteurs',
                'Multimédia',
                'Télécommandes',
                'Audio & Vidéo',
                'Informatique',
                'Smartphones & Tablettes'
            ];
            
            const products = [
                { id: 1, name: 'Antenne TV Extérieure', category: 'Antennes & Réception', price: 49.99, stock: 35, reorderLevel: 10, lastRestock: '2025-04-12' },
                { id: 2, name: 'Antenne TV Intérieure', category: 'Antennes & Réception', price: 24.99, stock: 22, reorderLevel: 8, lastRestock: '2025-04-18' },
                { id: 3, name: 'Antenne TNT HD', category: 'Antennes & Réception', price: 29.99, stock: 8, reorderLevel: 10, lastRestock: '2025-03-25' },
                { id: 4, name: 'Câble HDMI Premium 2m', category: 'Câbles & Accessoires', price: 14.99, stock: 5, reorderLevel: 15, lastRestock: '2025-04-30' },
                { id: 5, name: 'Câble HDMI 4K 3m', category: 'Câbles & Accessoires', price: 19.99, stock: 0, reorderLevel: 10, lastRestock: '2025-03-10' },
                { id: 6, name: 'Câble Ethernet Cat6 5m', category: 'Câbles & Accessoires', price: 9.99, stock: 47, reorderLevel: 10, lastRestock: '2025-04-22' },
                { id: 7, name: 'Adaptateur HDMI vers VGA', category: 'Adaptateurs & Connecteurs', price: 19.99, stock: 124, reorderLevel: 15, lastRestock: '2025-02-05' },
                { id: 8, name: 'Adaptateur USB-C vers HDMI', category: 'Adaptateurs & Connecteurs', price: 24.99, stock: 18, reorderLevel: 10, lastRestock: '2025-04-15' },
                { id: 9, name: 'Adaptateur Jack 3.5mm vers RCA', category: 'Adaptateurs & Connecteurs', price: 7.99, stock: 36, reorderLevel: 12, lastRestock: '2025-04-01' },
                { id: 10, name: 'Télécommande Universelle', category: 'Télécommandes', price: 15.99, stock: 145, reorderLevel: 20, lastRestock: '2025-01-12' },
                { id: 11, name: 'Télécommande Smart TV Samsung', category: 'Télécommandes', price: 29.99, stock: 23, reorderLevel: 10, lastRestock: '2025-04-10' },
                { id: 12, name: 'Télécommande Apple TV', category: 'Télécommandes', price: 39.99, stock: 12, reorderLevel: 8, lastRestock: '2025-04-05' },
                { id: 13, name: 'Lecteur Multimédia', category: 'Multimédia', price: 59.99, stock: 9, reorderLevel: 5, lastRestock: '2025-04-20' },
                { id: 14, name: 'Google Chromecast', category: 'Multimédia', price: 39.99, stock: 17, reorderLevel: 10, lastRestock: '2025-04-18' },
                { id: 15, name: 'Amplificateur de Signal WiFi', category: 'Informatique', price: 29.99, stock: 28, reorderLevel: 15, lastRestock: '2025-04-15' },
                { id: 16, name: 'Routeur WiFi 6', category: 'Informatique', price: 89.99, stock: 7, reorderLevel: 5, lastRestock: '2025-04-22' },
                { id: 17, name: 'Casque Bluetooth', category: 'Audio & Vidéo', price: 49.99, stock: 0, reorderLevel: 10, lastRestock: '2025-03-01' },
                { id: 18, name: 'Enceinte Bluetooth Portable', category: 'Audio & Vidéo', price: 39.99, stock: 13, reorderLevel: 8, lastRestock: '2025-04-10' },
                { id: 19, name: 'Chargeur Sans Fil 15W', category: 'Smartphones & Tablettes', price: 24.99, stock: 32, reorderLevel: 15, lastRestock: '2025-04-05' },
                { id: 20, name: 'Support Smartphone Voiture', category: 'Smartphones & Tablettes', price: 12.99, stock: 41, reorderLevel: 20, lastRestock: '2025-04-01' }
            ];
            
            // Ajouter des données de ventes simulées pour chaque produit
            products.forEach(product => {
                // Simuler différents niveaux de popularité (ventes)
                const popularityFactor = Math.random();
                let salesFactor = 0.5;
                
                if (popularityFactor > 0.9) {
                    salesFactor = 3 + Math.random() * 2; // Produit très populaire
                } else if (popularityFactor > 0.7) {
                    salesFactor = 1.5 + Math.random(); // Produit populaire
                } else if (popularityFactor > 0.4) {
                    salesFactor = 0.8 + Math.random() * 0.7; // Popularité moyenne
                } else {
                    salesFactor = 0.1 + Math.random() * 0.4; // Peu populaire
                }
                
                // Attribuer des ventes en fonction de la popularité
                const baseSales = Math.floor(10 + Math.random() * 20);
                
                product.sales = {
                    day: Math.max(0, Math.floor(baseSales * salesFactor * 0.1)),
                    week: Math.max(1, Math.floor(baseSales * salesFactor * 0.7)),
                    month: Math.max(4, Math.floor(baseSales * salesFactor * 3)),
                    year: Math.max(48, Math.floor(baseSales * salesFactor * 36))
                };
                
                // Calculer les revenus
                product.revenue = {
                    day: product.sales.day * product.price,
                    week: product.sales.week * product.price,
                    month: product.sales.month * product.price,
                    year: product.sales.year * product.price
                };
                
                // Calculer la marge (40% en moyenne avec variation)
                const marginPercent = 30 + Math.random() * 20;
                product.margin = {
                    percent: marginPercent,
                    day: (product.revenue.day * marginPercent / 100).toFixed(2),
                    week: (product.revenue.week * marginPercent / 100).toFixed(2),
                    month: (product.revenue.month * marginPercent / 100).toFixed(2),
                    year: (product.revenue.year * marginPercent / 100).toFixed(2)
                };
                
                // Définir le statut de stock
                if (product.stock === 0) {
                    product.stockStatus = 'outOfStock';
                } else if (product.stock <= product.reorderLevel) {
                    product.stockStatus = 'lowStock';
                } else if (product.stock >= product.reorderLevel * 5) {
                    product.stockStatus = 'overStock';
                } else {
                    product.stockStatus = 'optimalStock';
                }
                
                // Simuler les ventes récentes (derniers 30 jours)
                product.recentSales = Math.floor(product.sales.month * (0.7 + Math.random() * 0.6));
                
                // Simuler des prévisions
                const growthFactor = 0.8 + Math.random() * 0.4; // Facteur de croissance entre 0.8 et 1.2
                product.forecast = {
                    week: Math.floor(product.sales.week * growthFactor),
                    month: Math.floor(product.sales.month * growthFactor),
                    quarter: Math.floor(product.sales.month * 3 * growthFactor),
                    year: Math.floor(product.sales.year * growthFactor)
                };
                
                // Prévision de stock basée sur les ventes prévues
                product.stockForecast = {
                    week: Math.max(0, product.stock - product.forecast.week),
                    month: Math.max(0, product.stock - product.forecast.month),
                    quarter: Math.max(0, product.stock - product.forecast.quarter)
                };
                
                // Statut prévu du stock
                if (product.stockForecast.month <= 0) {
                    product.forecastedStockStatus = 'outOfStock';
                } else if (product.stockForecast.month <= product.reorderLevel) {
                    product.forecastedStockStatus = 'lowStock';
                } else if (product.stockForecast.month >= product.reorderLevel * 5) {
                    product.forecastedStockStatus = 'overStock';
                } else {
                    product.forecastedStockStatus = 'optimalStock';
                }
                
                // Recommandation basée sur les prévisions
                if (product.forecastedStockStatus === 'outOfStock' || product.forecastedStockStatus === 'lowStock') {
                    const orderAmount = Math.max(product.reorderLevel * 2, product.forecast.month) - product.stock;
                    product.recommendation = {
                        type: 'restock',
                        amount: Math.max(5, orderAmount),
                        message: `Commander ${Math.max(5, orderAmount)} unités pour éviter une rupture`
                    };
                } else if (product.forecastedStockStatus === 'overStock') {
                    product.recommendation = {
                        type: 'promo',
                        discount: Math.floor(10 + Math.random() * 20),
                        message: `Envisager une promotion pour réduire le stock excédentaire`
                    };
                } else {
                    product.recommendation = {
                        type: 'maintain',
                        message: `Niveau de stock optimal, aucune action requise`
                    };
                }
                
                // Performance (score sur 100)
                const stockScore = product.stockStatus === 'optimalStock' ? 100 : 
                    (product.stockStatus === 'lowStock' ? 50 : 
                    (product.stockStatus === 'outOfStock' ? 0 : 25));
                
                const salesScore = Math.min(100, (product.sales.month / (product.reorderLevel * 3)) * 100);
                
                product.performanceScore = Math.floor((stockScore + salesScore) / 2);
                
                // Tendance (comparé au mois précédent)
                product.trend = (Math.random() > 0.5) ? 'up' : 'down';
                product.trendPercent = Math.floor(Math.random() * 30);
            });
            
            // Mettre en cache
            this.cache.products = products;
            
            return products;
        },
        
        getCategoryData: function() {
            if (this.cache.categories) {
                return this.cache.categories;
            }
            
            const products = this.getProductsData();
            const categoriesMap = {};
            
            // Regrouper les produits par catégorie
            products.forEach(product => {
                if (!categoriesMap[product.category]) {
                    categoriesMap[product.category] = {
                        name: product.category,
                        sales: {
                            day: 0,
                            week: 0,
                            month: 0,
                            year: 0
                        },
                        revenue: {
                            day: 0,
                            week: 0,
                            month: 0,
                            year: 0
                        },
                        products: [],
                        stockValue: 0
                    };
                }
                
                // Cumuler les ventes et revenus
                categoriesMap[product.category].sales.day += product.sales.day;
                categoriesMap[product.category].sales.week += product.sales.week;
                categoriesMap[product.category].sales.month += product.sales.month;
                categoriesMap[product.category].sales.year += product.sales.year;
                
                categoriesMap[product.category].revenue.day += product.revenue.day;
                categoriesMap[product.category].revenue.week += product.revenue.week;
                categoriesMap[product.category].revenue.month += product.revenue.month;
                categoriesMap[product.category].revenue.year += product.revenue.year;
                
                // Ajouter à la liste des produits
                categoriesMap[product.category].products.push(product);
                
                // Cumuler la valeur du stock
                categoriesMap[product.category].stockValue += product.stock * product.price;
            });
            
            // Convertir en tableau
            const categories = Object.values(categoriesMap);
            
            // Ajouter des pourcentages
            const totalSales = categories.reduce((sum, cat) => sum + cat.sales.month, 0);
            const totalRevenue = categories.reduce((sum, cat) => sum + cat.revenue.month, 0);
            
            categories.forEach(category => {
                category.percentage = {
                    sales: (category.sales.month / totalSales * 100).toFixed(1),
                    revenue: (category.revenue.month / totalRevenue * 100).toFixed(1)
                };
            });
            
            // Mettre en cache
            this.cache.categories = categories;
            
            return categories;
        },
        
        getSummaryData: function(period = 'month') {
            const products = this.getProductsData();
            
            // Calculer les totaux
            const totalSales = products.reduce((sum, product) => sum + product.sales[period], 0);
            const totalRevenue = products.reduce((sum, product) => sum + product.revenue[period], 0);
            const totalMargin = products.reduce((sum, product) => sum + parseFloat(product.margin[period]), 0);
            const stockValue = products.reduce((sum, product) => sum + (product.stock * product.price), 0);
            
            return {
                totalSales,
                totalRevenue,
                totalMargin,
                stockValue,
                profitMargin: (totalMargin / totalRevenue * 100).toFixed(1)
            };
        },
        
        getStockStatusData: function() {
            const products = this.getProductsData();
            
            // Compter les produits par statut de stock
            const outOfStock = products.filter(p => p.stockStatus === 'outOfStock').length;
            const lowStock = products.filter(p => p.stockStatus === 'lowStock').length;
            const overStock = products.filter(p => p.stockStatus === 'overStock').length;
            const optimalStock = products.filter(p => p.stockStatus === 'optimalStock').length;
            
            return {
                outOfStock,
                lowStock,
                overStock,
                optimalStock,
                total: products.length
            };
        },
        
        getTopProducts: function(criteria = 'sales', period = 'month', limit = 5) {
            const products = this.getProductsData();
            
            // Trier les produits selon le critère
            let sortedProducts;
            
            switch(criteria) {
                case 'sales':
                    sortedProducts = [...products].sort((a, b) => b.sales[period] - a.sales[period]);
                    break;
                case 'revenue':
                    sortedProducts = [...products].sort((a, b) => b.revenue[period] - a.revenue[period]);
                    break;
                case 'profit':
                case 'margin':
                    sortedProducts = [...products].sort((a, b) => parseFloat(b.margin[period]) - parseFloat(a.margin[period]));
                    break;
                case 'stock':
                    sortedProducts = [...products].sort((a, b) => b.stock - a.stock);
                    break;
                case 'lowStock':
                    sortedProducts = [...products].filter(p => p.stock > 0).sort((a, b) => a.stock - b.stock);
                    break;
                default:
                    sortedProducts = [...products].sort((a, b) => b.sales[period] - a.sales[period]);
            }
            
            // Limiter le nombre de résultats
            return sortedProducts.slice(0, limit);
        },
        
        // Utilitaire pour formatter les dates
        formatDate: function(date, format) {
            if (!date) return '';
            
            const day = date.getDate().toString().padStart(2, '0');
            const month = (date.getMonth() + 1).toString().padStart(2, '0');
            const monthName = ['Jan', 'Fév', 'Mar', 'Avr', 'Mai', 'Juin', 'Juil', 'Août', 'Sep', 'Oct', 'Nov', 'Déc'][date.getMonth()];
            const year = date.getFullYear();
            const hours = date.getHours().toString().padStart(2, '0');
            const minutes = date.getMinutes().toString().padStart(2, '0');
            
            return format
                .replace('dd', day)
                .replace('MM', month)
                .replace('MMM', monthName)
                .replace('yyyy', year)
                .replace('HH', hours)
                .replace('mm', minutes);
        },
        
        // Fonction pour filtrer les produits en fonction des critères
        filterProducts: function(searchTerm = '', category = 'all', stockStatus = 'all') {
            const products = this.getProductsData();
            
            return products.filter(product => {
                // Filtrer par terme de recherche
                const matchSearch = searchTerm === '' || 
                    product.name.toLowerCase().includes(searchTerm.toLowerCase()) ||
                    product.category.toLowerCase().includes(searchTerm.toLowerCase());
                
                // Filtrer par catégorie
                const matchCategory = category === 'all' || product.category === category;
                
                // Filtrer par statut de stock
                const matchStock = stockStatus === 'all' || product.stockStatus === stockStatus;
                
                return matchSearch && matchCategory && matchStock;
            });
        },
        
        // Trier les produits
        sortProducts: function(products, field = 'sales', order = 'desc', period = 'month') {
            const sortedProducts = [...products];
            
            switch(field) {
                case 'name':
                    sortedProducts.sort((a, b) => {
                        return order === 'asc' ? 
                            a.name.localeCompare(b.name) : 
                            b.name.localeCompare(a.name);
                    });
                    break;
                case 'category':
                    sortedProducts.sort((a, b) => {
                        return order === 'asc' ? 
                            a.category.localeCompare(b.category) : 
                            b.category.localeCompare(a.category);
                    });
                    break;
                case 'price':
                    sortedProducts.sort((a, b) => {
                        return order === 'asc' ? a.price - b.price : b.price - a.price;
                    });
                    break;
                case 'stock':
                    sortedProducts.sort((a, b) => {
                        return order === 'asc' ? a.stock - b.stock : b.stock - a.stock;
                    });
                    break;
                case 'sales':
                    sortedProducts.sort((a, b) => {
                        return order === 'asc' ? 
                            a.sales[period] - b.sales[period] : 
                            b.sales[period] - a.sales[period];
                    });
                    break;
                case 'revenue':
                    sortedProducts.sort((a, b) => {
                        return order === 'asc' ? 
                            a.revenue[period] - b.revenue[period] : 
                            b.revenue[period] - a.revenue[period];
                    });
                    break;
                case 'profit':
                case 'margin':
                    sortedProducts.sort((a, b) => {
                        return order === 'asc' ? 
                            parseFloat(a.margin[period]) - parseFloat(b.margin[period]) : 
                            parseFloat(b.margin[period]) - parseFloat(a.margin[period]);
                    });
                    break;
                case 'performance':
                    sortedProducts.sort((a, b) => {
                        return order === 'asc' ? 
                            a.performanceScore - b.performanceScore : 
                            b.performanceScore - a.performanceScore;
                    });
                    break;
                default:
                    // Par défaut, trier par ventes
                    sortedProducts.sort((a, b) => {
                        return order === 'asc' ? 
                            a.sales[period] - b.sales[period] : 
                            b.sales[period] - a.sales[period];
                    });
            }
            
            return sortedProducts;
        },
        
        // Paginer les résultats
        paginateProducts: function(products, page = 1, itemsPerPage = 10) {
            const startIndex = (page - 1) * itemsPerPage;
            const endIndex = startIndex + itemsPerPage;
            
            return {
                products: products.slice(startIndex, endIndex),
                currentPage: page,
                totalPages: Math.ceil(products.length / itemsPerPage),
                totalItems: products.length
            };
        }
    };
    
    // ========== INITIALISATION DES GRAPHIQUES ET VISUALISATIONS ==========
    
    // Initialiser le graphique principal
    function initMainChart() {
        const salesData = StatSuiviGlobal_data.generateSalesData(StatSuiviGlobal_data.config.currentPeriod);
        
        const options = {
            series: [
                {
                    name: 'Ventes',
                    data: salesData.map(item => item.sales)
                },
                {
                    name: 'Revenus (€)',
                    data: salesData.map(item => parseFloat(item.revenue))
                }
            ],
            chart: {
                type: StatSuiviGlobal_data.config.chartType,
                height: 350,
                toolbar: {
                    show: true,
                    tools: {
                        download: true,
                        selection: true,
                        zoom: true,
                        zoomin: true,
                        zoomout: true,
                        pan: true,
                        reset: true
                    }
                },
                animations: {
                    enabled: true,
                    easing: 'easeinout',
                    speed: 800,
                    animateGradually: {
                        enabled: true,
                        delay: 150
                    },
                    dynamicAnimation: {
                        enabled: true,
                        speed: 350
                    }
                }
            },
            dataLabels: {
                enabled: false
            },
            stroke: {
                curve: 'smooth',
                width: 2
            },
            xaxis: {
                categories: salesData.map(item => item.formattedDate),
                title: {
                    text: 'Période'
                }
            },
            yaxis: [
                {
                    title: {
                        text: 'Ventes (unités)'
                    },
                    labels: {
                        formatter: function(val) {
                            return Math.round(val);
                        }
                    }
                },
                {
                    opposite: true,
                    title: {
                        text: 'Revenus (€)'
                    },
                    labels: {
                        formatter: function(val) {
                            return val.toFixed(0) + ' €';
                        }
                    }
                }
            ],
            tooltip: {
                y: [
                    {
                        title: {
                            formatter: function(seriesName) {
                                return seriesName;
                            }
                        },
                        formatter: function(value) {
                            return value + ' unités';
                        }
                    },
                    {
                        title: {
                            formatter: function(seriesName) {
                                return seriesName;
                            }
                        },
                        formatter: function(value) {
                            return value.toFixed(2) + ' €';
                        }
                    }
                ]
            },
            fill: {
                opacity: [0.85, 0.5],
                gradient: {
                    inverseColors: false,
                    shade: 'light',
                    type: "vertical",
                    opacityFrom: 0.85,
                    opacityTo: 0.55,
                    stops: [0, 100, 100, 100]
                }
            },
            colors: ['#4e73df', '#1cc88a'],
            legend: {
                position: 'top',
                horizontalAlign: 'right',
                floating: true,
                offsetY: -25,
                offsetX: -5
            }
        };
        
        // Si le graphique existe déjà, le mettre à jour
        if (StatSuiviGlobal_data.charts.mainChart) {
            StatSuiviGlobal_data.charts.mainChart.updateOptions(options);
        } else {
            // Sinon, créer un nouveau graphique
            StatSuiviGlobal_data.charts.mainChart = new ApexCharts(
                document.querySelector("#StatSuiviGlobal_mainChart"), 
                options
            );
            StatSuiviGlobal_data.charts.mainChart.render();
        }
    }
    
    // Initialiser le graphique des catégories
    function initCategoryChart() {
        const categories = StatSuiviGlobal_data.getCategoryData();
        
        const options = {
            series: categories.map(cat => parseFloat(cat.percentage.sales)),
            chart: {
                type: 'pie',
                height: 350,
                animations: {
                    enabled: true,
                    easing: 'easeinout',
                    speed: 800,
                    animateGradually: {
                        enabled: true,
                        delay: 150
                    },
                    dynamicAnimation: {
                        enabled: true,
                        speed: 350
                    }
                }
            },
            labels: categories.map(cat => cat.name),
            responsive: [{
                breakpoint: 480,
                options: {
                    chart: {
                        width: 300
                    },
                    legend: {
                        position: 'bottom'
                    }
                }
            }],
            legend: {
                position: 'bottom'
            },
            tooltip: {
                y: {
                    formatter: function(value, { seriesIndex }) {
                        return `${value}% (${categories[seriesIndex].sales.month} ventes)`;
                    }
                }
            },
            colors: [
                '#4e73df', '#1cc88a', '#36b9cc', '#f6c23e', '#e74a3b',
                '#5a5c69', '#6610f2', '#6f42c1', '#fd7e14', '#20c9a6',
                '#858796', '#f8f9fc', '#d1d3e2', '#dddfeb', '#e3e6f0'
            ]
        };
        
        // Si le graphique existe déjà, le mettre à jour
        if (StatSuiviGlobal_data.charts.categoryChart) {
            StatSuiviGlobal_data.charts.categoryChart.updateOptions(options);
        } else {
            // Sinon, créer un nouveau graphique
            StatSuiviGlobal_data.charts.categoryChart = new ApexCharts(
                document.querySelector("#StatSuiviGlobal_categoryChart"), 
                options
            );
            StatSuiviGlobal_data.charts.categoryChart.render();
        }
    }
    
    // Initialiser la visualisation de la distribution du stock
    function initStockDistribution() {
        const products = StatSuiviGlobal_data.getProductsData();
        
        // Préparer les données pour le graphique en bulles
        const bubbleData = products.map(product => {
            return {
                x: product.sales.month, // Ventes mensuelles sur l'axe X
                y: product.price,       // Prix sur l'axe Y
                z: product.stock,       // Stock représenté par la taille de la bulle
                name: product.name,
                category: product.category,
                stockValue: product.stock * product.price
            };
        });
        
        const options = {
            series: [{
                name: 'Produits',
                data: bubbleData
            }],
            chart: {
                height: 350,
                type: 'bubble',
                animations: {
                    enabled: true,
                    easing: 'easeinout',
                    speed: 800,
                    animateGradually: {
                        enabled: true,
                        delay: 150
                    },
                    dynamicAnimation: {
                        enabled: true,
                        speed: 350
                    }
                }
            },
            dataLabels: {
                enabled: false
            },
            fill: {
                opacity: 0.8,
                type: 'solid'
            },
            xaxis: {
                title: {
                    text: 'Ventes mensuelles'
                },
                tickAmount: 10
            },
            yaxis: {
                title: {
                    text: 'Prix (€)'
                },
                labels: {
                    formatter: function(val) {
                        return val.toFixed(0) + ' €';
                    }
                }
            },
            tooltip: {
                theme: 'dark',
                x: {
                    show: true,
                    formatter: function(value) {
                        return value + ' ventes/mois';
                    }
                },
                y: {
                    formatter: function(value) {
                        return value.toFixed(2) + ' €';
                    }
                },
                z: {
                    title: 'Stock:',
                    formatter: function(value) {
                        return value + ' unités';
                    }
                },
                custom: function({ series, seriesIndex, dataPointIndex, w }) {
                    const data = w.globals.initialSeries[seriesIndex].data[dataPointIndex];
                    return `<div class="apexcharts-tooltip-custom">
                            <div class="apexcharts-tooltip-title">${data.name}</div>
                            <div class="apexcharts-tooltip-y">${data.category}</div>
                            <div class="apexcharts-tooltip-z">Prix: ${data.y.toFixed(2)} €</div>
                            <div class="apexcharts-tooltip-z">Ventes: ${data.x} unités/mois</div>
                            <div class="apexcharts-tooltip-z">Stock: ${data.z} unités</div>
                            <div class="apexcharts-tooltip-z">Valeur stock: ${data.stockValue.toFixed(2)} €</div>
                            </div>`;
                }
            }
        };
        
        // Options pour le treemap (alternative à la vue en bulles)
        const treemapOptions = {
            series: [{
                data: products.map(product => {
                    return {
                        x: product.name,
                        y: product.stock * product.price, // Valeur du stock
                        fillColor: product.stockStatus === 'outOfStock' ? '#e74a3b' :
                                  product.stockStatus === 'lowStock' ? '#f6c23e' :
                                  product.stockStatus === 'overStock' ? '#4e73df' : '#1cc88a',
                        category: product.category,
                        stock: product.stock,
                        price: product.price
                    };
                })
            }],
            chart: {
                height: 350,
                type: 'treemap',
                animations: {
                    enabled: true,
                    easing: 'easeinout',
                    speed: 800,
                    animateGradually: {
                        enabled: true,
                        delay: 150
                    },
                    dynamicAnimation: {
                        enabled: true,
                        speed: 350
                    }
                }
            },
            title: {
                text: 'Distribution du stock par valeur',
                align: 'center'
            },
            tooltip: {
                theme: 'dark',
                custom: function({ series, seriesIndex, dataPointIndex, w }) {
                    const data = w.globals.initialSeries[seriesIndex].data[dataPointIndex];
                    return `<div class="apexcharts-tooltip-custom">
                            <div class="apexcharts-tooltip-title">${data.x}</div>
                            <div class="apexcharts-tooltip-y">${data.category}</div>
                            <div class="apexcharts-tooltip-z">Valeur stock: ${data.y.toFixed(2)} €</div>
                            <div class="apexcharts-tooltip-z">Stock: ${data.stock} unités</div>
                            <div class="apexcharts-tooltip-z">Prix unitaire: ${data.price.toFixed(2)} €</div>
                            </div>`;
                }
            }
        };
        
        // Initialiser avec la vue sélectionnée (bulles ou treemap)
        const currentOptions = StatSuiviGlobal_data.config.stockView === 'bubble' ? options : treemapOptions;
        
        // Si le graphique existe déjà, le mettre à jour
        if (StatSuiviGlobal_data.charts.stockDistribution) {
            StatSuiviGlobal_data.charts.stockDistribution.updateOptions(currentOptions);
        } else {
            // Sinon, créer un nouveau graphique
            StatSuiviGlobal_data.charts.stockDistribution = new ApexCharts(
                document.querySelector("#StatSuiviGlobal_stockDistribution"), 
                currentOptions
            );
            StatSuiviGlobal_data.charts.stockDistribution.render();
        }
    }
    
    // Initialiser le graphique de prévisions
    function initForecastChart() {
        const period = StatSuiviGlobal_data.config.forecastPeriod;
        const type = StatSuiviGlobal_data.config.forecastType;
        
        // Générer des données de prévision
        // Données historiques (6 dernières périodes) + prévisions (3 périodes futures)
        const historicalData = [];
        const forecastData = [];
        
        // Créer des données fictives pour les 6 dernières périodes
        const now = new Date();
        for (let i = 5; i >= 0; i--) {
            let date;
            let label;
            
            switch(period) {
                case 'week':
                    date = new Date(now);
                    date.setDate(now.getDate() - (i * 7));
                    label = `S${StatSuiviGlobal_data.formatDate(date, 'dd/MM')}`;
                    break;
                case 'month':
                    date = new Date(now);
                    date.setMonth(now.getMonth() - i);
                    label = StatSuiviGlobal_data.formatDate(date, 'MMM');
                    break;
                case 'quarter':
                    date = new Date(now);
                    date.setMonth(now.getMonth() - (i * 3));
                    const quarter = Math.floor(date.getMonth() / 3) + 1;
                    label = `T${quarter} ${date.getFullYear()}`;
                    break;
                case 'year':
                    date = new Date(now);
                    date.setFullYear(now.getFullYear() - i);
                    label = date.getFullYear().toString();
                    break;
                default:
                    date = new Date(now);
                    date.setMonth(now.getMonth() - i);
                    label = StatSuiviGlobal_data.formatDate(date, 'MMM');
            }
            
            // Base value avec une tendance légèrement croissante
            const baseValue = 500 + (i * 20) + Math.random() * 50;
            
            let value;
            switch(type) {
                case 'sales':
                    value = Math.floor(baseValue);
                    break;
                case 'revenue':
                    value = Math.floor(baseValue * 25);
                    break;
                case 'stock':
                    value = Math.floor(1000 - (i * 50) - Math.random() * 30);
                    break;
                default:
                    value = Math.floor(baseValue);
            }
            
            historicalData.push({
                x: label,
                y: value
            });
        }
        
        // Créer des données prévisionnelles pour les 3 périodes futures
        for (let i = 1; i <= 3; i++) {
            let date;
            let label;
            
            switch(period) {
                case 'week':
                    date = new Date(now);
                    date.setDate(now.getDate() + (i * 7));
                    label = `S${StatSuiviGlobal_data.formatDate(date, 'dd/MM')}`;
                    break;
                case 'month':
                    date = new Date(now);
                    date.setMonth(now.getMonth() + i);
                    label = StatSuiviGlobal_data.formatDate(date, 'MMM');
                    break;
                case 'quarter':
                    date = new Date(now);
                    date.setMonth(now.getMonth() + (i * 3));
                    const quarter = Math.floor(date.getMonth() / 3) + 1;
                    label = `T${quarter} ${date.getFullYear()}`;
                    break;
                case 'year':
                    date = new Date(now);
                    date.setFullYear(now.getFullYear() + i);
                    label = date.getFullYear().toString();
                    break;
                default:
                    date = new Date(now);
                    date.setMonth(now.getMonth() + i);
                    label = StatSuiviGlobal_data.formatDate(date, 'MMM');
            }
            
            // Utiliser la dernière valeur historique comme base
            // et ajouter une tendance croissante avec un peu d'aléatoire
            const lastHistoricalValue = historicalData[historicalData.length - 1].y;
            const growthFactor = 1 + (0.1 * i) + (Math.random() * 0.05);
            
            let value;
            switch(type) {
                case 'sales':
                    value = Math.floor(lastHistoricalValue * growthFactor);
                    break;
                case 'revenue':
                    value = Math.floor(lastHistoricalValue * growthFactor);
                    break;
                case 'stock':
                    // Pour le stock, tendance décroissante (consommation)
                    value = Math.floor(lastHistoricalValue * (1 - (0.05 * i) - (Math.random() * 0.05)));
                    break;
                default:
                    value = Math.floor(lastHistoricalValue * growthFactor);
            }
            
            forecastData.push({
                x: label,
                y: value
            });
        }
        
        // Configuration du graphique
        let title, yAxisTitle, tooltipFormatter;
        switch(type) {
            case 'sales':
                title = 'Prévisions de ventes';
                yAxisTitle = 'Ventes (unités)';
                tooltipFormatter = function(value) {
                    return value + ' unités';
                };
                break;
            case 'revenue':
                title = 'Prévisions de revenus';
                yAxisTitle = 'Revenus (€)';
                tooltipFormatter = function(value) {
                    return value.toFixed(0) + ' €';
                };
                break;
            case 'stock':
                title = 'Prévisions de niveau de stock';
                yAxisTitle = 'Stock (unités)';
                tooltipFormatter = function(value) {
                    return value + ' unités';
                };
                break;
            default:
                title = 'Prévisions';
                yAxisTitle = 'Valeur';
                tooltipFormatter = function(value) {
                    return value;
                };
        }
        
        const options = {
            series: [
                {
                    name: 'Historique',
                    data: historicalData
                },
                {
                    name: 'Prévisions',
                    data: forecastData
                }
            ],
            chart: {
                height: 350,
                type: 'line',
                zoom: {
                    enabled: false
                },
                animations: {
                    enabled: true,
                    easing: 'easeinout',
                    speed: 800,
                    animateGradually: {
                        enabled: true,
                        delay: 150
                    },
                    dynamicAnimation: {
                        enabled: true,
                        speed: 350
                    }
                }
            },
            title: {
                text: title,
                align: 'left'
            },
            dataLabels: {
                enabled: false
            },
            stroke: {
                curve: 'straight',
                width: [2, 2],
                dashArray: [0, 5]
            },
            grid: {
                row: {
                    colors: ['#f3f3f3', 'transparent'],
                    opacity: 0.5
                }
            },
            xaxis: {
                categories: [...historicalData.map(d => d.x), ...forecastData.map(d => d.x)]
            },
            yaxis: {
                title: {
                    text: yAxisTitle
                },
                labels: {
                    formatter: tooltipFormatter
                }
            },
            tooltip: {
                y: {
                    formatter: tooltipFormatter
                }
            },
            colors: ['#4e73df', '#1cc88a'],
            legend: {
                position: 'top',
                horizontalAlign: 'right'
            },
            markers: {
                size: [4, 4],
                strokeWidth: 0,
                hover: {
                    size: 7
                }
            }
        };
        
        // Si le graphique existe déjà, le mettre à jour
        if (StatSuiviGlobal_data.charts.forecastChart) {
            StatSuiviGlobal_data.charts.forecastChart.updateOptions(options);
        } else {
            // Sinon, créer un nouveau graphique
            StatSuiviGlobal_data.charts.forecastChart = new ApexCharts(
                document.querySelector("#StatSuiviGlobal_forecastChart"), 
                options
            );
            StatSuiviGlobal_data.charts.forecastChart.render();
        }
    }
    
    // ========== FONCTIONS DE MISE À JOUR DE L'INTERFACE ==========
    
    // Mettre à jour les résumés globaux
    function updateSummary() {
        const period = ['day', 'week', 'month', 'year'].includes(StatSuiviGlobal_data.config.chartPeriod) ? 
            StatSuiviGlobal_data.config.chartPeriod : 'month';
        
        const summaryData = StatSuiviGlobal_data.getSummaryData(period);
        
        // Mettre à jour le résumé des revenus
        document.getElementById('StatSuiviGlobal_totalRevenue').textContent = 
            summaryData.totalRevenue.toLocaleString('fr-FR') + ' €';
        
        // Mettre à jour le résumé des ventes
        document.getElementById('StatSuiviGlobal_totalSales').textContent = 
            summaryData.totalSales.toLocaleString('fr-FR');
        
        // Mettre à jour la valeur du stock
        document.getElementById('StatSuiviGlobal_stockValue').textContent = 
            summaryData.stockValue.toLocaleString('fr-FR') + ' €';
        
        // Mettre à jour la marge bénéficiaire
        document.getElementById('StatSuiviGlobal_profitMargin').textContent = 
            summaryData.profitMargin + '%';
    }
    
    // Mettre à jour la liste des meilleurs produits
    function updateTopProductsList() {
        const topProductsList = document.getElementById('StatSuiviGlobal_topProductsList');
        const topProducts = StatSuiviGlobal_data.getTopProducts(
            document.querySelector('.StatSuiviGlobal_topProductBtn.active').dataset.type || 'sales',
            StatSuiviGlobal_data.config.chartPeriod || 'month',
            5
        );
        
        let html = '';
        
        topProducts.forEach((product, index) => {
            const period = StatSuiviGlobal_data.config.chartPeriod || 'month';
            let value, unit;
            
            // Déterminer la valeur à afficher en fonction du critère sélectionné
            const criteria = document.querySelector('.StatSuiviGlobal_topProductBtn.active').dataset.type || 'sales';
            
            switch(criteria) {
                case 'sales':
                    value = product.sales[period];
                    unit = 'unités';
                    break;
                case 'revenue':
                    value = product.revenue[period].toFixed(2);
                    unit = '€';
                    break;
                case 'profit':
                    value = product.margin[period];
                    unit = '€';
                    break;
                default:
                    value = product.sales[period];
                    unit = 'unités';
            }
            
            html += `
                <div class="StatSuiviGlobal_productItem">
                    <div class="StatSuiviGlobal_productRank">${index + 1}</div>
                    <div class="StatSuiviGlobal_productImage">
                        <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjNkM3NTdEIiBkPSJNMzI5Ljc3IDk0Ljk1QzMwOC41MiA3My43MiAyODAuMjggNjMgMjUwIDYzcy01OC41MiAxMC43Mi03OS43NyAzMS45NUM5NC45OCAxNzAuMTYgOTQuOTggMzQxLjg0IDE3MC4yMyA0MTcuMDVjMCAwIDIwLjQzLTI1LjA5IDQxLjA4LTUwLjQxLTE3LjA3LTMwLjQ3LTE1LjA1LTY5LjI1IDE0LjA5LTk4LjM5IDM0LjA2LTM0LjA2IDg5LjE3LTM0LjA2IDEyMy4yMyAwIDI5LjE0IDI5LjE0IDMxLjEyIDY3LjkyIDE0LjA1IDk4LjM5IDIwLjY2IDI1LjMyIDQxLjA5IDUwLjQxIDQxLjA5IDUwLjQxIDc1LjI0LTc1LjIxIDc1LjI0LTI0Ni44OSAwLTMyMi4xeiIvPjwvc3ZnPg==" alt="Product">
                    </div>
                    <div class="StatSuiviGlobal_productInfo">
                        <div class="StatSuiviGlobal_productName">${product.name}</div>
                        <div class="StatSuiviGlobal_productCategory">${product.category}</div>
                    </div>
                    <div class="StatSuiviGlobal_productValue">
                        <div class="StatSuiviGlobal_productMetric">${value.toLocaleString('fr-FR')} ${unit}</div>
                        <div class="StatSuiviGlobal_productProgress">
                            <div class="StatSuiviGlobal_productProgressBar" style="width: ${(1 - (index * 0.15)) * 100}%"></div>
                        </div>
                    </div>
                </div>
            `;
        });
        
        topProductsList.innerHTML = html;
    }
    
    // Mettre à jour le tableau de performance
    function updatePerformanceTable() {
        const tableBody = document.getElementById('StatSuiviGlobal_performanceTableBody');
        const period = StatSuiviGlobal_data.config.chartPeriod || 'month';
        
        // Obtenir les produits filtrés, triés et paginés
        const searchTerm = document.querySelector('.StatSuiviGlobal_searchInput').value || '';
        const filteredProducts = StatSuiviGlobal_data.filterProducts(searchTerm);
        
        const sortedProducts = StatSuiviGlobal_data.sortProducts(
            filteredProducts,
            StatSuiviGlobal_data.config.performanceSort.field,
            StatSuiviGlobal_data.config.performanceSort.order,
            period
        );
        
        const paginatedData = StatSuiviGlobal_data.paginateProducts(
            sortedProducts,
            StatSuiviGlobal_data.config.currentPage,
            StatSuiviGlobal_data.config.itemsPerPage
        );
        
        // Mettre à jour les informations de pagination
        document.getElementById('StatSuiviGlobal_currentPage').textContent = paginatedData.currentPage;
        document.getElementById('StatSuiviGlobal_totalPages').textContent = paginatedData.totalPages;
        
        // Générer le HTML du tableau
        let html = '';
        
        paginatedData.products.forEach(product => {
            // Déterminer la classe de performance
            let performanceClass = '';
            if (product.performanceScore >= 80) {
                performanceClass = 'excellent';
            } else if (product.performanceScore >= 60) {
                performanceClass = 'good';
            } else if (product.performanceScore >= 40) {
                performanceClass = 'average';
            } else if (product.performanceScore >= 20) {
                performanceClass = 'poor';
            } else {
                performanceClass = 'critical';
            }
            
            // Déterminer le statut de stock
            let stockClass = '';
            let stockText = '';
            
            if (product.stockStatus === 'outOfStock') {
                stockClass = 'out-of-stock';
                stockText = 'Rupture';
            } else if (product.stockStatus === 'lowStock') {
                stockClass = 'low-stock';
                stockText = product.stock;
            } else if (product.stockStatus === 'overStock') {
                stockClass = 'over-stock';
                stockText = product.stock;
            } else {
                stockClass = 'optimal-stock';
                stockText = product.stock;
            }
            
            html += `
                <tr>
                    <td>
                        <div class="StatSuiviGlobal_tableProductInfo">
                            <div class="StatSuiviGlobal_tableProductImage">
                                <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjNkM3NTdEIiBkPSJNMzI5Ljc3IDk0Ljk1QzMwOC41MiA3My43MiAyODAuMjggNjMgMjUwIDYzcy01OC41MiAxMC43Mi03OS43NyAzMS45NUM5NC45OCAxNzAuMTYgOTQuOTggMzQxLjg0IDE3MC4yMyA0MTcuMDVjMCAwIDIwLjQzLTI1LjA5IDQxLjA4LTUwLjQxLTE3LjA3LTMwLjQ3LTE1LjA1LTY5LjI1IDE0LjA5LTk4LjM5IDM0LjA2LTM0LjA2IDg5LjE3LTM0LjA2IDEyMy4yMyAwIDI5LjE0IDI5LjE0IDMxLjEyIDY3LjkyIDE0LjA1IDk4LjM5IDIwLjY2IDI1LjMyIDQxLjA5IDUwLjQxIDQxLjA5IDUwLjQxIDc1LjI0LTc1LjIxIDc1LjI0LTI0Ni44OSAwLTMyMi4xeiIvPjwvc3ZnPg==" alt="Product">
                            </div>
                            <div class="StatSuiviGlobal_tableProductName">${product.name}</div>
                        </div>
                    </td>
                    <td>${product.category}</td>
                    <td>${product.price.toFixed(2)} €</td>
                    <td>${product.sales[period]}</td>
                    <td>${product.revenue[period].toFixed(2)} €</td>
                    <td><span class="StatSuiviGlobal_stockLabel ${stockClass}">${stockText}</span></td>
                    <td>
                        <div class="StatSuiviGlobal_performanceMeter">
                            <div class="StatSuiviGlobal_performanceBar ${performanceClass}" style="width: ${product.performanceScore}%"></div>
                            <span>${product.performanceScore}/100</span>
                        </div>
                    </td>
                </tr>
            `;
        });
        
        tableBody.innerHTML = html;
    }
    
    // Mettre à jour l'analyse de stock
    function updateStockAnalysis() {
        const tableBody = document.getElementById('StatSuiviGlobal_stockAnalysisTableBody');
        const analysisType = StatSuiviGlobal_data.config.analysisType;
        
        // Obtenir les produits filtrés par statut de stock
        const products = StatSuiviGlobal_data.getProductsData().filter(product => {
            return product.stockStatus === analysisType;
        });
        
        // Générer le HTML du tableau
        let html = '';
        
        products.forEach(product => {
            // Déterminer le statut avec une classe CSS
            let statusClass = '';
            let statusIcon = '';
            let statusText = '';
            
            switch(product.stockStatus) {
                case 'outOfStock':
                    statusClass = 'out-of-stock';
                    statusIcon = 'exclamation-triangle';
                    statusText = 'Rupture de stock';
                    break;
                case 'lowStock':
                    statusClass = 'low-stock';
                    statusIcon = 'battery-quarter';
                    statusText = 'Stock faible';
                    break;
                case 'overStock':
                    statusClass = 'over-stock';
                    statusIcon = 'boxes';
                    statusText = 'Surstock';
                    break;
                case 'optimalStock':
                    statusClass = 'optimal-stock';
                    statusIcon = 'check-circle';
                    statusText = 'Stock optimal';
                    break;
                default:
                    statusClass = '';
                    statusIcon = 'question-circle';
                    statusText = 'Inconnu';
            }
            
            html += `
                <tr>
                    <td>
                        <div class="StatSuiviGlobal_tableProductInfo">
                            <div class="StatSuiviGlobal_tableProductImage">
                                <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjNkM3NTdEIiBkPSJNMzI5Ljc3IDk0Ljk1QzMwOC41MiA3My43MiAyODAuMjggNjMgMjUwIDYzcy01OC41MiAxMC43Mi03OS43NyAzMS45NUM5NC45OCAxNzAuMTYgOTQuOTggMzQxLjg0IDE3MC4yMyA0MTcuMDVjMCAwIDIwLjQzLTI1LjA5IDQxLjA4LTUwLjQxLTE3LjA3LTMwLjQ3LTE1LjA1LTY5LjI1IDE0LjA5LTk4LjM5IDM0LjA2LTM0LjA2IDg5LjE3LTM0LjA2IDEyMy4yMyAwIDI5LjE0IDI5LjE0IDMxLjEyIDY3LjkyIDE0LjA1IDk4LjM5IDIwLjY2IDI1LjMyIDQxLjA5IDUwLjQxIDQxLjA5IDUwLjQxIDc1LjI0LTc1LjIxIDc1LjI0LTI0Ni44OSAwLTMyMi4xeiIvPjwvc3ZnPg==" alt="Product">
                            </div>
                            <div class="StatSuiviGlobal_tableProductName">${product.name}</div>
                        </div>
                    </td>
                    <td>${product.category}</td>
                    <td>${product.stock}</td>
                    <td>${product.reorderLevel}</td>
                    <td>${product.lastRestock}</td>
                    <td>${product.recentSales}</td>
                    <td>
                        <span class="StatSuiviGlobal_statusLabel ${statusClass}">
                            <i class="fas fa-${statusIcon}"></i> ${statusText}
                        </span>
                    </td>
                    <td>
                        <div class="StatSuiviGlobal_tableActions">
                            ${product.stockStatus === 'outOfStock' || product.stockStatus === 'lowStock' ? 
                                `<button class="StatSuiviGlobal_actionBtn order">
                                    <i class="fas fa-shopping-cart"></i> Commander
                                </button>` : ''}
                            ${product.stockStatus === 'overStock' ? 
                                `<button class="StatSuiviGlobal_actionBtn promo">
                                    <i class="fas fa-tags"></i> Promotion
                                </button>` : ''}
                            <button class="StatSuiviGlobal_actionBtn details">
                                <i class="fas fa-eye"></i> Détails
                            </button>
                        </div>
                    </td>
                </tr>
            `;
        });
        
        tableBody.innerHTML = html || `
            <tr>
                <td colspan="8" class="text-center">
                    <div class="StatSuiviGlobal_emptyState">
                        <i class="fas fa-search"></i>
                        <p>Aucun produit ne correspond à ce critère actuellement</p>
                    </div>
                </td>
            </tr>
        `;
    }
    
    // Mettre à jour la table des prévisions
    function updateForecastTable() {
        const tableBody = document.getElementById('StatSuiviGlobal_forecastTableBody');
        const period = StatSuiviGlobal_data.config.forecastPeriod;
        
        const products = StatSuiviGlobal_data.getProductsData();
        
        // Trier les produits par importance de prévision (problèmes potentiels en premier)
        const sortedProducts = [...products].sort((a, b) => {
            // Priorité aux produits en rupture de stock imminente
            if (a.forecastedStockStatus === 'outOfStock' && b.forecastedStockStatus !== 'outOfStock') {
                return -1;
            }
            if (a.forecastedStockStatus !== 'outOfStock' && b.forecastedStockStatus === 'outOfStock') {
                return 1;
            }
            
            // Ensuite, trier par stock faible
            if (a.forecastedStockStatus === 'lowStock' && b.forecastedStockStatus !== 'lowStock') {
                return -1;
            }
            if (a.forecastedStockStatus !== 'lowStock' && b.forecastedStockStatus === 'lowStock') {
                return 1;
            }
            
            // Enfin, trier par croissance des ventes
            const aGrowth = a.forecast[period] / Math.max(1, a.sales[period]) - 1;
            const bGrowth = b.forecast[period] / Math.max(1, b.sales[period]) - 1;
            
            return bGrowth - aGrowth;
        });
        
        // Limiter à 10 produits pour ne pas surcharger le tableau
        const displayProducts = sortedProducts.slice(0, 10);
        
        // Générer le HTML du tableau
        let html = '';
        
        displayProducts.forEach(product => {
            // Calculer la croissance
            const currentSales = product.sales[period];
            const forecastedSales = product.forecast[period];
            const growthPercent = ((forecastedSales / Math.max(1, currentSales)) - 1) * 100;
            
            // Déterminer la classe pour la croissance
            let growthClass = growthPercent >= 0 ? 'positive' : 'negative';
            
            // Déterminer le statut prévu du stock avec une classe CSS
            let statusClass = '';
            let statusIcon = '';
            let statusText = '';
            
            switch(product.forecastedStockStatus) {
                case 'outOfStock':
                    statusClass = 'out-of-stock';
                    statusIcon = 'exclamation-triangle';
                    statusText = 'Rupture prévue';
                    break;
                case 'lowStock':
                    statusClass = 'low-stock';
                    statusIcon = 'battery-quarter';
                    statusText = 'Stock faible prévu';
                    break;
                case 'overStock':
                    statusClass = 'over-stock';
                    statusIcon = 'boxes';
                    statusText = 'Surstock prévu';
                    break;
                case 'optimalStock':
                    statusClass = 'optimal-stock';
                    statusIcon = 'check-circle';
                    statusText = 'Stock optimal prévu';
                    break;
                default:
                    statusClass = '';
                    statusIcon = 'question-circle';
                    statusText = 'Inconnu';
            }
            
            html += `
                <tr>
                    <td>
                        <div class="StatSuiviGlobal_tableProductInfo">
                            <div class="StatSuiviGlobal_tableProductImage">
                                <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjNkM3NTdEIiBkPSJNMzI5Ljc3IDk0Ljk1QzMwOC41MiA3My43MiAyODAuMjggNjMgMjUwIDYzcy01OC41MiAxMC43Mi03OS43NyAzMS45NUM5NC45OCAxNzAuMTYgOTQuOTggMzQxLjg0IDE3MC4yMyA0MTcuMDVjMCAwIDIwLjQzLTI1LjA5IDQxLjA4LTUwLjQxLTE3LjA3LTMwLjQ3LTE1LjA1LTY5LjI1IDE0LjA5LTk4LjM5IDM0LjA2LTM0LjA2IDg5LjE3LTM0LjA2IDEyMy4yMyAwIDI5LjE0IDI5LjE0IDMxLjEyIDY3LjkyIDE0LjA1IDk4LjM5IDIwLjY2IDI1LjMyIDQxLjA5IDUwLjQxIDQxLjA5IDUwLjQxIDc1LjI0LTc1LjIxIDc1LjI0LTI0Ni44OSAwLTMyMi4xeiIvPjwvc3ZnPg==" alt="Product">
                            </div>
                            <div class="StatSuiviGlobal_tableProductName">${product.name}</div>
                        </div>
                    </td>
                    <td>${currentSales}</td>
                    <td>${forecastedSales}</td>
                    <td>
                        <span class="StatSuiviGlobal_growthLabel ${growthClass}">
                            <i class="fas fa-arrow-${growthPercent >= 0 ? 'up' : 'down'}"></i> 
                            ${Math.abs(growthPercent).toFixed(1)}%
                        </span>
                    </td>
                    <td>${product.stock}</td>
                    <td>${product.stockForecast[period]}</td>
                    <td>
                        <span class="StatSuiviGlobal_statusLabel ${statusClass}">
                            <i class="fas fa-${statusIcon}"></i> ${statusText}
                        </span>
                    </td>
                    <td>
                        <div class="StatSuiviGlobal_recommendationChip">
                            <i class="fas fa-${product.recommendation.type === 'restock' ? 'shopping-cart' : 
                                             product.recommendation.type === 'promo' ? 'tags' : 'check'}"></i>
                            ${product.recommendation.message}
                        </div>
                    </td>
                </tr>
            `;
        });
        
        tableBody.innerHTML = html;
    }
    
    // Mettre à jour les statistiques de top performances
    function updateTopPerformance() {
        const topPerformanceList = document.querySelector(`.StatSuiviGlobal_topPerformanceList[data-content="${StatSuiviGlobal_data.config.topPerformanceTab}"]`);
        const period = StatSuiviGlobal_data.config.topPerformanceTab; // day, week, month, year
        const topProducts = StatSuiviGlobal_data.getTopProducts('sales', period, StatSuiviGlobal_data.config.topCount);
        
        // Mettre à jour le meilleur produit
        const bestProduct = topProducts[0];
        if (bestProduct) {
            const bestProductContent = topPerformanceList.querySelector('.StatSuiviGlobal_bestProduct');
            if (bestProductContent) {
                bestProductContent.innerHTML = `
                    <div class="StatSuiviGlobal_bestProductBadge">
                        <i class="fas fa-trophy"></i> Meilleur produit ${period === 'day' ? 'du jour' : 
                                                                         period === 'week' ? 'de la semaine' : 
                                                                         period === 'month' ? 'du mois' : 'de l\'année'}
                    </div>
                    <div class="StatSuiviGlobal_bestProductContent">
                        <div class="StatSuiviGlobal_bestProductImage">
                            <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjNkM3NTdEIiBkPSJNMjU2IDhDMTE5IDggOCAxMTkgOCAyNTZzMTExIDI0OCAyNDggMjQ4IDI0OC0xMTEgMjQ4LTI0OFMzOTMgOCAyNTYgOHptMCA0NDhjLTExMC41IDAtMjAwLTg5LjUtMjAwLTIwMFMxNDUuNSA1NiAyNTYgNTZzMjAwIDg5LjUgMjAwIDIwMC04OS41IDIwMC0yMDAgMjAweiIvPjwvc3ZnPg==" alt="Product">
                        </div>
                        <div class="StatSuiviGlobal_bestProductInfo">
                            <h5>${bestProduct.name}</h5>
                            <div class="StatSuiviGlobal_bestProductCategory">${bestProduct.category}</div>
                            <div class="StatSuiviGlobal_bestProductStats">
                                <div class="StatSuiviGlobal_bestProductStat">
                                    <div class="StatSuiviGlobal_bestProductStatLabel">Ventes</div>
                                    <div class="StatSuiviGlobal_bestProductStatValue">${bestProduct.sales[period]}</div>
                                </div>
                                <div class="StatSuiviGlobal_bestProductStat">
                                    <div class="StatSuiviGlobal_bestProductStatLabel">Revenus</div>
                                    <div class="StatSuiviGlobal_bestProductStatValue">${bestProduct.revenue[period].toFixed(2)} €</div>
                                </div>
                                <div class="StatSuiviGlobal_bestProductStat">
                                    <div class="StatSuiviGlobal_bestProductStatLabel">Prix</div>
                                    <div class="StatSuiviGlobal_bestProductStatValue">${bestProduct.price.toFixed(2)} €</div>
                                </div>
                            </div>
                        </div>
                    </div>
                `;
            }
            
            // Mettre à jour la liste des autres top produits
            const topProductsContainer = topPerformanceList.querySelector('.StatSuiviGlobal_topProducts');
            if (topProductsContainer) {
                let html = '';
                
                // Commencer à partir du 2ème produit (indice 1)
                for (let i = 1; i < topProducts.length; i++) {
                    const product = topProducts[i];
                    
                    html += `
                        <div class="StatSuiviGlobal_topProductItem">
                            <div class="StatSuiviGlobal_topProductRank">${i + 1}</div>
                            <div class="StatSuiviGlobal_topProductImage">
                                <img src="data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHZpZXdCb3g9IjAgMCA1MTIgNTEyIj48cGF0aCBmaWxsPSIjNkM3NTdEIiBkPSJNMzI5Ljc3IDk0Ljk1QzMwOC41MiA3My43MiAyODAuMjggNjMgMjUwIDYzcy01OC41MiAxMC43Mi03OS43NyAzMS45NUM5NC45OCAxNzAuMTYgOTQuOTggMzQxLjg0IDE3MC4yMyA0MTcuMDVjMCAwIDIwLjQzLTI1LjA5IDQxLjA4LTUwLjQxLTE3LjA3LTMwLjQ3LTE1LjA1LTY5LjI1IDE0LjA5LTk4LjM5IDM0LjA2LTM0LjA2IDg5LjE3LTM0LjA2IDEyMy4yMyAwIDI5LjE0IDI5LjE0IDMxLjEyIDY3LjkyIDE0LjA1IDk4LjM5IDIwLjY2IDI1LjMyIDQxLjA5IDUwLjQxIDQxLjA5IDUwLjQxIDc1LjI0LTc1LjIxIDc1LjI0LTI0Ni44OSAwLTMyMi4xeiIvPjwvc3ZnPg==" alt="Product">
                            </div>
                            <div class="StatSuiviGlobal_topProductInfo">
                                <div class="StatSuiviGlobal_topProductName">${product.name}</div>
                                <div class="StatSuiviGlobal_topProductCategory">${product.category}</div>
                                <div class="StatSuiviGlobal_topProductMetrics">
                                    <div class="StatSuiviGlobal_topProductMetric">
                                        <i class="fas fa-shopping-cart"></i> ${product.sales[period]}
                                    </div>
                                    <div class="StatSuiviGlobal_topProductMetric">
                                        <i class="fas fa-euro-sign"></i> ${product.revenue[period].toFixed(2)}
                                    </div>
                                </div>
                            </div>
                        </div>
                    `;
                    
                    // Limiter à 9 produits supplémentaires (10 au total avec le meilleur)
                    if (i >= 9) break;
                }
                
                topProductsContainer.innerHTML = html;
            }
        }
    }
    
    // Mettre à jour les alertes de stock
    function updateStockAlerts() {
        const stockStatus = StatSuiviGlobal_data.getStockStatusData();
        
        // Mettre à jour les chiffres des alertes
        const outOfStockAlert = document.querySelector('.StatSuiviGlobal_alertCard.danger .StatSuiviGlobal_alertValue');
        const lowStockAlert = document.querySelector('.StatSuiviGlobal_alertCard.warning .StatSuiviGlobal_alertValue');
        const overStockAlert = document.querySelector('.StatSuiviGlobal_alertCard.info .StatSuiviGlobal_alertValue');
        const optimalStockAlert = document.querySelector('.StatSuiviGlobal_alertCard.success .StatSuiviGlobal_alertValue');
        
        if (outOfStockAlert) outOfStockAlert.textContent = stockStatus.outOfStock + ' produits';
        if (lowStockAlert) lowStockAlert.textContent = stockStatus.lowStock + ' produits';
        if (overStockAlert) overStockAlert.textContent = stockStatus.overStock + ' produits';
        if (optimalStockAlert) optimalStockAlert.textContent = stockStatus.optimalStock + ' produits';
    }
    
    // ========== GESTIONNAIRES D'ÉVÉNEMENTS ==========
    
    // Gestionnaire pour les changements de période
    function handlePeriodChange() {
        const periodOptions = document.getElementById('StatSuiviGlobal_periodOptions');
        const periodButtons = periodOptions.querySelectorAll('.StatSuiviGlobal_filterItem');
        
        periodButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Retirer la classe active de tous les boutons
                periodButtons.forEach(btn => btn.classList.remove('active'));
                
                // Ajouter la classe active au bouton cliqué
                this.classList.add('active');
                
                // Mettre à jour la période active
                const period = this.dataset.period;
                StatSuiviGlobal_data.config.currentPeriod = period;
                
                // Mettre à jour le texte affiché
                document.getElementById('StatSuiviGlobal_currentPeriod').textContent = StatSuiviGlobal_data.periods[period];
                
                // Fermer le sélecteur de période
                periodOptions.style.display = 'none';
                
                // Mettre à jour les graphiques et données
                refreshAllData();
            });
        });
        
        // Gestionnaire pour le bouton de changement de période
        document.getElementById('StatSuiviGlobal_changePeriod').addEventListener('click', function() {
            periodOptions.style.display = periodOptions.style.display === 'none' ? 'block' : 'none';
        });
        
        // Gestionnaire pour fermer le sélecteur
        const closeButtons = document.querySelectorAll('.StatSuiviGlobal_closeFilterBtn');
        closeButtons.forEach(button => {
            button.addEventListener('click', function() {
                this.closest('.StatSuiviGlobal_filterOptions').style.display = 'none';
            });
        });
        
        // Gestionnaire pour les dates personnalisées
        document.querySelector('.StatSuiviGlobal_applyCustomDate').addEventListener('click', function() {
            const startDate = document.getElementById('StatSuiviGlobal_startDate').value;
            const endDate = document.getElementById('StatSuiviGlobal_endDate').value;
            
            if (startDate && endDate) {
                // Mettre à jour la configuration
                StatSuiviGlobal_data.config.currentPeriod = 'custom';
                StatSuiviGlobal_data.config.customDateRange.start = startDate;
                StatSuiviGlobal_data.config.customDateRange.end = endDate;
                
                // Mettre à jour le texte affiché
                const formattedStart = new Date(startDate).toLocaleDateString('fr-FR');
                const formattedEnd = new Date(endDate).toLocaleDateString('fr-FR');
                document.getElementById('StatSuiviGlobal_currentPeriod').textContent = `Du ${formattedStart} au ${formattedEnd}`;
                
                // Fermer le sélecteur de période
                periodOptions.style.display = 'none';
                
                // Mettre à jour tous les graphiques et données
                refreshAllData();
                
                // Mettre à jour la classe active sur les boutons
                periodButtons.forEach(btn => btn.classList.remove('active'));
            } else {
                alert('Veuillez sélectionner une date de début et de fin');
            }
        });
        
        // Gestionnaire pour la sélection précise
        document.querySelector('.StatSuiviGlobal_applyPreciseDate').addEventListener('click', function() {
            const year = document.querySelector('#StatSuiviGlobal_yearSelect .StatSuiviGlobal_selectedOption span').textContent;
            const month = document.querySelector('#StatSuiviGlobal_monthSelect .StatSuiviGlobal_selectedOption span').textContent;
            const day = document.querySelector('#StatSuiviGlobal_daySelect .StatSuiviGlobal_selectedOption span').textContent;
            
            // Mettre à jour la configuration
            StatSuiviGlobal_data.config.preciseDate.year = year;
            StatSuiviGlobal_data.config.preciseDate.month = month === 'Tous' ? 'all' : getMonthNumber(month);
            StatSuiviGlobal_data.config.preciseDate.day = day === 'Tous' ? 'all' : day;
            
            // Déterminer la période en fonction des sélections
            let periodText = '';
            if (month === 'Tous' && day === 'Tous') {
                periodText = `Année ${year}`;
                StatSuiviGlobal_data.config.currentPeriod = 'this-year'; // Approximation
            } else if (day === 'Tous') {
                periodText = `${month} ${year}`;
                StatSuiviGlobal_data.config.currentPeriod = 'this-month'; // Approximation
            } else {
                periodText = `${day} ${month} ${year}`;
                StatSuiviGlobal_data.config.currentPeriod = 'today'; // Approximation
            }
            
            // Mettre à jour le texte affiché
            document.getElementById('StatSuiviGlobal_currentPeriod').textContent = periodText;
            
            // Fermer le sélecteur de période
            periodOptions.style.display = 'none';
            
            // Mettre à jour les graphiques et données
            refreshAllData();
            
            // Mettre à jour la classe active sur les boutons
            periodButtons.forEach(btn => btn.classList.remove('active'));
        });
        
        // Fonction utilitaire pour obtenir le numéro du mois
        function getMonthNumber(monthName) {
            const months = {
                'Janvier': 1, 'Février': 2, 'Mars': 3, 'Avril': 4, 'Mai': 5, 'Juin': 6,
                'Juillet': 7, 'Août': 8, 'Septembre': 9, 'Octobre': 10, 'Novembre': 11, 'Décembre': 12
            };
            return months[monthName] || 1;
        }
    }
    
    // Gestionnaire pour les sélecteurs personnalisés
    function handleCustomSelects() {
        const customSelects = document.querySelectorAll('.StatSuiviGlobal_customSelect');
        
        customSelects.forEach(select => {
            const selectedOption = select.querySelector('.StatSuiviGlobal_selectedOption');
            const options = select.querySelector('.StatSuiviGlobal_options');
            
            // Ouvrir/fermer les options lorsqu'on clique sur l'option sélectionnée
            selectedOption.addEventListener('click', function() {
                // Fermer tous les autres sélecteurs ouverts
                document.querySelectorAll('.StatSuiviGlobal_options').forEach(opt => {
                    if (opt !== options) {
                        opt.style.display = 'none';
                    }
                });
                
                // Basculer l'affichage des options
                options.style.display = options.style.display === 'block' ? 'none' : 'block';
            });
            
            // Gérer la sélection d'une option
            const optionItems = select.querySelectorAll('.StatSuiviGlobal_option');
            optionItems.forEach(option => {
                option.addEventListener('click', function() {
                    // Mettre à jour l'option sélectionnée
                    selectedOption.querySelector('span').textContent = this.textContent;
                    
                    // Fermer les options
                    options.style.display = 'none';
                    
                    // Gérer différents types de sélecteurs
                    if (select.id === 'StatSuiviGlobal_monthSelect') {
                        handleMonthChange(this.dataset.value);
                    }
                    
                    // Déclencher un événement personnalisé pour la mise à jour des données
                    const changeEvent = new CustomEvent('customSelectChange', {
                        detail: {
                            select: select.id,
                            value: this.dataset.value || this.textContent
                        }
                    });
                    document.dispatchEvent(changeEvent);
                });
            });
            
            // Fermer les options si on clique ailleurs
            document.addEventListener('click', function(e) {
                if (!select.contains(e.target)) {
                    options.style.display = 'none';
                }
            });
        });
        
        // Gestionnaire spécial pour le changement de mois (mettre à jour les jours)
        function handleMonthChange(monthValue) {
            const dayOptions = document.getElementById('StatSuiviGlobal_dayOptions');
            const daySelectedOption = document.querySelector('#StatSuiviGlobal_daySelect .StatSuiviGlobal_selectedOption span');
            
            // Réinitialiser la sélection du jour
            daySelectedOption.textContent = 'Tous';
            
            // Si 'Tous' est sélectionné, pas besoin de générer des jours spécifiques
            if (monthValue === 'all') {
                return;
            }
            
            // Générer les jours pour le mois sélectionné
            const year = document.querySelector('#StatSuiviGlobal_yearSelect .StatSuiviGlobal_selectedOption span').textContent;
            const daysInMonth = new Date(year, monthValue, 0).getDate();
            
            // Reconstruire les options de jours
            let dayOptionsHTML = '<div class="StatSuiviGlobal_option" data-value="all">Tous</div>';
            
            for (let i = 1; i <= daysInMonth; i++) {
                dayOptionsHTML += `<div class="StatSuiviGlobal_option" data-value="${i}">${i}</div>`;
            }
            
            dayOptions.innerHTML = dayOptionsHTML;
            
            // Réinitialiser les écouteurs d'événements pour les nouvelles options
            const newDayOptions = dayOptions.querySelectorAll('.StatSuiviGlobal_option');
            newDayOptions.forEach(option => {
                option.addEventListener('click', function() {
                    daySelectedOption.textContent = this.textContent;
                    dayOptions.style.display = 'none';
                });
            });
        }
    }
    
    // Gestionnaire pour les contrôles du graphique principal
    function handleChartControls() {
        // Gestionnaire pour le type de graphique
        const chartTypeButtons = document.querySelectorAll('.StatSuiviGlobal_chartTypeBtn');
        chartTypeButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Mettre à jour la classe active
                chartTypeButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                
                // Mettre à jour le type de graphique
                StatSuiviGlobal_data.config.chartType = this.dataset.type;
                
                // Mettre à jour le graphique
                initMainChart();
            });
        });
        
        // Gestionnaire pour la période du graphique
        const chartPeriodButtons = document.querySelectorAll('.StatSuiviGlobal_chartPeriodBtn');
        chartPeriodButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Mettre à jour la classe active
                chartPeriodButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                
                // Mettre à jour la période du graphique
                StatSuiviGlobal_data.config.chartPeriod = this.dataset.period;
                
                // Mettre à jour les données en fonction de la période
                updateSummary();
                updateTopProductsList();
                updatePerformanceTable();
            });
        });
    }
    
    // Gestionnaire pour le filtre des meilleurs produits
    function handleTopProductsFilter() {
        const topProductButtons = document.querySelectorAll('.StatSuiviGlobal_topProductBtn');
        topProductButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Mettre à jour la classe active
                topProductButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                
                // Mettre à jour la liste des meilleurs produits
                updateTopProductsList();
            });
        });
    }
    
    // Gestionnaire pour les vues de stock
    function handleStockViews() {
        const stockViewButtons = document.querySelectorAll('.StatSuiviGlobal_stockViewBtn');
        stockViewButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Mettre à jour la classe active
                stockViewButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                
                // Mettre à jour le type de visualisation
                StatSuiviGlobal_data.config.stockView = this.dataset.view;
                
                // Mettre à jour la visualisation
                initStockDistribution();
            });
        });
    }
    
    // Gestionnaire pour les contrôles d'analyse du stock
    function handleStockAnalysisControls() {
        const analysisButtons = document.querySelectorAll('.StatSuiviGlobal_analysisBtn');
        analysisButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Mettre à jour la classe active
                analysisButtons.forEach(btn => btn.classList.remove('active'));
                this.classList.add('active');
                
                // Mettre à jour le type d'analyse
                StatSuiviGlobal_data.config.analysisType = this.dataset.analysis;
                
                // Mettre à jour le tableau d'analyse
                updateStockAnalysis();
            });
        });
        
        // Gestionnaire pour les boutons d'alerte
        const alertButtons = document.querySelectorAll('.StatSuiviGlobal_alertButton');
        alertButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Déterminer le type d'alerte
                const alertCard = this.closest('.StatSuiviGlobal_alertCard');
                let analysisType = 'lowStock';
                
                if (alertCard.classList.contains('danger')) {
                    analysisType = 'outOfStock';
                } else if (alertCard.classList.contains('warning')) {
                    analysisType = 'lowStock';
                } else if (alertCard.classList.contains('info')) {
                    analysisType = 'overStock';
                } else if (alertCard.classList.contains('success')) {
                    analysisType = 'optimalStock';
                }
                
                // Mettre à jour le type d'analyse
                StatSuiviGlobal_data.config.analysisType = analysisType;
                
                // Mettre à jour la classe active des boutons d'analyse
                analysisButtons.forEach(btn => {
                    btn.classList.toggle('active', btn.dataset.analysis === analysisType);
                });
                
                // Mettre à jour le tableau d'analyse
                updateStockAnalysis();
                
                // Activer l'onglet d'analyse de stock
                document.querySelector('a[href="#StatSuiviGlobal_stockTab"]').click();
            });
        });
    }
    
    // Gestionnaire pour les contrôles de prévision
    function handleForecastControls() {
        // Gérer le changement d'horizon de prévision
        document.addEventListener('customSelectChange', function(e) {
            if (e.detail.select === 'StatSuiviGlobal_forecastPeriodSelect') {
                // Mettre à jour la période de prévision
                StatSuiviGlobal_data.config.forecastPeriod = e.detail.value;
                
                // Mettre à jour le graphique de prévision
                initForecastChart();
                
                // Mettre à jour le tableau de prévision
                updateForecastTable();
            } else if (e.detail.select === 'StatSuiviGlobal_forecastTypeSelect') {
                // Mettre à jour le type de prévision
                StatSuiviGlobal_data.config.forecastType = e.detail.value;
                
                // Mettre à jour le graphique de prévision
                initForecastChart();
            }
        });
    }
    
    // Gestionnaire pour les onglets de top performances
    function handleTopPerformanceTabs() {
        const topPerformanceTabs = document.querySelectorAll('.StatSuiviGlobal_topPerformanceTab');
        const topPerformanceContents = document.querySelectorAll('.StatSuiviGlobal_topPerformanceList');
        
        topPerformanceTabs.forEach(tab => {
            tab.addEventListener('click', function() {
                // Mettre à jour la classe active
                topPerformanceTabs.forEach(t => t.classList.remove('active'));
                this.classList.add('active');
                
                // Mettre à jour le contenu affiché
                const tabValue = this.dataset.tab;
                StatSuiviGlobal_data.config.topPerformanceTab = tabValue;
                
                // Cacher tous les contenus
                topPerformanceContents.forEach(content => {
                    content.style.display = 'none';
                });
                
                // Afficher le contenu correspondant
                document.querySelector(`.StatSuiviGlobal_topPerformanceList[data-content="${tabValue}"]`).style.display = 'block';
                
                // Mettre à jour les données
                updateTopPerformance();
            });
        });
    }
    
    // Gestionnaire pour le toggle des filtres
    function handleFilterToggle() {
        document.getElementById('StatSuiviGlobal_toggleFilters').addEventListener('click', function() {
            const filtersContainer = document.getElementById('StatSuiviGlobal_filtersContainer');
            filtersContainer.classList.toggle('expanded');
        });
    }
    
    // Gestionnaire pour la recherche et le tri
    function handleSearchAndSort() {
        // Gérer la recherche
        const searchInput = document.querySelector('.StatSuiviGlobal_searchInput');
        if (searchInput) {
            searchInput.addEventListener('input', function() {
                // Réinitialiser la pagination
                StatSuiviGlobal_data.config.currentPage = 1;
                // Mettre à jour le tableau
                updatePerformanceTable();
            });
        }
        
        // Gérer le tri
        document.addEventListener('customSelectChange', function(e) {
            if (e.detail.select && e.detail.select.includes('sortContainer')) {
                // Extraire les informations de tri de l'option sélectionnée
                const option = document.querySelector(`.StatSuiviGlobal_option[data-sort="${e.detail.value.split('-')[0]}"][data-order="${e.detail.value.split('-')[1]}"]`);
                if (option) {
                    StatSuiviGlobal_data.config.performanceSort = {
                        field: option.dataset.sort,
                        order: option.dataset.order
                    };
                    
                    // Mettre à jour le tableau
                    updatePerformanceTable();
                }
            }
        });
    }
    
    // Gestionnaire pour la pagination
    function handlePagination() {
        const paginationButtons = document.querySelectorAll('.StatSuiviGlobal_paginationBtn');
        paginationButtons.forEach(button => {
            button.addEventListener('click', function() {
                // Obtenir les informations de pagination actuelles
                const currentPage = StatSuiviGlobal_data.config.currentPage;
                const totalPages = parseInt(document.getElementById('StatSuiviGlobal_totalPages').textContent);
                
                // Déterminer la nouvelle page
                let newPage = currentPage;
                
                switch(this.dataset.page) {
                    case 'first':
                        newPage = 1;
                        break;
                    case 'prev':
                        newPage = Math.max(1, currentPage - 1);
                        break;
                    case 'next':
                        newPage = Math.min(totalPages, currentPage + 1);
                        break;
                    case 'last':
                        newPage = totalPages;
                        break;
                }
                
                // Mettre à jour la page actuelle
                StatSuiviGlobal_data.config.currentPage = newPage;
                
                // Mettre à jour le tableau
                updatePerformanceTable();
            });
        });
    }
    
    // Gestionnaire pour le bouton d'actualisation
    function handleRefreshButton() {
        document.getElementById('StatSuiviGlobal_refreshData').addEventListener('click', function() {
            // Ajouter une classe pour l'animation de rotation
            this.classList.add('rotating');
            
            // Vider le cache pour forcer le recalcul des données
            StatSuiviGlobal_data.cache = {};
            
            // Mettre à jour toutes les données
            refreshAllData();
            
            // Retirer la classe d'animation après un délai
            setTimeout(() => {
                this.classList.remove('rotating');
            }, 1000);
        });
    }
    
    // Gestionnaire pour les boutons d'action dans les tableaux
    function handleTableActions() {
        // Utiliser la délégation d'événements pour gérer les boutons d'action
        document.addEventListener('click', function(e) {
            // Boutons d'action dans le tableau d'analyse de stock
            if (e.target.closest('.StatSuiviGlobal_actionBtn')) {
                const button = e.target.closest('.StatSuiviGlobal_actionBtn');
                const row = button.closest('tr');
                const productName = row.querySelector('.StatSuiviGlobal_tableProductName').textContent;
                
                if (button.classList.contains('order')) {
                    alert(`Commande initiée pour le produit: ${productName}`);
                } else if (button.classList.contains('promo')) {
                    alert(`Création d'une promotion pour le produit: ${productName}`);
                } else if (button.classList.contains('details')) {
                    alert(`Détails du produit: ${productName}`);
                }
            }
            
            // Boutons d'action dans les recommandations
            if (e.target.closest('.StatSuiviGlobal_recommendationActionBtn')) {
                const button = e.target.closest('.StatSuiviGlobal_recommendationActionBtn');
                const card = button.closest('.StatSuiviGlobal_recommendationCard');
                const productName = card.querySelector('.StatSuiviGlobal_recommendationProductName').textContent;
                
                if (button.classList.contains('primary')) {
                    if (button.textContent.includes('Appliquer')) {
                        alert(`Recommandation appliquée pour: ${productName}`);
                    } else if (button.textContent.includes('Commander')) {
                        alert(`Commande initiée pour: ${productName}`);
                    } else if (button.textContent.includes('Promotion')) {
                        alert(`Promotion créée pour: ${productName}`);
                    }
                } else if (button.classList.contains('secondary')) {
                    alert(`Détails de la recommandation pour: ${productName}`);
                }
            }
            
            // Boutons d'action pour les rapports
            if (e.target.closest('.StatSuiviGlobal_reportButton')) {
                const button = e.target.closest('.StatSuiviGlobal_reportButton');
                const card = button.closest('.StatSuiviGlobal_reportCard');
                const reportTitle = card.querySelector('.StatSuiviGlobal_reportTitle').textContent;
                
                alert(`Génération du rapport: ${reportTitle}`);
            }
            
            // Boutons d'action rapide
            if (e.target.closest('.StatSuiviGlobal_quickActionBtn')) {
                const button = e.target.closest('.StatSuiviGlobal_quickActionBtn');
                const buttonText = button.textContent.trim();
                
                alert(`Action: ${buttonText}`);
            }
        });
    }
    
    // Gestionnaire pour le bouton d'exportation
    function handleExportButton() {
        const exportBtn = document.querySelector('.StatSuiviGlobal_exportBtn');
        if (exportBtn) {
            exportBtn.addEventListener('click', function() {
                alert('Exportation des données en cours...');
                // Simuler un délai d'exportation
                setTimeout(() => {
                    alert('Données exportées avec succès!');
                }, 1000);
            });
        }
    }
    
    // Fonction pour mettre à jour toutes les données
    function refreshAllData() {
        // Mettre à jour les graphiques
        initMainChart();
        initCategoryChart();
        initStockDistribution();
        initForecastChart();
        
        // Mettre à jour les résumés et tableaux
        updateSummary();
        updateTopProductsList();
        updatePerformanceTable();
        updateStockAnalysis();
        updateStockAlerts();
        updateForecastTable();
        updateTopPerformance();
    }
    
    // ========== INITIALISATION DE L'INTERFACE ==========
    
    // Fonction principale d'initialisation
    function initStatSuiviGlobalUI() {
        // Initialiser les graphiques
        initMainChart();
        initCategoryChart();
        initStockDistribution();
        initForecastChart();
        
        // Mettre à jour les données initiales
        updateSummary();
        updateTopProductsList();
        updatePerformanceTable();
        updateStockAnalysis();
        updateStockAlerts();
        updateForecastTable();
        updateTopPerformance();
        
        // Initialiser les gestionnaires d'événements
        handlePeriodChange();
        handleCustomSelects();
        handleChartControls();
        handleTopProductsFilter();
        handleStockViews();
        handleStockAnalysisControls();
        handleForecastControls();
        handleTopPerformanceTabs();
        handleFilterToggle();
        handleSearchAndSort();
        handlePagination();
        handleRefreshButton();
        handleTableActions();
        handleExportButton();
        
        // Initialiser les jours pour le sélecteur de jours
        // (les jours seront générés dynamiquement en fonction du mois sélectionné)
        
        // Simuler des données pour les autres onglets de top performances
        ['week', 'month', 'year'].forEach(period => {
            const container = document.querySelector(`.StatSuiviGlobal_topPerformanceList[data-content="${period}"]`);
            if (container) {
                // Créer une structure vide qui sera remplie lors du clic sur l'onglet
                container.innerHTML = `
                    <div class="StatSuiviGlobal_bestProduct"></div>
                    <div class="StatSuiviGlobal_topProducts"></div>
                `;
            }
        });
        
        // Ajouter la navigation dans la barre latérale
        initSidebarNavigation();
    }
    
    // Initialiser la navigation dans la barre latérale
    function initSidebarNavigation() {
        const navItems = document.querySelectorAll('.nav-item');
        const contentSections = document.querySelectorAll('.content-section');
        
        navItems.forEach(item => {
            item.addEventListener('click', function(e) {
                // Empêcher le comportement par défaut du lien
                e.preventDefault();
                
                // Si l'élément a un attribut data-section
                if (this.dataset.section) {
                    // Masquer toutes les sections
                    contentSections.forEach(section => {
                        section.style.display = 'none';
                    });
                    
                    // Afficher la section correspondante
                    const sectionToShow = document.getElementById(this.dataset.section);
                    if (sectionToShow) {
                        sectionToShow.style.display = 'block';
                        
                        // Si la section est StatSuiviGlobal, mettre à jour les graphiques
                        if (this.dataset.section === 'StatSuiviGlobal') {
                            // Mettre à jour les graphiques avec un léger délai pour s'assurer que la section est visible
                            setTimeout(() => {
                                refreshAllData();
                            }, 100);
                        }
                    }
                    
                    // Mettre à jour la classe active
                    navItems.forEach(navItem => {
                        navItem.classList.remove('active');
                    });
                    this.classList.add('active');
                }
            });
        });
    }
    
    // Lancer l'initialisation de l'interface
    initStatSuiviGlobalUI();
}

</script>